***this version has operations from lake tahoe to truckee river at farad

*** the base uci is truckee.farad.uci 
*** this version has master.uci - SOP's for reservoirs
***                  store.uci  - storage logic for reservoirs
***                  flor.rate.uci - floriston rate logic
***                  tahex.uci  - tahoe prosser exchange logic
***
***  dictionary of variable names- variable starting with
***  tk - truckee river
***  t  - lake tahoe
***  p  - prosser reservoir
***  d  - donner lake
***  i  - independence lake
***  s  - stampede reservoir
***  b  - boca reservoir
***  m  - martis reservoir
***  f  - floriston rates measured at farad
***  sv - sierra valley 
***  lt - little truckee river   

***  RCHRES dictionary
***  rchres 100 - lake tahoe
***  rchres 145 - donner lake
***  rchres 168 - martis creek reservoir
***  rchres 178 - prosser creek reservoir
***  rchres 185 - sierra valley diversion
***  rchres 187 - independence lake
***  rchres 199 - stampede reservoir
***  rchres 209 - boca reservoir
***  rchres 240 - truckee river at farad

RUN
GLOBAL
  TRUCKEE RIVER OPERATION-ROUTING RUN: LK TAHOE TO FARAD
  START       1989/08           END    1990/07
  RUN INTERP OUTPUT LEVEL    1    1
  RESUME     0 RUN     1
END GLOBAL
FILES
<ftyp>  <fun>***<-----------------fname---------------------------------------->
MESSU      25   merge.ech
WDM        26   truckee.wdm
            2   merge.out
END FILES
OPN SEQUENCE
***    run on daily basis  *** 
    INGRP              INDELT 24:00

***   send data to  SAB  ***
      COPY         1
      COPY         2
***  generate outflow time series for lake tahoe  gener 1 -pooled 
      GENER        1
      GENER      101
      GENER      301
      GENER      310
      GENER      311
      GENER      601
      GENER      610
      GENER      602
      GENER      611
      GENER      901
      GENER      902
      GENER      903
      GENER      904
      GENER      905
      GENER      906
      GENER      907
      GENER      908
***   generate a donner lake outflow 10-SPPC water 11-TCID water 
      GENER       10
      GENER       11
***   generate  donner lake outflow 14-natural water
      GENER       14   
***   generate a martis reservoir outflow 
      GENER       20
***   prosser reservoir gener 30 - uncommitted   gener 31 - exchange, 32 - nw
      GENER       30
      GENER       31
      GENER       32
***   generate a independence lake outflow 40- sppc water 41- nw water 
      GENER       40
      GENER       41
***   generate a sierra valley diversion time series 
      GENER       45
***   gen stampede reservoir outflow 51-SPPC water 52-pyramid water 54 - nw
      GENER       51
      GENER       52 
      GENER       54 
***   generate a stampede reservoir total inflows -53
      GENER       53
***   generate a boca reservoir outflow 61-sp water 62-py water 
      GENER       61
      GENER       62 
***   generate a boca reservoir outflow 64-ac water 65-nc water 66-nw water
      GENER       64
      GENER       65
      GENER       66
***   generate a boca reservoir total inflows -63
      GENER       63
***  generate floriston requirement - gener 80 floriston rates 81
      GENER       80
      GENER       81
***  generate side water by FWM - 82
      GENER       82
***  generate natural flow at farad by FWM - 83, by SCS - 84
      GENER       83
      GENER       84
***  generate natural flow at farad by sierra valley decree - 85
      GENER       85
***  generate natural flow L. truckee blw boca  by FWM - 86, by SCS - 87
      GENER       86
      GENER       87

      RCHRES     100
      RCHRES     110
      RCHRES     120
      RCHRES     130
      RCHRES     140
      RCHRES     145
      RCHRES     149
      RCHRES     150
      RCHRES     160
      RCHRES     168
      RCHRES     169
      RCHRES     170
      RCHRES     178
      RCHRES     180
      RCHRES     185
      RCHRES     187
      RCHRES     188
      RCHRES     189
      RCHRES     194
      RCHRES     195
      RCHRES     198
      RCHRES     199
      RCHRES     208
      RCHRES     209
      RCHRES     210
      RCHRES     220
      RCHRES     230
      RCHRES     240
    END INGRP
END OPN SEQUENCE


CATEGORY  
*** This block declares the active categories and associates a two-character
*** tag with each one.  The first character of the tag must be a letter, and
*** the second must be a letter or a numeral.  Upper and lower case letters
*** are both allowed and are distinct (i.e. "A1" and "a1" are different tags).
***
   <> <-----name-----> ***
   pu  prosser uncomm
   px  prosser exchange

   sp SPPC-water
   tc TCID-water

   ac adverse to canal
   nc nonadvrse to cnl

   ra rates water
   pw pooled water
   nw natural water
   py pyramid water


END CATEGORY 

COPY  

***  dictionary of COPY used in this model
***
***  COPY 1 MEAN 1   - lake tahoe inflows  
***  COPY 1 MEAN 2   - donner lake releases
***  COPY 1 MEAN 3   - donner lake inflows
***  COPY 1 MEAN 4   - prosser reservoir releases
***  COPY 1 MEAN 5   - prosser reservoir inflows

***  COPY 1 MEAN 7   - martis reservoir inflows
***  COPY 1 MEAN 8   - martis reservoir releases
***  COPY 1 MEAN 9   - independence lake releases
***  COPY 1 MEAN 10  - independence lake inflows
***  COPY 1 MEAN 11  - stampede reservoir releases
***  COPY 1 MEAN 12  - boca reservoir releases
***  COPY 1 MEAN 13  - boca reservoir trib inflows

***  COPY 1 MEAN 15  - sierra valley releases   

***  COPY 2 MEAN 1   - lake tahoe SCS forecasts
***  COPY 2 MEAN 2   - little truckee ab boca SCS forecasts
***  COPY 2 MEAN 3   - truckee at farad SCS forecasts 

***  COPY 2 MEAN 10  - truckee canal USGS gage at Wadsworth

  TIMESERIES
    #****#  NPT  NMN
    1    6    0   20
  END TIMESERIES
END COPY 


GENER

***  dictionary of GENER names and uses

***   GENER        1   lake tahoe pooled releases

***   GENER       10   donner lake releases SPPC water 
***   GENER       11   donner lake releases TCID water
***   GENER       12   donner lake inflows SPPC water
***   GENER       13   donner lake inflows TCID water
***   GENER       14   donner lake inflows natural water

***   GENER       20   martis reservoir releases 

***   GENER       30   prosser reservoir uncommitted releases
***   GENER       31   prosser reservoir exchange releases
***   GENER       32   prosser reservoir nw       releases

***   GENER       40   independence lake releases sppc water
***   GENER       41   independence lake releases nw water 

***   GENER       45   sierra valley diversions

***   GENER       51   stampede reservoir releases SPPC water 
***   GENER       52   stampede reservoir releases pyramid water 
***   GENER       53   stampede reservoir total inflows     

***   GENER       61   boca reservoir releases sp water 
***   GENER       62   boca reservoir releases py water  
***   GENER       64   boca reservoir releases ac water 
***   GENER       65   boca reservoir releases nc water 
***   GENER       66   boca reservoir releases nw water 
***   GENER       63   boca reservoir total inflows

***   GENER       80   floriston requirement 
***   GENER       81   floriston rates
***   GENER       82   calculated side water by FWM 
***   GENER       83   calculated natural flow at farad by FWM 
***   GENER       84   calculated natural flow at farad by SCS
***   GENER       85   calculated natural flow at farad by sierra valley decree 
***   GENER       86   calculated natural flow L. truckee blw boca by FWM
***   GENER       87   calculated natural flow L. truckee blw boca by SCS

  OPCODE
    #    # OPCD ***
    1   11   24
   14  999   24
  END OPCODE

  COEFFS
    #    #         K ***
    1   11       1.0
   14  999       1.0
  END COEFFS
END GENER
 

EXT SOURCES
***
***   changed to daily time step by * 24 for all IVOL in block ***
***   changed all IVOL to CIVOL for categories 2/16/95
***   changed OUTDGT to COTDGT for categories 3/31/95
 
***
<-Volume-> <Member> SsysSgap<--Mult-->Tran <-Target vols> <-Grp> <-Member-> ***
<Name>   # <Name> # tem strg<-factor->strg <Name>   #   #        <Name> # # ***

*** NEGATIVE LK TAHOE INFLOW (WHEN ET EXCEEDS INFLOWS + PRECIP)             ***
WDM     30 FLOW     ENGL      1.000000SAME RCHRES 100     EXTNL  COTDGT 1***
WDM     30 FLOW     ENGL     -1.000000SAME RCHRES 100     EXTNL  CIVOL pw  

***OUTFLOW FROM LAKE TAHOE AS MEASURED BY TRUCKEE R GAGING STATION          ***
WDM    101 FLOW     ENGL      1.000000SAME RCHRES 100     EXTNL  COTDGT 1pw ***

***   inflow to lake tahoe
WDM     31 FLOW     ENGL      1.983480SAME RCHRES 100     EXTNL  CIVOL nw 
WDM     31 FLOW     ENGL              SAME COPY     1     INPUT  MEAN   1

***    send SCS tahoe forecast to SAB from dsn 8990, in 1000 ac-ft 
WDM   8990 FLOW     ENGL                   COPY     2     INPUT  MEAN   1 

WDM     99 FLOW     ENGL      0.303480SAME RCHRES 110     EXTNL  CIVOL nw 
WDM     99 FLOW     ENGL      0.311400SAME RCHRES 120     EXTNL  CIVOL nw
WDM     99 FLOW     ENGL      0.902472SAME RCHRES 130     EXTNL  CIVOL nw
WDM     99 FLOW     ENGL      0.466128SAME RCHRES 140     EXTNL  CIVOL nw

*** seperate inflows equally into 2 categories - sp & tc
WDM    106 FLOW     ENGL      0.991740SAME RCHRES 145     EXTNL  CIVOL sp***
WDM    106 FLOW     ENGL      0.991740SAME RCHRES 145     EXTNL  CIVOL tc***

 
*** for testing purposes here for donner inflows
WDM    106 FLOW     ENGL      9.9174  SAME RCHRES 145     EXTNL  CIVOL sp***
WDM    106 FLOW     ENGL      9.9174  SAME RCHRES 145     EXTNL  CIVOL tc***
*** this is donner inflow onto one category - nw
WDM    106 FLOW     ENGL      1.983480SAME RCHRES 145     EXTNL  CIVOL nw
***    send donner inflow to SAB dsn 106  *******************************
WDM    106 FLOW     ENGL      1.00         COPY     1     INPUT  MEAN   3 
 
***  outflow from donner based on flow routing model ********************
WDM    113 FLOW     ENGL      1.000000SAME RCHRES 145     EXTNL  COTDGT 1sp***
***    send donner releases  to special action block  dsn 113 **********
WDM    113 FLOW     ENGL                   COPY     1     INPUT  MEAN   2 
 
***  donner lake evap   rchres 145***************************************
WDM    695 EVAP     ENGL                   RCHRES 145     EXTNL  POTEV   
WDM    692 PRCP     ENGL                   RCHRES 145     EXTNL  PREC ***   

WDM    199 FLOW     ENGL      0.299496SAME RCHRES 149     EXTNL  CIVOL nw
WDM    199 FLOW     ENGL      0.095208SAME RCHRES 150     EXTNL  CIVOL nw
WDM    199 FLOW     ENGL      0.186456SAME RCHRES 160     EXTNL  CIVOL nw

******  inflow to martis reservoir based on rod halls data set*****************
WDM    117 FLOW     ENGL      1.983480SAME RCHRES 168     EXTNL  CIVOL py
WDM    117 FLOW     ENGL ***   59.3480SAME RCHRES 168     EXTNL  CIVOL nw
***    send martis inflow to SAB dsn 117 ********************************
WDM    117 FLOW     ENGL                   COPY     1     INPUT  MEAN   7 

******  outflow from martis based on flow routing model*****************
WDM    122 FLOW     ENGL      1.000000SAME RCHRES 168     EXTNL  COTDGT 1sp***
***    send martis releases  to special action block  dsn 122 *********
WDM    122 FLOW     ENGL                   COPY     1     INPUT  MEAN   8


***   martis creek reservoir evap  
WDM    699 EVAP     ENGL                   RCHRES 168     EXTNL  POTEV   
WDM    697 PRCP     ENGL                   RCHRES 168     EXTNL  PREC ***   


WDM    199 FLOW     ENGL      0.037680SAME RCHRES 169     EXTNL  CIVOL nw
WDM    199 FLOW     ENGL      0.128928SAME RCHRES 170     EXTNL  CIVOL nw


***  prosser creek reservoir inflows
WDM    126 FLOW     ENGL      1.983480SAME RCHRES 178     EXTNL  CIVOL nw 
***  testing prosser creek reservoir inflows
WDM    126 FLOW     ENGL      7.983480SAME RCHRES 178     EXTNL  CIVOL pu ***
***    send prosser inflows  to special action block   **********
WDM    126 FLOW     ENGL              SAME COPY     1     INPUT  MEAN   5

***     prosser creek reservoir evap
WDM    699 EVAP     ENGL                   RCHRES 178     EXTNL  POTEV   
WDM    697 PRCP     ENGL                   RCHRES 178     EXTNL  PREC***       

*** routing model releases from prosser
WDM    134 FLOW     ENGL      1.000000SAME RCHRES 178     EXTNL  COTDGT 1pu***
***    send prosser releases  to special action block  dsn 134 **********
WDM    134 FLOW     ENGL                   COPY     1     INPUT  MEAN   4 


WDM    199 FLOW     ENGL      0.035712SAME RCHRES 180     EXTNL  CIVOL nw

***  MONTHLY OUTFLOW TO LTL TRUCKEE DITCH used in flow routing model       ***
WDM    499 FLOW     ENGL      1.000000SAME RCHRES 185     EXTNL  COTDGT 1nw

***  l truckee river flows actual, dsn 137, test with dsn 141
WDM    141 FLOW     ENGL      1.983480SAME RCHRES 185     EXTNL  CIVOL nw
***   option try dsn 498  which has test cfs           ***
***    send sierra valley diversions to special action block  dsn 499 ***
WDM    498 FLOW     ENGL                   COPY     1     INPUT  MEAN  15 
***  possible data sets for determining sierra valley diversions
***   dsn  499 - observed daily L Truckee Ditch diversion 1977-93
***   dsn  140 - monthly L Truckee Ditch diversions 1900-97 from rod hall
***   dsn  142 - monthly L Truckee Ditch diversions 1977-93 avg values
***              this data set could be adjusted by forecasts

   from independence based on rod halls data set*******************
WDM    149 FLOW     ENGL      1.983480SAME RCHRES 187     EXTNL  CIVOL nw
***    send independence inflow to SAB dsn 149 ********************************
WDM    149 FLOW     ENGL                   COPY     1     INPUT  MEAN  10

******  outflow from independence based on flow routing model*****************
WDM    152 FLOW     ENGL      1.000000SAME RCHRES 187     EXTNL  COTDGT 1sp***
***    send independence releases  to special action block  dsn 152 *********
WDM    152 FLOW     ENGL                   COPY     1     INPUT  MEAN   9


***    independence lake evap  
WDM    695 EVAP     ENGL                   RCHRES 187     EXTNL  POTEV   
WDM    692 PRCP     ENGL                   RCHRES 187     EXTNL  PREC ***   


***  MONTHLY INFLOW TO SAGEHEN CK                                          ***
WDM    162 FLOW     ENGL      1.983480SAME RCHRES 198     EXTNL  CIVOL nw



*** HALL'S INFLO TO STAMPEDE:  168 HAS BEEN CHANGED.  SAGEHEN MONTHLY   ***
***   OBSERVED HAS BEEN SUBTRACTED AND LTL TRKEE DTCH MONTHLY OBSERVED HAS ***
**    BEEN ADDED TO MAKE DSN 137 INFLO TO RCHRES 185.                      ***
WDM    168 FLOW     ENGL      1.983480SAME RCHRES 199     EXTNL  CIVOL ***
*** 3/16 OF INTERVENING INFLOWS BTWN STAMPEDE DAM AND GAGING STATION OUFLOW
***     DOWNSTREM OF STAMPEDE DAM ADDED BACK TO STAMPEDE RESERVOIR.   ***
WDM    181 FLOW     ENGL      0.371904SAME RCHRES 199     EXTNL  CIVOL nw 
***  use this dummy inflow to test max inflows during apr 10 - may 20
WDM    181 FLOW     ENGL       17.1904SAME RCHRES 199     EXTNL  CIVOL py***

******  outflow from stampede based on flow routing model*****************
WDM    176 FLOW     ENGL      1.000000SAME RCHRES 199     EXTNL  COTDGT 1pw ***
***    send stampede releases  to special action block  dsn 176 *********
WDM    176 FLOW     ENGL                   COPY     1     INPUT  MEAN  11

****  stampede reservoir evap 
WDM    699 EVAP     ENGL                   RCHRES 199     EXTNL  POTEV   
WDM    697 PRCP     ENGL                   RCHRES 199     EXTNL  PREC   

***    send SCS l.truckee forecast to SAB from dsn 8985, in 1000 ac-ft
WDM   8985 FLOW     ENGL                   COPY     2     INPUT  MEAN   2 

***ONLY 13/16 OF INTERVENING INFLOW APPLIED DUE TO GAGING STN LOCALE***
WDM    181 FLOW     ENGL      1.611576SAME RCHRES 209     EXTNL  CIVOL nw 
WDM    181 FLOW     ENGL      1.983480SAME RCHRES 209     EXTNL  CIVOL***
***    send trib boca inflow to SAB dsn 181, 13/16 mult factor= 0.8125
WDM    181 FLOW     ENGL      0.8125       COPY     1     INPUT  MEAN  13 

******  outflow from boca based on flow routing model*****************
WDM    191 FLOW     ENGL      1.000000SAME RCHRES 209     EXTNL  COTDGT 1pw***
***    send boca releases  to special action block  dsn 191 *********
WDM    191 FLOW     ENGL                   COPY     1     INPUT  MEAN  12

***   boca reservoir evap  
WDM    702 PRCP     ENGL                  RCHRES 209     EXTNL  PREC
WDM    704 EVAP     ENGL                  RCHRES 209     EXTNL  POTEV   



WDM    199 FLOW     ENGL      0.041664SAME RCHRES 210     EXTNL  CIVOL nw
WDM    199 FLOW     ENGL      0.313392SAME RCHRES 220     EXTNL  CIVOL nw
WDM    199 FLOW     ENGL      0.723960SAME RCHRES 230     EXTNL  CIVOL nw

***  simulated inflow between tahoe and farad, change with mult factor dsn 1650
WDM   1650 FLOW     ENGL      12800.  SAME RCHRES 240     EXTNL  CIVOL pw ***

***    send SCS truckee-farad forecast to SAB from dsn 8980, in 1000 ac-ft
WDM   8980 FLOW     ENGL                   COPY     2     INPUT  MEAN   3 
  

***  send Truckee Canal USGS gage at wadsowrth to SAB drom dsn 324, in cfs
WDM    324 FLOW     ENGL              SAME COPY     2     INPUT  MEAN  10

END EXT SOURCES


SCHEMATIC 
<-Source->                <--Area-->       <-Target->  <ML->  ***
<Name>   #                <-factor->       <Name>   #      #  ***

RCHRES 100                                 RCHRES 110      1    
RCHRES 110                                 RCHRES 120      1             
RCHRES 120                                 RCHRES 130      1        
RCHRES 130                                 RCHRES 140      1             
RCHRES 140                                 RCHRES 150      1         
RCHRES 145                                 RCHRES 149      1             
RCHRES 149                                 RCHRES 150      1         
RCHRES 150                                 RCHRES 160      1             
RCHRES 160                                 RCHRES 170      1         
RCHRES 168                                 RCHRES 169      1
RCHRES 169                                 RCHRES 170      1         
RCHRES 170                                 RCHRES 180      1             
RCHRES 178                                 RCHRES 180    178
RCHRES 180                                 RCHRES 210      1              
RCHRES 185                                 RCHRES 194      2
RCHRES 187                                 RCHRES 188      1             
RCHRES 188                                 RCHRES 189      1         
RCHRES 189                                 RCHRES 194      1              
RCHRES 194                                 RCHRES 195      1             
RCHRES 195                                 RCHRES 199      1             
RCHRES 199                                 RCHRES 208      1
RCHRES 208                                 RCHRES 209      1             
RCHRES 209                                 RCHRES 210    209
RCHRES 210                                 RCHRES 220      1         
RCHRES 220                                 RCHRES 230      1              
RCHRES 230                                 RCHRES 240      1          

END SCHEMATIC  


MASS-LINK 
*** Separate mass-links are needed for different exit-to-downstream situations.
*** Individual mass-links are used by reservoirs to convert reservoir-specific
*** accounting categories to general streamflow categories

  MASS-LINK        1  
<Srce>     <-Grp> <-Member-><--Mult-->     <Targ>         <-Grp> <-Member-> ***
<Name>     <Name> <Name> # #<-factor->     <Name>         <Name> <Name> # # ***
RCHRES     ROFLOW                          RCHRES         INFLOW
  END MASS-LINK    1

  MASS-LINK        2  
<Srce>     <-Grp> <-Member-><--Mult-->     <Targ>         <-Grp> <-Member-> ***
<Name>     <Name> <Name> # #<-factor->     <Name>         <Name> <Name> # # ***
RCHRES     OFLOW         2                 RCHRES         INFLOW
  END MASS-LINK    2  

*** this mass-link changes px stored water to pw on release from Prosser
  MASS-LINK      178
<Srce>     <-Grp> <-Member-><--Mult-->     <Targ>         <-Grp> <-Member-> ***
<Name>     <Name> <Name> # #<-factor->     <Name>         <Name> <Name> # # ***
RCHRES     ROFLOW CROVOLpu                 RCHRES         INFLOW CIVOL py
RCHRES     ROFLOW CROVOLpx                 RCHRES         INFLOW CIVOL pw
RCHRES     ROFLOW CROVOLnw                 RCHRES         INFLOW CIVOL nw
  END MASS-LINK  178

*** this mass-link changes stored water on release from Stampede
  MASS-LINK      199 
<Srce>     <-Grp> <-Member-><--Mult-->     <Targ>         <-Grp> <-Member-> ***
<Name>     <Name> <Name> # #<-factor->     <Name>         <Name> <Name> # # ***
RCHRES     ROFLOW CROVOLsp                 RCHRES         INFLOW CIVOL sp 
RCHRES     ROFLOW CROVOLpy                 RCHRES         INFLOW CIVOL py
RCHRES     ROFLOW CROVOLnw                 RCHRES         INFLOW CIVOL nw 
  END MASS-LINK  199 

*** this mass-link changes ac and nc stored water to pw on release from Boca
  MASS-LINK      209 
<Srce>     <-Grp> <-Member-><--Mult-->     <Targ>         <-Grp> <-Member-> ***
<Name>     <Name> <Name> # #<-factor->     <Name>         <Name> <Name> # # ***
RCHRES     ROFLOW CROVOLac                 RCHRES         INFLOW CIVOL pw 
RCHRES     ROFLOW CROVOLnc                 RCHRES         INFLOW CIVOL pw 
RCHRES     ROFLOW CROVOLsp                 RCHRES         INFLOW CIVOL sp 
RCHRES     ROFLOW CROVOLpy                 RCHRES         INFLOW CIVOL py
RCHRES     ROFLOW CROVOLnw                 RCHRES         INFLOW CIVOL nw 
  END MASS-LINK  209 

END MASS-LINK  
 
NETWORK
*** lake tahoe outflow
GENER    1 OUTPUT TIMSER                   RCHRES 100     EXTNL  COTDGT 1pw

***  donner lake outflow
GENER   10 OUTPUT TIMSER                   RCHRES 145     EXTNL  COTDGT 1sp
GENER   11 OUTPUT TIMSER                   RCHRES 145     EXTNL  COTDGT 1tc
GENER   14 OUTPUT TIMSER                   RCHRES 145     EXTNL  COTDGT 1nw

*** martis reservoir outflow
GENER   20 OUTPUT TIMSER                   RCHRES 168     EXTNL  COTDGT 1py

***  prosser reservoir outflows
GENER   30 OUTPUT TIMSER                   RCHRES 178     EXTNL  COTDGT 1pu
GENER   31 OUTPUT TIMSER                   RCHRES 178     EXTNL  COTDGT 1px
GENER   32 OUTPUT TIMSER                   RCHRES 178     EXTNL  COTDGT 1nw

*** independence outflow
GENER   40 OUTPUT TIMSER                   RCHRES 187     EXTNL  COTDGT 1sp
GENER   41 OUTPUT TIMSER                   RCHRES 187     EXTNL  COTDGT 1nw

***  sierra valley demand outflow
GENER   45 OUTPUT TIMSER                   RCHRES 185     EXTNL  COTDGT 1nw

*** stampede reservoir outflow
GENER   51 OUTPUT TIMSER                   RCHRES 199     EXTNL  COTDGT 1sp
GENER   52 OUTPUT TIMSER                   RCHRES 199     EXTNL  COTDGT 1py
GENER   54 OUTPUT TIMSER                   RCHRES 199     EXTNL  COTDGT 1nw

*** boca reservoir outflow
GENER   61 OUTPUT TIMSER                   RCHRES 209     EXTNL  COTDGT 1sp 
GENER   62 OUTPUT TIMSER                   RCHRES 209     EXTNL  COTDGT 1py  
GENER   64 OUTPUT TIMSER                   RCHRES 209     EXTNL  COTDGT 1ac 
GENER   65 OUTPUT TIMSER                   RCHRES 209     EXTNL  COTDGT 1nc
GENER   66 OUTPUT TIMSER                   RCHRES 209     EXTNL  COTDGT 1nw

END NETWORK


EXT TARGETS

***   library of output files specified  through EXT TARGETS
***   using the following format of dsn numbering is used 
***   8100-8199  lake tahoe
***   8200-8299  donner lake
***   8300-8399  martis reservoir
***   8400-8499  prosser reservoir
***   8500-8599  sierra valley, little truckee river
***   8600-8699  independence lake
***   8700-8799  stampede reservoir
***   8800-8899  boca reservoir
***   8900-8999  truckee river
***
***   within each reservoir the following format of dsn numbering is used
***   for example for the 8200 series of dsn
***   8201-8208 inflows
***   8209      total inflows
***   8210      stage or depth
***   8215      storage
***   8220-8249 outflows
***   8250      total outflows
***   8260      volume lost to evap

*** RCHRES - HSPF -  wdm  - output - description
***          type    dsn     type

***   100 COPY 1  1 8101     SFLO    tahoe inflows         
***   100   STAGE   8110     SDEP    tahoe lake depth      
***   100 GENER  1  8120     SFLO    tahoe outflows        
***   100 GENER101  8130     SFLO    tahoe pooled water rls
***   100   RO      8150     SFLO    tahoe total outflows  
 
***   145     VOL   8215     SVOL    donner lake storage         
***   145     DEP   8210     DEPT    donner lake depth          
***   145 GENER 10  8220     SFLO    donner  SPPC water outflow 
***   145 GENER 11  8221     SFLO    donner  TCID water outflow 
***   145 GENER 14  8222     SFLO    donner  NW water outflow  
***   145    ROVOL  8250     DMND    donner total outflows      

***   168     DEP   8310     DEPT    martis lake depth      
***   168 GENER 20  8320     SFLO    martis lake outflow    
***   168    ROVOL  8350     DMND    martis total outflows  

***   178    VOLEV  8460     SVOL    prosser volume lost to evap   
***   178 COPY 1  5 8409     SFLO    prosser total inflows         
***   178    DEP    8410     SDEP    prosser lake depth            
***   178 GENER 30  8420     SFLO    prosser uncommitted outflows  
***   178 GENER 31  8421     SFLO    prosser exchange outflows     
***   178    RO     8450     SFLO    prosser total outflows        
***   178 GENER310  8430     SVOL    prosser exchange volume
***   178 GENER301  8431     SFLO    prosser exchange rls  
***   178 GENER311  8432     SVOL    prosser nw volume
 
***   185 GENER 45  8560     DMND    sierra valley demand         
***   185 COPY 1 15 8521     DMND    sierra valley diversions     

***   187   DEP     8610     DEPT    independence stage           
***   187 GENER 40  8620     SFLO    independence sppc outflow        
***   187 GENER 41  8621     SFLO    independence nw outflow        
***   187   ROVOL   8650     DMND    independence total outflows  

***   199  DEP      8710     DEPT    stampede stage            
***   199 GENER 51  8720     SFLO    stampede  SPPC outflow    
***   199 GENER 52  8721     SFLO    stampede pry outflows     
***   199 ROVOL     8750     DMND    stampede total outflows   
***   199 GENER 53  8709     SFLO    stampede total inflows    


***   209  DEP      8810     DEPT    boca stage            
***   209 GENER 64  8820     SFLO    boca  ac outflow    
***   209 GENER 65  8821     SFLO    boca  nc outflow     
***   209 GENER 61  8822     SFLO    boca  sp outflow     
***   209 ROVOL     8850     DMND    boca total outflows   
***   209 GENER 63  8809     SFLO    boca total inflows    
***   209 GENER601  8830     SFLO    boca adv cnl rls
***   209 GENER610  8831     SVOL    boca adv cnl volume
***   209 GENER602  8832     SFLO    boca nonadv cnl rls 
***   209 GENER611  8833     SVOL    boca nonadv cnl volume

***   240 RO        8901     SFLO    truckee at farad flows

***       GENER 80  8550     SFLO    calc amount to meet floriston rates 
***       GENER 81  8551     SFLO    floriston rates 
***       GENER 82  8552     SFLO    calc side water by FWM  
***       GENER 83  8553     SFLO    calc nat flow at farad by FWM  
***       GENER 84  8554     SFLO    calc nat flow at farad by SCS 
***       GENER 85  8555     SFLO    calc nat flow at farad by sierra v. decree 
***       GENER 86  8950     SFLO    calc nat flow L. truckee blw boca by FWM 
***       GENER 87  8951     SFLO    calc nat flow L. truckee blw boca by SCS 

***       GENER904  8963     SFLO    floriston rates after swap
***       GENER905  8964     SFLO    farad flows after swap
***       GENER906  8965     SFLO    farad need init after swap
***       GENER907  8966     SFLO    farad excess after swap
***       GENER908  8967     SFLO    farad adjustment after swap

<-Volume-> <-Grp> <-Member-><--Mult-->Tran <-Volume-> <Member> Tsys Tgap Amd****
<Name>   #        <Name> # #<-factor->strg <Name>   # <Name>    tem strg str****
RCHRES 100 HYDR   OVOL   2 1   0.50417 *** WDM   1402 SFLO     ENGL AGGR REPL

tahoe inflows  ***
COPY     1 OUTPUT MEAN   1                 WDM   8101 SFLO     ENGL AGGR REPL 
RCHRES 100 HYDR   STAGE               AVER WDM   8110 SDEP     ENGL AGGR REPL

***   dsn 8130 recieves tahoe pooled water rls
GENER  101 OUTPUT TIMSER                   WDM   8130 SFLO     ENGL AGGR REPL
***
tahoe outflows ***
GENER    1 OUTPUT TIMSER                   WDM   8120 SFLO     ENGL AGGR REPL
RCHRES 100 HYDR   RO                       WDM   8150 SFLO     ENGL AGGR REPL


*** donner lake storage 
RCHRES 145 HYDR   VOL                 AVER WDM   8215 SVOL     ENGL AGGR REPL 
***  donner lake depth into dsn 8210
RCHRES 145 HYDR   DEP                 AVER WDM   8210 DEPT     ENGL AGGR REPL
***  donner lake outflow based on operations in SAB
*** DSN 8220 is the outflow of RCHRES145 SPPC water
*** DSN 8221 is the outflow of RCHRES145 TCID water
*** DSN 8222 is the outflow of RCHRES145 nat  water
GENER   10 OUTPUT TIMSER                   WDM   8220 SFLO     ENGL AGGR REPL
GENER   11 OUTPUT TIMSER                   WDM   8221 SFLO     ENGL AGGR REPL
GENER   14 OUTPUT TIMSER                   WDM   8222 SFLO     ENGL AGGR REPL
RCHRES 145 HYDR   ROVOL        0.50417     WDM   8250 DMND     ENGL AGGR REPL

***  martis lake depth temporarily put into dsn 8310
RCHRES 168 HYDR   DEP                 AVER WDM   8310 DEPT     ENGL AGGR REPL
***  martis lake outflow based on operations in SAB
GENER   20 OUTPUT TIMSER                   WDM   8320 SFLO     ENGL AGGR REPL
RCHRES 168 HYDR   ROVOL        0.50417     WDM   8350 DMND     ENGL AGGR REPL


*** volume lost to evap in prosser reservoir
RCHRES 178 HYDR   VOLEV        0.50417     WDM   8460 SVOL     ENGL AGGR REPL*** 
prosser inflows ***
COPY     1 OUTPUT MEAN   5                 WDM   8409 SFLO     ENGL AGGR REPL
RCHRES 178 HYDR   DEP                 AVER WDM   8410 SDEP     ENGL AGGR REPL

***   dsn 8430 receives prosser exchange volume
***   dsn 8431 receives prosser exchange rls  
***   dsn 8432 receives prosser nw volume     
GENER  310 OUTPUT TIMSER                   WDM   8430 SVOL     ENGL AGGR REPL
GENER  301 OUTPUT TIMSER                   WDM   8431 SFLO     ENGL AGGR REPL
GENER  311 OUTPUT TIMSER                   WDM   8432 SVOL     ENGL AGGR REPL

prosser uncommitted outflows ***
GENER   30 OUTPUT TIMSER                   WDM   8420 SFLO     ENGL AGGR REPL
prosser exchange outflows ***
GENER   31 OUTPUT TIMSER                   WDM   8421 SFLO     ENGL AGGR REPL
RCHRES 178 HYDR   RO                       WDM   8450 SFLO     ENGL AGGR REPL

*** independence stage
RCHRES 187 HYDR   DEP                 AVER WDM   8610 DEPT     ENGL AGGR REPL
*** independence  outflow based on operations in SAB
*** DSN 8620 is receiving the ouflow of RCHRES 187 SPPC water
*** DSN 8621 is receiving the ouflow of RCHRES 187 nw   water
GENER   40 OUTPUT TIMSER                   WDM   8620 SFLO     ENGL AGGR REPL
GENER   41 OUTPUT TIMSER                   WDM   8621 SFLO     ENGL AGGR REPL
RCHRES 187 HYDR   ROVOL        0.50417     WDM   8650 DMND     ENGL AGGR REPL


***   sierra valley demand after operations in SAB  ***
GENER   45 OUTPUT TIMSER                   WDM   8560 DMND     ENGL AGGR REPL
***   test to see if the sv diversions are making it through the SAB
COPY***  1 OUTPUT MEAN  15                 WDM   8521 DMND     ENGL AGGR REPL

*** stampede stage
RCHRES 199 HYDR   DEP                 AVER WDM   8710 DEPT     ENGL AGGR REPL
*** stampede  outflow based on operations in SAB
*** DSN 8720 is receiving the ouflow of RCHRES 199 SPPC water
GENER   51 OUTPUT TIMSER                   WDM   8720 SFLO     ENGL AGGR REPL
*** DSN 8721 is receiving the ouflow of RCHRES 199 pry  water
GENER   52 OUTPUT TIMSER                   WDM   8721 SFLO     ENGL AGGR REPL
RCHRES 199 HYDR   ROVOL        0.50417     WDM   8750 DMND     ENGL AGGR REPL
*** send total stampede inflow to dsn 8709
GENER   53 OUTPUT TIMSER                   WDM   8709 SFLO     ENGL AGGR REPL

***   dsn 8830 receives boca adv cnl rls
***   dsn 8831 receives boca adv cnl volume
***   dsn 8832 receives boca nonadv cnl rls 
***   dsn 8833 receives boca nonadv cnl volume
GENER  601 OUTPUT TIMSER                   WDM   8830 SFLO     ENGL AGGR REPL
GENER  610 OUTPUT TIMSER                   WDM   8831 SVOL     ENGL AGGR REPL
GENER  602 OUTPUT TIMSER                   WDM   8832 SFLO     ENGL AGGR REPL
GENER  611 OUTPUT TIMSER                   WDM   8833 SVOL     ENGL AGGR REPL

*** boca stage
RCHRES 209 HYDR   DEP                 AVER WDM   8810 DEPT     ENGL AGGR REPL
*** boca  outflow based on operations in SAB
*** DSN 8820 is receiving the ouflow of RCHRES 209 ac water
GENER   64 OUTPUT TIMSER                   WDM   8820 SFLO     ENGL AGGR REPL
*** DSN 8821 is receiving the ouflow of RCHRES 209 nc  water
GENER   65 OUTPUT TIMSER                   WDM   8821 SFLO     ENGL AGGR REPL

*** DSN 8822 is receiving the ouflow of RCHRES 209 sp  water
GENER   61 OUTPUT TIMSER                   WDM   8822 SFLO     ENGL AGGR REPL
 
RCHRES 209 HYDR   ROVOL        0.50417     WDM   8850 DMND     ENGL AGGR REPL
*** send total boca inflow to dsn 8809
GENER   63 OUTPUT TIMSER                   WDM   8809 SFLO     ENGL AGGR REPL

***  dsn 8963 receives floriston rates after swap
***  dsn 8964 receives farad flows after swap
***  dsn 8965 receives farad need init after swap
***  dsn 8966 receives farad excess after swap
***  dsn 8967 receives farad adjustment after swap
GENER  904 OUTPUT TIMSER                   WDM   8963 SFLO     ENGL AGGR REPL
GENER  905 OUTPUT TIMSER                   WDM   8964 SFLO     ENGL AGGR REPL
GENER  906 OUTPUT TIMSER                   WDM   8965 SFLO     ENGL AGGR REPL
GENER  907 OUTPUT TIMSER                   WDM   8966 SFLO     ENGL AGGR REPL
GENER  908 OUTPUT TIMSER                   WDM   8967 SFLO     ENGL AGGR REPL

***   GENER       80   calculated amount to meet floriston rates 8550
GENER   80 OUTPUT TIMSER                   WDM   8550 SFLO     ENGL AGGR REPL
***   GENER       81   floriston rates 8551
GENER   81 OUTPUT TIMSER                   WDM   8551 SFLO     ENGL AGGR REPL
***   GENER       82   calculated side water by FWM  8552
GENER   82 OUTPUT TIMSER                   WDM   8552 SFLO     ENGL AGGR REPL***
***   GENER       83   calculated natural flow at farad by FWM  8553
GENER   83 OUTPUT TIMSER                   WDM   8553 SFLO     ENGL AGGR REPL***
***   GENER       84   calculated natural flow at farad by SCS 8554
GENER   84 OUTPUT TIMSER                   WDM   8554 SFLO     ENGL AGGR REPL***
***   GENER       85   calculated natural flow at farad by sierra valley decree 
GENER   85 OUTPUT TIMSER                   WDM   8555 SFLO     ENGL AGGR REPL***
***   GENER       86   calculated natural flow L. truckee blw boca by FWM 8950
GENER   86 OUTPUT TIMSER                   WDM   8950 SFLO     ENGL AGGR REPL***
***   GENER       87   calculated natural flow L. truckee blw boca by SCS 8951
GENER   87 OUTPUT TIMSER                   WDM   8951 SFLO     ENGL AGGR REPL***

RCHRES 240 HYDR   RO                       WDM   8901 SFLO     ENGL AGGR REPL

END EXT TARGETS


RCHRES
  GEN-INFO
    RCHRES       Name        Nexits   Unit Systems   Printer      ***
         #<------------------><---> User T-series  Engl Metr LKFG ****
                                           in  out                ****
  100     LAKE TAHOE              1    1    1    1    2    0    0
  110     TRK TAHOE - 3 MI DS     1    1    1    1    2    0    0
  120     TRK 3 MI DS - SQUAW     1    1    1    1    2    0    0
  130     TRK SQUAW - DEEP        1    1    1    1    2    0    0
  140     TRK DEEP - GAGE         1    1    1    1    2    0    0
  145     DONNER LAKE             1    1    1    1    2    0    0 
  149     DNR BLW LK - MOUTH      1    1    1    1    2    0    0
  150     TRK GAGE - SEWAGE       1    1    1    1    2    0    0
  160     TRK SEWAGE - MARTIS     1    1    1    1    2    0    0
  168     MARTIS CREEK LAKE       1    1    1    1    2    0    0
  169     MARTIS GAGE - MOUTH     1    1    1    1    2    0    0
  170     TRK MARTIS - PROSSER    1    1    1    1    2    0    0
  178     PROSSER CREEK RES       1    1    1    1    2    0    0
  180     TRK PROSS - L. TRKEE    1    1    1    1    2    0    0
  185     LTL TRK @ GS - INDEP    2    1    1    1    2    0    0
  187     INDEPENDENCE LAKE       1    1    1    1    2    0    0
  188     IND LK - ROAD BRIDGE    1    1    1    1    2    0    0
  189     IND CK@BRDGE - L TRK    1    1    1    1    2    0    0
  194     L TRK@IND CD - HWY89    1    1    1    1    2    0    0
  195     LTRK@HWY89 - STMPD R    1    1    1    1    2    0    0
  198     SGHN @ GS - STMPD R     1    1    1    1    2    0    0
  199     STAMPEDE RESERVOIR      1    1    1    1    2    0    0
  208     LTRK@STMPD - BOCA RE    1    1    1    1    2    0    0
  209     BOCA RESERVOIR          1    1    1    1    2    0    0
  210     TRK L. TRKEE - JUNPR    1    1    1    1    2    0    0
  220     TRK JUNIPER - GRAY      1    1    1    1    2    0    0
  230     TRK GRAY - FLORISTON    1    1    1    1    2    0    0
  240     TRK FLORSTN - FARAD     1    1    1    1    2    0    0

  END GEN-INFO
  ACTIVITY
    RCHRES *************** Active Sections ******************
    # -  # HYFG ADFG CNFG HTFG SDFG GQFG OXFG NUFG PKFG PHFG ***
  100  240    1    0    0    0    0    0    0    0    0    0
  END ACTIVITY
  PRINT-INFO
    RCHRES *************** Printout Flags ****************** PIVL  PYR
    # -  # HYDR ADCA CONS HEAT  SED  GQL OXRX NUTR PLNK PHCB *********
  100  144    6                                                 1    9
  146  177    6                                                 1    9
  179  185    6                                                 1    9
  188  194    6                                                 1    9
  208         6                                                 1    9
  210  240    6                                                 1    9
  145         6                                                 1    9
  178         6                                                 1    9
  187         6                                                 1    9
  195         6                                                 1    9
  198         6                                                 1    9
  199         6                                                 1    9
  209         6                                                 1    9
  END PRINT-INFO
  HYDR-PARM1
    RCHRES  Flags for each HYDR Section  ***
    # -  #  VC A1 A2 A3  ODFVFG for each *** ODGTFG for each     FUNCT for each
            FG FG FG FG  possible  exit  *** possible  exit      possible  exit
             *  *  *  *    *  *  *  *  * ***   *  *  *  *  *       *  *  *  *  *
  100        0  1  0  0    0  0  0  0  0       1  0  0  0  0       2  2  2  2  2
  110  140   0  0  0  0    4  0  0  0  0       0  0  0  0  0       2  2  2  2  2
  145        0  1  0  0    0  0  0  0  0       1  0  0  0  0       2  2  2  2  2
  149  160   0  0  0  0    4  0  0  0  0       0  0  0  0  0       2  2  2  2  2
  168        0  1  0  0    0  0  0  0  0       1  0  0  0  0       2  2  2  2  2
  169  170   0  0  0  0    4  0  0  0  0       0  0  0  0  0       2  2  2  2  2
  178        0  1  0  0    0  0  0  0  0       1  0  0  0  0       2  2  2  2  2
  180        0  0  0  0    4  0  0  0  0       0  0  0  0  0       2  2  2  2  2
  185        0  0  0  0    0  4  0  0  0       1  2  0  0  0       2  2  2  2  2
  187        0  1  0  0    0  0  0  0  0       1  0  0  0  0       2  2  2  2  2
  188  198   0  0  0  0    4  0  0  0  0       0  0  0  0  0       2  2  2  2  2
  199        0  1  0  0    0  0  0  0  0       1  0  0  0  0       2  2  2  2  2
  208        0  0  0  0    4  0  0  0  0       0  0  0  0  0       2  2  2  2  2
  209        0  1  0  0    0  0  0  0  0       1  0  0  0  0       2  2  2  2  2
  210  240   0  0  0  0    4  0  0  0  0       0  0  0  0  0       2  2  2  2  2

  END HYDR-PARM1
  HYDR-PARM2
    RCHRES ***
    # -  #    FTABNO       LEN     DELTH     STCOR        KS      DB50 ***
  <------><--------><--------><--------><--------><--------><--------> ***
*** KS is set to 0.0 for daily runs, since flow-through times are > 1 hour.
*** KS should be reset to 0.5 for hourly runs
  100            100    21.900              6219.0       0.0***
  100            100    21.900                           0.0
  110            110     3.680                           0.0
  120            120     2.250                           0.0
  130            130     3.620                           0.0
  140            140     2.810                           0.0
  145            145     2.800                           0.0
  149            149     2.230                           0.0
  150            150     3.750                           0.0
  160            160     3.150                           0.0
  168            168     0.900                           0.0
  169            169     1.800                           0.0
  170            170     2.770                           0.0
  178            178     1.710              5622.0       0.0 ***
  178            178     1.710                           0.0
  180            180     2.070                           0.0
  185            185     3.420                           0.0
  187            187     2.540                           0.0
  188            188     2.510                           0.0
  189            189     2.260                           0.0
  194            194     2.230                           0.0
  195            195     3.740                           0.0
  198            198     4.880                           0.0
  199            199     4.850                           0.0
  208            208     4.240                           0.0
  209            209     2.680                           0.0
  210            210     2.430                           0.0
  220            220     2.600                           0.0
  230            230     1.920                           0.0
  240            240     2.640                           0.0
  END HYDR-PARM2
  HYDR-INIT
    ****TAKEN FROM FWM records 8/8/89
    RCHRES  Initial conditions for each HYDR section ***
    # -  # ***   VOL     Initial  value  of COLIND     Initial  value  of COTDGT
           *** ac-ft Cat for each possible exit        for each possible exit
                           EX1  EX2  EX3  EX4  EX5 ***   EX1  EX2  EX3  EX4  EX5
  <------><-------->   <><---><---><---><---><---> *** <---><---><---><---><--->
  100        640550.    2
  110      1.240       pw  4.0
  120      1.110       pw  4.0
  130      3.500       pw  4.0
  140      3.090       pw  4.0
***    starting storage of donner lake
  145     6310.0        3 
  149     2.0020       pw  4.0
  150     10.960       pw  4.0
  160      7.220       pw  4.0
*** starting martis reservoir
  168      777.         2                               3.80
  169     0.6040       pw  4.0
  170     10.600       pw  4.0
*** starting prosser reservoir
  178         25247.    3
  180      9.240       pw  4.0
  185      4.260        1       4.0                     0.00
***  starting independence storage
  187     15300.        2          
  188      1.426       pw  4.0
  189      1.092       pw  4.0
  194      3.321       pw  4.0
  195      5.878       pw  4.0
  198      0.936       pw  4.0
***  starting stampede storage
  199     100962.0      3
  208      5.200       pw  4.0     
*** starting boca storage
  209     40575.        5
  210      9.860       pw  4.0
  220     11.220       pw  4.0
  230      6.680       pw  4.0
  240     10.210       pw  4.0
  END HYDR-INIT
 
*** This table is used to specify the primary category assigned to
*** physical fluxes.  If priorites and/or fractions are needed to specify
*** more than one category, then the number of categories is specified
*** instead, and the additional info is given in the new tables.
  HYDR-CATEGORY 
    Categories specified for Outflows, Precipitation and Evaporation ***
    RCHRES Prec Evap<----------FVOL--------->NCOGT ***
    x -  x              1    2    3    4    5      ***
          <---><---><---><---><---><---><---><---> ***
  100        pw   pw                             1
  145        sp   sp                             3
  168        py   py                             1
  178        nw   nw                             3
  185        nw   nw                             1 
  187        sp   sp                             2
  199        sp   sp                             3
  209        sp   sp                             5 
  END HYDR-CATEGORY 

  HYDR-CDEMAND
             c x  Priority  COTDGT   c x  Priority  COTDGT ***
    RCHRES      (yyyy/mm/dd) (cfs)      (yyyy/mm/dd) (cfs) ***
    x -  x  <><> <--> <> <> <---->  <><> <--> <> <> <----> ***
  100       pw 1               10.                
  145       sp 1               10.  tc 1               02. 
  145       nw 1                0.
  168       py 1               10. 
  178       pu 1               10.  px 1               10.
  178       nw 1              0.0 
  185       nw 1               10. 
  187       sp 1               10.  nw 1               0.
  199       sp 1               10.  py 1               02. 
  199       nw 1               0.
  209       sp 1               10.  py 1               02. 
  209       ac 1               10.  nc 1               02. 
  209       nw 1               0.
  END HYDR-CDEMAND
  HYDR-CINIT 
*** This table specifies the initial fractions of each category for a reach.
***          Fraction of Initial Storage for each possible category  
*** RCHRES   c cfrac   c cfrac   c cfrac   c cfrac   c cfrac   c cfrac   c cfrac 
*** x - x   <><---->  <><---->  <><---->  <><---->  <><---->  <><---->  <><---->
  100       pw  1.0   nw  0.0
  145       sp  0.45  tc  0.45  nw   0.1
  168       py  1.0   nw  0.0
  178       pu 0.50   px 0.50   nw   0.0
  185       nw  1.0
  187       sp  1.0   nw  0.0
  199       sp  0.5   py  0.5   nw  0.0
  209       sp  .10   py  .20   ac  0.30  nc  0.40  nw  0.0
  END HYDR-CINIT 
END RCHRES

****  gggggg

SPEC-ACTIONS
*** User-Defined Target Variable Names
***                  addr or                       addr or
***                 <------>                      <------>
*** kwd   varnam ct  vari  s1 s2 s3  frac oper     vari  s1 s2 s3  frac oper
  <****>  <----><-> <----><-><-><-> <---> <-->    <----><-><-><-> <---> <-->

***************************************************************************
***  GENERAL OUTLINE OF SPECIAL ACTIONS BLOCK 
***************************************************************************
 
***   The special-actions block code will use the following order for
***   coding of reservoir operations:
***     1. Determine input variables, such as time-dependent targets
***        (eg. Floriston Rates)
***     2. Determine proposed spills and pre-cautionary drawdowns, following
***        SOPs
***     3. Determine downstream-flood-prevention measures
***     4. Determine proposed release for meeting Floriston Rates
***     5. Determine proposed release for other demands, such as Pyramid
***        Fish, Truckee Canal, and Sierra Valley water
***     6. Determine proposed release for physical water exchange
***     7. Determine amount of water that needs to be released to satisfy
***        storage priorities and rights.
***     8. Merge all blocks to determine final releases
***     9. Determine proposed release minimum fisheries flow
***    10. Paper water exchange 
***    11. Determine correct category of water stored through swap
***    12. Generate all outflow data sets             

***  Within each of the preceeding major blocks of code, the specific 
***  sites will be arranged in downstream order.

***  dictionary of variable names- variable starting with
***  b - boca reservoir
***  d - donner lake
***  f - floriston rates measured at farad
***  i - independence lake
***  lt - little truckee river   
***  m - martis reservoir
***  p - prosser reservoir
***  s - stampede reservoir
***  sv - sierra valley diversion
***  tk - truckee river
***  t - lake tahoe

*** dictionary of workshop variable numbering
***   1-10  - HSPF variables
***  11-99  - lake tahoe
*** 100-140 - donner lake
*** 140-149 - martis lake
*** 150-299 - OCAP
*** 300-399 - prosser creek reservoir
*** 400-499 - independence lake
*** 500-599 - sierra valley, little truckee river
*** 600-699 - stampede reservoir
*** 700-849 - boca reservoir
*** 850-899 - truckee river
*** 900-920 - scratch variables
*** 935-945 - SPPC routines
*** 950-970 - cui-ui routines
*** 950-999 - Orr Ditch routines

*******************************************************************************
***HSPF VARIABLES
*******************************************************************************
  UVNAME  MO_DA   1 WORKSP  1         1.0  
  UVNAME  JUL_DA  1 WORKSP  2         1.0  
  UVNAME  DAYS    1 WORKSP  3         1.0  
*** add 4-7 from master.uci
  UVNAME  JNOV1   1 WORKSP  4         1.0  
  UVNAME  JMAY20  1 WORKSP  5         1.0  
  UVNAME  JJUL5   1 WORKSP  6         1.0  
  UVNAME  ITEMP   1 WORKSP  7         1.0  
  UVNAME  JNOV16  1 WORKSP  8         1.0  
  UVNAME  JJUN15  1 WORKSP  9         1.0  
  UVNAME  JJUL15  1 WORKSP 10         1.0  
  UVNAME  JJUN8   1 WORKSP 11         1.0  
  UVNAME  JJUN23  1 WORKSP 12         1.0  
  UVNAME  JJUN1   1 WORKSP 13         1.0  
  UVNAME  JMAY15  1 WORKSP 14         1.0  
  UVNAME  FRFLAG  1 WORKSP 15         1.0  
  UVNAME  WDFLAG  1 WORKSP 16         1.0  

***              mo_da  - month-day counter
***              jul_da - julian day
***              days   - day counter
***              jnov1  - julian day of november 1
***              jmay20 - julian day of may 20
***              jjul5  - julian day of july 5
***              itemp  - temporary variable
***              jnov16 - julian day of november 16
***              jjun15 - julian day of june 15
***              jjul15 - julian day of july 15
***              jjun8  - julian day of june 8 
***              jjun23 - julian day of june 23
***              jjun1  - julian day of june 1
***              jmay15 - julian day of may 15
***              frflag - flag for wet year = 3 , dry year =1, avg year = 2 
***              wdflag - flag for wet year = 1 , dry year =0

  UVQUAN mo_da  GLOBAL     WORKSP  1        3
  UVQUAN jul_da GLOBAL     WORKSP  2        3
  UVQUAN days   GLOBAL     WORKSP  3        3
  UVQUAN jnov1  GLOBAL     WORKSP  4        3 
  UVQUAN jmay20 GLOBAL     WORKSP  5        3
  UVQUAN jjul5  GLOBAL     WORKSP  6        3 
  UVQUAN itemp  GLOBAL     WORKSP  7        3
  UVQUAN jnov16 GLOBAL     WORKSP  8        3
  UVQUAN jjun15 GLOBAL     WORKSP  9        3
  UVQUAN jjul15 GLOBAL     WORKSP 10        3
  UVQUAN jjun8  GLOBAL     WORKSP 11        3
  UVQUAN jjun23 GLOBAL     WORKSP 12        3
  UVQUAN jjun1  GLOBAL     WORKSP 13        3
  UVQUAN jmay15 GLOBAL     WORKSP 14        3
  UVQUAN frflag GLOBAL     WORKSP 15        2 
  UVQUAN wdflag GLOBAL     WORKSP 16        2

  UVQUAN month  COPY     1 MON              2             
  UVQUAN day    COPY     1 DAY              2   
  UVQUAN year   COPY     1 YR               2  
 
*****************************************************************************
*** LAKE TAHOE VARIABLES
*****************************************************************************
*** User-Defined Target Variable Names **
***                  addr or                       addr or       **
***                 <------>                      <------>       **
*** kwd   varnam ct  vari  s1 s2 s3  frac oper     vari  s1 s2 s3  frac oper**
  <****>  <----><-> <----><-><-><-> <---> <-->    <----><-><-><-> <---> <-->**
  UVNAME  TSPL    1 WORKSP 21         1.0 
  UVNAME  TVOL    1 WORKSP 22         1.0 
  UVNAME  TOFL    1 WORKSP 23         1.0  
  UVNAME  TSHTVF  1 WORKSP 24         1.0 
  UVNAME  TRLS    1 WORKSP 25         1.0     
  UVNAME  TSTOE   1 WORKSP 26         1.0     
  UVNAME  TNET    1 WORKSP 27         1.0     
  UVNAME  TFORE   1 WORKSP 28         1.0     
  UVNAME  TNVOL   1 WORKSP 29         1.0     
  UVNAME  TPWRB   1 WORKSP 30         1.0     
  UVNAME  TPWRA   1 WORKSP 31         1.0     
  UVNAME  TMAXQ   1 WORKSP 32         1.0     
  UVNAME  TRLSF   1 WORKSP 33         1.0     
  UVNAME  TRLST   1 WORKSP 34         1.0     
  UVNAME  TPWRAA  1 WORKSP 35         1.0     
  UVNAME  TDMRAA  1 WORKSP 36         1.0     
  UVNAME  TREL    1 WORKSP 37         1.0     
*** use 50-51 store.uci
  UVNAME  TFLAG   1 WORKSP 50         1.0     
*** add 52-53 from master.uci
  UVNAME  TDRW    1 WORKSP 52         1.0     
  UVNAME  TDIFV   1 WORKSP 53         1.0     


***  variables   tspl   - tahoe flood releases spill, cfs
***              tvol   - avlailable flow in tahoe above rim, in ac-ft/day
***              tofl   - tahoe pooled releases,cfs
***              tshtvf - shortfall in tahoe min releases, in cfs
***              tshtv  - shortfall in tahoe min releases, in volume, ft3
***              trls   - tahoe total releases,cfs
***              tstoe  - tahoe forecast from SCS, ac-ft
***              tnet   - tahoe daily inflow calculated from storage change,cfs
***              tfore  - tahoe estimated forecast, in ac-ft
***              tnvol  - tahoe daily net storage available, in ac-ft
***              tstg   - tahoe stage, in feet
***              tpwrb  - tahoe pooled-water release berore adjustment, in cfs
***              tpwra  - tahoe pooled-water release after adjustment, in cfs
***              tmaxq  - tahoe maximum release flow, in cfs
***              trlsf  - tahoe releases from floriston rls block, in cfs
***              trlst  - tahoe running total of all releases, in cfs
***              tpwraa - additional tahoe pooled releases to meet SOP demand
***                       not met by releases from other blocks, in cfs
***              tdmraa - difference between release mandated by SOP's and   
***                       releases necessary for Floriston Rates, in cfs
***              trel   - maximum of all types of releases for merge routine
***              tflag  - storage flag based on SOP's, no storage = 0,
***                       storage =1
***              tdrw   - tahoe spill releases through gates
***              tdifv  - change in volume, tahoe, ac-ft
***              tdifvf - change in volume, tahoe, cfs

*** User-Defined Variable Quantity Lines
***                          addr
***                        <------>
*** kwd  varnam optyp  opn  vari  s1 s2 s3 tp multiply  lc ls ac as agfn ***
  <****> <----> <----> <-> <----><-><-><-><-><--------> <><-> <><-> <--> ***
 
  UVQUAN tspl   GLOBAL     WORKSP 21
  UVQUAN tvol   GLOBAL     WORKSP 22 
  UVQUAN tofl   GLOBAL     WORKSP 23
  UVQUAN tshtvf GLOBAL     WORKSP 24
  *** use 86400 to convert cfs to ft3  
  UVQUAN tshtv  GLOBAL     WORKSP 24          86400.
  UVQUAN trls   GLOBAL     WORKSP 25
  UVQUAN tstoe  GLOBAL     WORKSP 26
  UVQUAN tnet   GLOBAL     WORKSP 27
*** use 1.98348 to convert cfs  to ac-ft using tnetv 
  UVQUAN tnetv  GLOBAL     WORKSP 27          1.98348
  UVQUAN tfore  GLOBAL     WORKSP 28
  UVQUAN tnvol  GLOBAL     WORKSP 29
  UVQUAN tpwrb  GLOBAL     WORKSP 30
  UVQUAN tpwra  GLOBAL     WORKSP 31                         
  UVQUAN tmaxq  GLOBAL     WORKSP 32
  UVQUAN trlsf  GLOBAL     WORKSP 33
  UVQUAN trlst  GLOBAL     WORKSP 34
  UVQUAN tpwraa GLOBAL     WORKSP 35
  UVQUAN tdmraa GLOBAL     WORKSP 36
  UVQUAN trel   GLOBAL     WORKSP 37
  UVQUAN tflag  GLOBAL     WORKSP 50        2

  UVQUAN tdrw   GLOBAL     WORKSP 52
  UVQUAN tdifv  GLOBAL     WORKSP 53
  UVQUAN tdifvf GLOBAL     WORKSP 53         .50417

  UVQUAN tifl   RCHRES 100 IVOL              0.00001157          ***
  UVQUAN tifl   COPY     1 MEAN    1         
  UVQUAN tiflv  COPY     1 MEAN    1         1.98348
  UVQUAN tstg   RCHRES 100 STAGE 
  UVQUAN tsto   RCHRES 100 VOL              4 2.2957E-5
  UVQUAN tstol  RCHRES 100 VOL              40.00001157 DY  1    
  UVQUAN tstot  RCHRES 100 VOL              40.00001157                      
  UVQUAN tfor   COPY     2 MEAN    1         1000.
  UVQUAN tpwvf  RCHRES 100 CVOL   pw        40.00001157
 
***  tifl   - tahoe inflow    0.00001157 convert cubic ft to cfs 
***  tiflv  - lake tahoe inflow from  synthesized data, in ac-ft
***  tstg   - tahoe stage ,elevation
***  tsto   - tahoe volume - convert ft3 to ac-ft by   2.2957E-5         
***  tstol  - tahoe  yesterdays storage, lagged one day in cfs
***  tstot  - tahoe  todays storage in cfs
***  tfor   - SCS tahoe forecast april rise, 1000 ac-ft, converted to ac-ft 
***  tpwvf  - tahoe pw category volume in cfs
  
*******************************************************************************
*** DONNER LAKE VARIABLES
*******************************************************************************
  UVNAME  DMAX    1 WORKSP104         1.0  
*** use 108-9 from merge.uci
  UVNAME  DAVLV   1 WORKSP105         1.0  
  UVNAME  DSPL    1 WORKSP106         1.0  
  UVNAME  DDIFV   1 WORKSP107         1.0  
  UVNAME  DMAXQ   1 WORKSP108         1.0  
  UVNAME  DSHTVF  1 WORKSP109         1.0  
  UVNAME  DRLS    1 WORKSP110         1.0  
  UVNAME  DSPRA   1 WORKSP111         1.0  
  UVNAME  DTCRA   1 WORKSP112         1.0  
  UVNAME  DOFL    1 WORKSP113         1.0  
  UVNAME  DMFL    1 WORKSP114         1.0  
  UVNAME  DVOL    1 WORKSP115         1.0  
  UVNAME  DDRW    1 WORKSP116         1.0  
  UVNAME  DNET    1 WORKSP117         1.0     
  UVNAME  DFLAG   1 WORKSP118         1.0
*** use 119-122 store.uci
  UVNAME  DRLST   1 WORKSP119         1.0      
  UVNAME  DPSVC   1 WORKSP120         1.0     
  UVNAME  DPSVCE  1 WORKSP121         1.0     
  UVNAME  DCAP    1 WORKSP122         1.0     
  UVNAME  DNVOL   1 WORKSP123         1.0     
*** use 124-9 from merge.uci for storage
  UVNAME  DDUMP   1 WORKSP124         1.0     
  UVNAME  DSPRAA  1 WORKSP125         1.0
  UVNAME  DWCAP   1 WORKSP126         1.0
  UVNAME  DREL    1 WORKSP127         1.0
  UVNAME  DNWTRA  1 WORKSP128         1.0
  UVNAME  DTCRAA  1 WORKSP129         1.0
  UVNAME  DMIN    1 WORKSP130         1.0
  UVNAME  DNWRA   1 WORKSP131         1.0
  UVNAME  DNWRAA  1 WORKSP132         1.0
  UVNAME  DNWTV   1 WORKSP133         1.0
  UVNAME  DDMRAA  1 WORKSP134         1.0 

***              dmax   - maximum storage to stay on spring rule curve,ac-ft
***              dmaxf  - maximum storage to stay on spring rule curve,cfs
***              davlv  - available storage in doneer, ac-ft
***              davlvf - available storage in doneer, converted to cfs
***              dspl   - donner spill , cfs
***              ddifv  - donner  difference volume. ac-ft     
***              ddifvf - donnerr difference volume converted to cfs
***              dmaxq  - maximum donner rating discharge, cfs
***              dshtvf - shortfall in donner min releases, in cfs
***  variables   drls   - counter for minimum donner releases,cfs
***              dspra  - release demand for sppc water,cfs
***              dtcra  - release demand for tcid water,cfs
***              dofl   - total release demand for donner,cfs
***              dmfl   - minimum release demand for donner,cfs
***              dvol   - storage avail above elevation 5926.9, in ac-ft/day
***              dvolf  - storage avail above elevation 5926.9, in cfs
***              ddrw   - counter for precaution drawdown sep15-nov15,cfs
***              dnet   - donner daily inflow calculated from storage change,cfs
***              dflag  - storage flag based on SOP's, no storage = 0,
***                       storage =1
***              drlst  - donner  running total of all releases, in cfs  
***              dpsvc  - cummulative amount stored ,ac-ft, up to 9500 ac-ft
***              dpsvce - excess amount stored ,ac-ft, 
***              dcap   - donner capacity to store, ac-ft 
***              dnvol  - donner daily net storage available, in ac-ft
***              ddump  - donner release from storage per storage priority,
***                       in cfs  
***              dspraa - additional donner spac  releases to meet SOP 
***                       demand not met by releases from other blocks, in cfs
***              dwcap  - wintertime cap to store , ac-ft 
***              drel   - maximum of all types of releases for merge routine
***                       demand not met by releases from other blocks, in cfs
***              dnwtra - donner natural water not released available for 
***                       storage, cfs
***              dnwtrv - donner natural water not released available for 
***                       storage, ac-ft
***              dnwtrf - donner natural water not released available for 
***                       storage, ft3
***              dtcraa - donner tcid category adjusted flow, cfs
***              dmin   - donner minimum annual storage, in ac-ft
***              dnwra  - donner natural water releases, in cfs
***              dnwraa - donner net water category adjusted flow, in cfs
***              dnwtv  - donner split net release available for storage, ft3
***              ddmraa - additional releases of available categories to meet
***                       demand not met by releases from other blocks, in cfs
 
  UVQUAN dmax   GLOBAL     WORKSP104
  ***  use 0.50417 to convert ac-ft/day to cfs
  UVQUAN dmaxf  GLOBAL     WORKSP104         0.50417
  UVQUAN davlv  GLOBAL     WORKSP105 
  UVQUAN davlvf GLOBAL     WORKSP105         .50417 
  UVQUAN dspl   GLOBAL     WORKSP106 
  UVQUAN ddifv  GLOBAL     WORKSP107 
  UVQUAN ddifvf GLOBAL     WORKSP107         .50417
  UVQUAN dmaxq  GLOBAL     WORKSP108 
  UVQUAN dshtvf GLOBAL     WORKSP109 
  UVQUAN drls   GLOBAL     WORKSP110 
  UVQUAN fnwfsv GLOBAL     WORKSP891                          DY  3 AVER   ***
  UVQUAN dspra  GLOBAL     WORKSP111                         
  UVQUAN dtcra  GLOBAL     WORKSP112                         
  UVQUAN dofl   GLOBAL     WORKSP113
  UVQUAN dmfl   GLOBAL     WORKSP114
  UVQUAN dvol   GLOBAL     WORKSP115
  ***  use 0.50417 to convert ac-ft/day to cfs
  UVQUAN dvolf  GLOBAL     WORKSP115         0.50417
  UVQUAN ddrw   GLOBAL     WORKSP116
  UVQUAN dnet   GLOBAL     WORKSP117
  UVQUAN dflag  GLOBAL     WORKSP118        2
  UVQUAN drlst  GLOBAL     WORKSP119 
  UVQUAN dpsvc  GLOBAL     WORKSP120        
  UVQUAN dpsvce GLOBAL     WORKSP121
  UVQUAN dcap   GLOBAL     WORKSP122
  UVQUAN dnvol  GLOBAL     WORKSP123
  UVQUAN ddump  GLOBAL     WORKSP124
  UVQUAN dspraa GLOBAL     WORKSP125
  UVQUAN dwcap  GLOBAL     WORKSP126
  UVQUAN drel   GLOBAL     WORKSP127
  UVQUAN dnwtra GLOBAL     WORKSP128
*** 1.98348 converts cfs to ac-ft
  UVQUAN dnwtrv GLOBAL     WORKSP128         1.98348
*** 86400.  converts cfs to ft3  
  UVQUAN dnwtrf GLOBAL     WORKSP128         86400.
  UVQUAN dtcraa GLOBAL     WORKSP129
  UVQUAN dmin   GLOBAL     WORKSP130
  UVQUAN fnwfsv GLOBAL     WORKSP891                          DY  3 AVER   ***
  UVQUAN dnwra  GLOBAL     WORKSP131                         
  UVQUAN dnwraa GLOBAL     WORKSP132
  UVQUAN dnwtv  GLOBAL     WORKSP133
  UVQUAN ddmraa GLOBAL     WORKSP134   



  UVQUAN dstg   RCHRES 145 STAGE
  UVQUAN difl   COPY     1 MEAN    3        
  UVQUAN diflv  COPY     1 MEAN    3         1.98348
  UVQUAN ddmd   COPY     1 MEAN    2      
  UVQUAN dsto   RCHRES 145 VOL              4 2.2957E-5
  UVQUAN devp   RCHRES 145 VOLEV             0.00001157 
  UVQUAN dstofl RCHRES 145 VOL              40.00001157 DY  1    
  UVQUAN dstoft RCHRES 145 VOL              40.00001157
  UVQUAN dspvf  RCHRES 145 CVOL   sp        40.00001157
  UVQUAN dtcvf  RCHRES 145 CVOL   tc        40.00001157
  UVQUAN dnwvf  RCHRES 145 CVOL   nw        40.00001157

***   dstg   -  donner lake stage,elevation
***   difl   -  donner lake inflow from dsn 106 - rod hall synthesized data,
***             in cfs
***   diflv  -  donner lake inflow from dsn 106 synthesized data, in ac-ft
***   ddmd   -  donner lake demand time series dsn 113, cfs
***   dsto   -  donner volume - convert ft3 to ac-ft by   2.2957E-5
***   devp   -  donner evap, 0.00001157 convert cubic ft to cfs
***   dstofl -  donner yesterdays storage, lagged one day in cfs
***   dstoft -  donner todays storage in cfs
***   dspvf  -  donner sierra pac category volume in cfs 
***   dtcvf  -  donner tcid category volume in cfs
***   dnwvf  -  donner nat water category volume in cfs
  
*******************************************************************************
*** MARTIS CREEK RESERVOIR VARIABLES
*******************************************************************************

  UVNAME  MSPL    1 WORKSP140         1.0  
  UVNAME  MRLS    1 WORKSP141         1.0  
  UVNAME  MNET    1 WORKSP142         1.0     
  UVNAME  MNVOL   1 WORKSP143         1.0     
*** add 224 from master.uci
  UVNAME  MMAXQ   1 WORKSP144         1.0     

***  variables   mspl   - counter for martis flood spills,cfs
***              mrls   - total release demand for martis,cfs
***              mnet   - martis daily inflow calculated from storage change,cfs
***              mnvol  - martis daily net available storage, in ac-ft
***              mmaxq  - martis maximum possible gated release, cfs
 
  UVQUAN mspl   GLOBAL     WORKSP140 
  UVQUAN mrls   GLOBAL     WORKSP141 
  UVQUAN mnet   GLOBAL     WORKSP142 
  UVQUAN mnvol  GLOBAL     WORKSP143 
  UVQUAN mmaxq  GLOBAL     WORKSP144 

  UVQUAN mstg   RCHRES 168 STAGE 
  UVQUAN mifl   COPY     1 MEAN    7
  UVQUAN mdmd   COPY     1 MEAN    8 
  UVQUAN mstol  RCHRES 168 VOL              40.00001157 DY  1    
  UVQUAN msto   RCHRES 168 VOL              40.00001157

***   mstg   -  martis stage,elevation
***   mifl   -  martis lake inflow from dsn 122 - rod hall syn data set,cfs
***   mdmd   -  martis lake demand time series ,cfs
***   mstol  -  martis yesterdays storage, lagged one day in cfs
***   msto   -  martis todays storage in cfs
 
*****************************************************************************
*** PROSSER CREEK RESERVOIR VARIABLES
*****************************************************************************
*** use 310-4 from merge.uci storage 
  UVNAME  PFFLAG  1 WORKSP311         1.0 
  UVNAME  PAVLV   1 WORKSP312         1.0 
  UVNAME  PWCAP   1 WORKSP313         1.0 
  UVNAME  PDUMP   1 WORKSP314         1.0 
*** use 315 from merge.uci
  UVNAME  PSHTVF  1 WORKSP315         1.0 
*** use 316 from flor.rate.tpex.uci
  UVNAME  PNWTF   1 WORKSP316         1.0     
*** use 317-18 from master.uci
  UVNAME  PTOTV   1 WORKSP317         1.0 
  UVNAME  PDIFV   1 WORKSP318         1.0 
*** use 319-324 store.uci
  UVNAME  PCAP    1 WORKSP319         1.0  
  UVNAME  PNETRE  1 WORKSP320         1.0  
  UVNAME  PUWVC   1 WORKSP321         1.0  
  UVNAME  PUWVCE  1 WORKSP322         1.0  
  UVNAME  PNWTRA  1 WORKSP323         1.0  
  UVNAME  PFLAG   1 WORKSP324         1.0 
  UVNAME  PSPL    1 WORKSP325         1.0 
  UVNAME  PRLS    1 WORKSP326         1.0 
  UVNAME  PMFL    1 WORKSP327         1.0 
  UVNAME  POFL    1 WORKSP328         1.0     
  UVNAME  PVOL    1 WORKSP329         1.0 
  UVNAME  PUWRA   1 WORKSP330         1.0 
  UVNAME  PTXRA   1 WORKSP331         1.0 
  UVNAME  PMAX    1 WORKSP332         1.0 
  UVNAME  PDAT    1 WORKSP333         1.0  
  UVNAME  PDRW    1 WORKSP334         1.0  
  UVNAME  PNET    1 WORKSP335         1.0  
  UVNAME  PNWV    1 WORKSP336         1.0 
*** 337-354 from flor.rate.uci
  UVNAME  PNVOL   1 WORKSP337         1.0   ***gwh 9/28/95
  UVNAME  PVOLN   1 WORKSP338         1.0  
  UVNAME  PTXV    1 WORKSP339         1.0 
  UVNAME  PTXV_N  1 WORKSP340         1.0
  UVNAME  PTXV_R  1 WORKSP341         1.0
  UVNAME  PTXR_N  1 WORKSP342         1.0
  UVNAME  PTXR_R  1 WORKSP343         1.0
  UVNAME  PUWV    1 WORKSP344         1.0 
  UVNAME  PUWVA   1 WORKSP345         1.0
  UVNAME  PUWVT   1 WORKSP346         1.0
  UVNAME  PUWVR   1 WORKSP347         1.0
  UVNAME  PRECV   1 WORKSP348         1.0
  UVNAME  PMAXQ   1 WORKSP349         1.0
  UVNAME  PTXRB   1 WORKSP350         1.0
  UVNAME  PSUMTX  1 WORKSP351         1.0
  UVNAME  PUWRB   1 WORKSP352         1.0
  UVNAME  PNWRA   1 WORKSP353         1.0
  UVNAME  PNWRB   1 WORKSP354         1.0
  UVNAME  PRLSF   1 WORKSP355         1.0
  UVNAME  PRLST   1 WORKSP356         1.0
  UVNAME  PUWRAA  1 WORKSP357         1.0
  UVNAME  PTXRAA  1 WORKSP358         1.0
  UVNAME  PNWRAA  1 WORKSP359         1.0
  UVNAME  PDMRAA  1 WORKSP360         1.0
  UVNAME  PREL    1 WORKSP361         1.0

***              pfflag - prosser flag if drawing from storage to meet 
***                       floriston rates 0-yes 1- no
***              pavlv  - prosser storage available, ac-ft
***              pavlvf - prosser storage available, coverted to cfs
***              pwcap  - prosser winter cpacaity to store, ac-ft
***              pdump  - prosser release from storage per storage priority,
***                       in cfs
***              pshtvf - shortfall in prosser min releases, in cfs
***              pnwtf  - prosser net daily uncommitted water available, in cfs
***              ptotv  - prosser total volume inflow, ac-ft
***              pdifv  - prosser difference volume. ac-ft
***              pdifvf - prosser difference volume converted to cfs
***              pcap   - prosser capacity storage, 30000 ac-ft
***              pnetre - prosser excess net release after adjustment,cfs
***              puwvc  - cummulative amount stored ,ac-ft, up to 30,000 ac-ft
***              puwvce - excess cummulative amount stored ,ac-ft, 
***              pnwtra - prosser natural water, after proposed releases, 
***                       available for storage, in cfs
***              pnwtrv - prosser natural water, after proposed releases, 
***                       available for storage, in ac-ft
***              pnwtrf - prosser natural water, after proposed releases, 
***                       available for storage, in ft3
***              pflag  - storage flag based on SOP's, no storage = 0,
***                       storage =1
*** variables    pspl   - prosser flood spills,cfs
***              prls   - releases from prosser exchange water,cfs
***              pmfl   - prosser minimum fish releases to meet-5 cfs
***              pofl   - prosser total releases,cfs
***              pvol   - prosser available flow in ac-ft/day
***              pvolf  - prosser available flow in cfs
***              puwra  - prosser releases uncommitted,cfs
***              ptxra  - prosser tahoe-exchange release after adjustment,
***                       in cfs
***              pmax   - amount need to fill reservoir by May 20,ac-ft
***              pmaxf  - amount need to fill reservoir by May 20,cfs
***              pdat   - date to begin precautionary splls prior to nov 1
***              pdrw   - precautionary drawdown,cfs
***              pnet   - prosser daily inflow calculated from storage change,
***                       in cfs
***              pnwv   - prosser natural water volume with dead storage,
***                       in ac-ft
***              pnwvf  - prosser natural water volume with dead storage,
***                       in cfs  
***              pnvol  - prosser daily net available storage, in ac-ft
***              pvoln  - prosser usable storage volume for nonrecreation,
***                       in ac-ft 
***              ptxv   - prosser tahoe-exchange water volume with dead storage,
***                       in ac-ft
***              ptxvf  - prosser tahoe-exchange water volume with dead storage,
***                       in cfs
***              ptxv_n - prosser tahoe-exchange water volume for 
***                       nonrecreation, in ac-ft
***              ptxvfn - prosser tahoe-exchange water volume for 
***                       nonrecreation converted to a flow, in cfs
***              ptxv_r - prosser tahoe-exchange water volume for 
***                       recreation, in ac-ft
***              ptxvfr - prosser tahoe-exchange water volume for 
***                       recreation converted to a flow, in cfs
***              ptxr_n - prosser tahoe-exchange release for 
***                       nonrecreation, in cfs
***              ptxr_r - prosser tahoe-exchange release for 
***                       recreation, in cfs
***              puwv   - prosser uncommitted category without dead storage,
***                       in ac-ft
***              puwvf  - prosser uncommitted category expressed as flow, in cfs
***              puwva  - prosser uncommitted water volume after adjustment,
***                       in ac-ft
***              puwvt  - prosser total uncommitted plus natural water volume 
***                       in ac-ft
***              puwvr  - prosser uncommitted water volume for recreation,
***                       in ac-ft
***              precv  - prosser recreation volume threshold, in ac-ft,
***              pmaxq  - prosser maximum release flow, in cfs   
***              ptxrb  - prosser tahoe-exchange release before adjustment,
***                       in cfs
***              psumtx - prosser scratch variable sum of exchange water   
***                       release, in cfs
***              puwrb  - prosser uncommitted water before adjustment,     
***                       in cfs
***              pnwra  - prosser natural water after adjustment,          
***                       in cfs
***              pnwrb  - prosser natural water before adjustment,
***                       in cfs
***              prlsf  - releases from prosser exchange water from flrstn
***                       release block
***              prlst  - prosser running total of all releases, in cfs
***              puwraa - additional prosser uncommitted releases to meet SOP 
***                       demand not met by releases from other blocks, in cfs
***              ptxraa - additional prosser exchange releases to meet SOP
***                       demand not met by releases from other blocks, in cfs
***              pnwraa - additional prosser natural releases to meet SOP 
***                       demand not met by releases from other blocks, in cfs
***              pdmraa - proposed additional releases determined by comparing 
***                       SOP and Floriston Rates demands
***              prel   - maximum of all types of releases for merge routine

  UVQUAN pfflag GLOBAL     WORKSP311        2
  UVQUAN pavlv  GLOBAL     WORKSP312
  UVQUAN pavlvf GLOBAL     WORKSP312
  UVQUAN pwcap  GLOBAL     WORKSP313
  UVQUAN pdump  GLOBAL     WORKSP314
  UVQUAN pshtvf GLOBAL     WORKSP315
  UVQUAN pnwtf  GLOBAL     WORKSP316    
  UVQUAN ptotv  GLOBAL     WORKSP317
  UVQUAN pdifv  GLOBAL     WORKSP318
  UVQUAN pdifvf GLOBAL     WORKSP318         .50417
  UVQUAN pcap   GLOBAL     WORKSP319
  UVQUAN pnetre GLOBAL     WORKSP320
  UVQUAN puwvc  GLOBAL     WORKSP321        
  UVQUAN puwvce GLOBAL     WORKSP322        
  UVQUAN pnwtra GLOBAL     WORKSP323
*** 1.98348 converts cfs to ac-ft
  UVQUAN pnwtrv GLOBAL     WORKSP323         1.98348
*** 86400.  converts cfs to ft3
  UVQUAN pnwtrf GLOBAL     WORKSP323         86400.
  UVQUAN pflag  GLOBAL     WORKSP324        2
  UVQUAN pspl   GLOBAL     WORKSP325
  UVQUAN prls   GLOBAL     WORKSP326
  UVQUAN pmfl   GLOBAL     WORKSP327
  UVQUAN pofl   GLOBAL     WORKSP328
  UVQUAN pvol   GLOBAL     WORKSP329 
*** use .50417 to convert ac-ft/day  to cfs using pvolf 
  UVQUAN pvolf  GLOBAL     WORKSP329         .50417  ***gwh 10/9/95
  UVQUAN puwra  GLOBAL     WORKSP330
  UVQUAN ptxra  GLOBAL     WORKSP331                        
  UVQUAN pmax   GLOBAL     WORKSP332
  ***  use 0.50417 to convert ac-ft/day to cfs
  UVQUAN pmaxf  GLOBAL     WORKSP332         0.50417
  UVQUAN pdat   GLOBAL     WORKSP333        3
  UVQUAN pdrw   GLOBAL     WORKSP334
  UVQUAN pnet   GLOBAL     WORKSP335
  UVQUAN pnwv   GLOBAL     WORKSP336 
  UVQUAN pnwvf  GLOBAL     WORKSP336         .50417 
  UVQUAN pnvol  GLOBAL     WORKSP337 *** gwh 9/28/95
  UVQUAN pvoln  GLOBAL     WORKSP338 
  UVQUAN ptxv   GLOBAL     WORKSP339 
  UVQUAN ptxvf  GLOBAL     WORKSP339         .50417 
  UVQUAN ptxv_n GLOBAL     WORKSP340 
  UVQUAN ptxvfn GLOBAL     WORKSP340         .50417
  UVQUAN ptxv_r GLOBAL     WORKSP341 
  UVQUAN ptxvfr GLOBAL     WORKSP341         .50417
  UVQUAN ptxr_n GLOBAL     WORKSP342 
  UVQUAN ptxr_r GLOBAL     WORKSP343 
  UVQUAN puwv   GLOBAL     WORKSP344 
*** use .50417 to convert ac-ft/day  to cfs using puwv
  UVQUAN puwvf  GLOBAL     WORKSP344         .50417
  UVQUAN puwva  GLOBAL     WORKSP345 
  UVQUAN puwvt  GLOBAL     WORKSP346 
  UVQUAN puwvr  GLOBAL     WORKSP347 
  UVQUAN precv  GLOBAL     WORKSP348 
  UVQUAN pmaxq  GLOBAL     WORKSP349 
  UVQUAN ptxrb  GLOBAL     WORKSP350 
  UVQUAN psumtx GLOBAL     WORKSP351 
  UVQUAN puwrb  GLOBAL     WORKSP352 
  UVQUAN pnwra  GLOBAL     WORKSP353 
  UVQUAN pnwrb  GLOBAL     WORKSP354 
  UVQUAN prlsf  GLOBAL     WORKSP355
  UVQUAN prlst  GLOBAL     WORKSP356
  UVQUAN puwraa GLOBAL     WORKSP357
  UVQUAN ptxraa GLOBAL     WORKSP358
  UVQUAN pnwraa GLOBAL     WORKSP359
  UVQUAN pdmraa GLOBAL     WORKSP360
  UVQUAN prel   GLOBAL     WORKSP361

  UVQUAN pstg   RCHRES 178 STAGE 
  UVQUAN pifl   RCHRES 178 IVOL              0.00001157       ***
  UVQUAN pifl   COPY     1 MEAN    5
  UVQUAN piflv  COPY     1 MEAN    5         1.98348
  UVQUAN psto   RCHRES 178 VOL              4 2.2957E-5                      
  UVQUAN pdmd   COPY     1 MEAN    4    
  UVQUAN pevp   RCHRES 178 VOLEV             0.00001157 
  UVQUAN pstol  RCHRES 178 VOL              40.00001157 DY  1           
  UVQUAN pstot  RCHRES 178 VOL              40.00001157 
  UVQUAN pnws   RCHRES 178 CVOL   nw        4 2.2957E-5 
  UVQUAN ptxs   RCHRES 178 CVOL   px        4 2.2957E-5 
  UVQUAN puws   RCHRES 178 CVOL   pu        4 2.2957E-5 

 
***   pstg   -  prosser stage,elevation
***   pifl   -  prosser inflow , 0.000012 convert cubic ft to cfs 
***   piflv  -  prosser inflow , 1.98348 convert cfs to ac-ft
***   psto   -  prosser volume - convert ft3 to ac-ft by   2.2957E-5         
***   pdmd   -  prosser lake demand time series dsn 134, cfs
***   pevp   -  evaporation for the reservoir, 0.000012 convert cubic ft to cfs
***   pstol  -  prosser yesterdays storage, lagged one day in cfs
***   pstot  -  prosser todays storage in cfs
***   pnws   -  prosser natural category volume,dead storage not considered,
***             in ac-ft
***   ptxs   -  prosser tahoe-exchange volume,ac-ft dead storage not considered
***   puws   -  prosser uncommitted volume, in ac-ft, dead storage not
***             considered
 
*******************************************************************************
*** SIERRA VALLEY - LITTLE TRUCKEE RIVER VARIABLES
*******************************************************************************

  UVNAME  SVRA    1 WORKSP585         1.0
  UVNAME  SVCUMV  1 WORKSP586         1.0  

***               svra   - counter for sierra valley diversions,operations,cfs
***               svcumv - sum the total sierra valley diversion ,cfs

  UVNAME  LTMFL   1 WORKSP501         1.0
  UVNAME  LTFLAG  1 WORKSP502         1.0  ***
  UVNAME  LTQ     1 WORKSP503         1.0
  UVNAME  LTNWFW  1 WORKSP505         1.0  
  UVNAME  LTNWFS  1 WORKSP506         1.0  


***  variables    ltmfl  - amount of ltmfl releases, 3 or 5 cfs, cfs
***               ltflag - flag for switching on and off
***               ltq    - total flow available in L.Truckee River,cfs 
***               ltnwfw - natural flow at l.Truckee, calculated, FWM method,cfs
***               ltnwfs - natural flow at l.truckee, calculated, SCS method,cfs
 
  UVQUAN svra   GLOBAL     WORKSP585
  UVQUAN svcumv GLOBAL     WORKSP586

***
  UVQUAN ltmfl  GLOBAL     WORKSP501
  UVQUAN ltflag GLOBAL     WORKSP502        2 ***
  UVQUAN ltq    GLOBAL     WORKSP503
  UVQUAN ltnwfw GLOBAL     WORKSP505
  UVQUAN ltnwfs GLOBAL     WORKSP506


  UVQUAN ltifl  RCHRES 185 IVOL              0.00001157         
  UVQUAN ltfor  COPY     2 MEAN    2         1000.    

***   ltifl  - l.truckee r. inflow above div, 0.000012 convert cubic ft to cfs 
***   ltfor  - l. truckee ab boca SCS forecast,1000 ac-ft, converted to ac-ft

  UVQUAN svdmd  COPY     1 MEAN   15       
  UVQUAN svrb   RCHRES 185 O       1

***   svdmd  - sierra v. demand time series dsn 499,using 498 for test,cfs
***   svrb   - actual sierra valley diversion outflow,cfs

*******************************************************************************
*** INDPENDENCE LAKE VARIABLES
*******************************************************************************
*** use 443-8 merge.uci storage 
  UVNAME  IAVLV   1 WORKSP439         1.0  
  UVNAME  ISPRA   1 WORKSP440         1.0  
  UVNAME  INWRA   1 WORKSP441         1.0   
  UVNAME  INWRAA  1 WORKSP442         1.0  
  UVNAME  INWTRA  1 WORKSP443         1.0  
  UVNAME  IREL    1 WORKSP444         1.0  
  UVNAME  IMAXQ   1 WORKSP445         1.0  
  UVNAME  IWCAP   1 WORKSP446         1.0  
  UVNAME  ISPRAA  1 WORKSP447         1.0  
  UVNAME  IDUMP   1 WORKSP448         1.0  
*** use 449 merge.uci
  UVNAME  ISHTVF  1 WORKSP449         1.0  
  UVNAME  IRLS    1 WORKSP450         1.0  
  UVNAME  IMFL    1 WORKSP451         1.0  
  UVNAME  ISPL    1 WORKSP452         1.0  
  UVNAME  IOFL    1 WORKSP453         1.0  
  UVNAME  ISPVC   1 WORKSP454         1.0  
  UVNAME  IVOL    1 WORKSP455         1.0  
  UVNAME  IDAT    1 WORKSP456         1.0  
  UVNAME  IDRW    1 WORKSP457         1.0  
  UVNAME  INET    1 WORKSP458         1.0  
  UVNAME  IFLAG   1 WORKSP459         1.0
*** use 460-465 store.uci
  UVNAME  IRLST   1 WORKSP460         1.0   
  UVNAME  ICAP1   1 WORKSP462         1.0  
  UVNAME  ICAP2   1 WORKSP463         1.0 
  UVNAME  INVOL   1 WORKSP464         1.0  
  UVNAME  IDIFV   1 WORKSP465         1.0  
  UVNAME  IMAX    1 WORKSP466         1.0  
  UVNAME  INWVCE  1 WORKSP467         1.0  
  UVNAME  IDMRAA  1 WORKSP468         1.0  

***              iavlv  - independence avaialble storage, ac-ft
***              iavlvf - independence avaialble storage, volume converted
***                       to cfs
***              ispra  - independence sierra pac releases, cfs
***              inwra  - independence natural water releases, cfs
***              inwraa - additional indep nw    releases to meet SOP 
***                       demand not met by releases from other blocks, in cfs
***              inwtra - independence natural water, after releases,
***                       available for storage, cfs
***              inwtrv - independence natural water, after releases,
***                       available for storage, ac-ft
***              inwtrf - independence natural water, after release,
***                       available for storage, ft3
***              irel   - maximum of all types of releases for merge routine
***              imaxq  - independence max rating discharge, cfs 
***              iwcap  - independence winter capacity, ac-ft
***              ispraa - additional indep spac  releases to meet SOP 
***                       demand not met by releases from other blocks, in cfs
***              idump  - indepe release from storage per storage priority,
***                       in cfs  
***              ishtvf - shortfall in indep min releases, in cfs
***  variables   irls   - counter for min independence releases,cfs
***              imfl   - minimum release demand for independence,cfs
***              ispl   - counter for independence flood releases,cfs
***              iofl   - total release demand for independence,cfs
***              ispvc  - cummulative amount stored dec1 to july1,ac-ft
***              ivol   - storage avail in ac-ft/day
***              ivolf  - storage avail in cfs
***              idat   - date to begin precautionary splls prior to nov 1
***              idrw   - precautionary drawdown,cfs
***              inet   - indepen daily inflow calculated from storage change,
***                       in cfs
***              iflag  - storage flag based on SOP's, no storage = 0,
***                       storage = 1
***              irlst  - indepen running total of all releases, in cfs 
***              icap1  - indepen first capacity to store, ac-ft, 3000
***              icap2  - indepen second capacity to store, ac-ft, 17500 
***              invol  - indepen daily net avaialble storage, in ac-ft 
***              idifv  - independence difference volume. ac-ft
***              idifvf - independence difference volume converted to cfs
***              imax   - maximum storage to stay on spring rule curve,ac-ft
***              inwvce - indep excess cumm amount stored,pooled water,ac-ft
***              idmraa - additional releases of available categories to meet 
***                       demand not met by releases from other blocks, in cfs
 
  UVQUAN iavlv  GLOBAL     WORKSP439
  UVQUAN iavlvf GLOBAL     WORKSP439         0.50417
  UVQUAN ispra  GLOBAL     WORKSP440
  UVQUAN inwra  GLOBAL     WORKSP441
  UVQUAN inwraa GLOBAL     WORKSP442
  UVQUAN inwtra GLOBAL     WORKSP443
*** 1.98348 converts cfs to ac-ft
  UVQUAN inwtrv GLOBAL     WORKSP443         1.98348
*** 86400.  converts cfs to ft3
  UVQUAN inwtrf GLOBAL     WORKSP443         86400. 
  UVQUAN irel   GLOBAL     WORKSP444
  UVQUAN imaxq  GLOBAL     WORKSP445  
  UVQUAN iwcap  GLOBAL     WORKSP446 
  UVQUAN ispraa GLOBAL     WORKSP447 
  UVQUAN idump  GLOBAL     WORKSP448 
  UVQUAN ishtvf GLOBAL     WORKSP449 
  UVQUAN irls   GLOBAL     WORKSP450 
  UVQUAN imfl   GLOBAL     WORKSP451 
  UVQUAN ispl   GLOBAL     WORKSP452 
  UVQUAN iofl   GLOBAL     WORKSP453 
  UVQUAN ispvc  GLOBAL     WORKSP454
  UVQUAN ivol   GLOBAL     WORKSP455
  ***  use 0.50417 to convert ac-ft/day to cfs
  UVQUAN ivolf  GLOBAL     WORKSP455         0.50417
  UVQUAN idat   GLOBAL     WORKSP456        3
  UVQUAN idrw   GLOBAL     WORKSP457
  UVQUAN inet   GLOBAL     WORKSP458
  UVQUAN iflag  GLOBAL     WORKSP459        2
  UVQUAN irlst  GLOBAL     WORKSP460 

  UVQUAN icap1  GLOBAL     WORKSP462
  UVQUAN icap2  GLOBAL     WORKSP463
  UVQUAN invol  GLOBAL     WORKSP464 
  UVQUAN idifv  GLOBAL     WORKSP465 
  UVQUAN idifvf GLOBAL     WORKSP465         .50417
  UVQUAN imax   GLOBAL     WORKSP466
  ***  use 0.50417 to convert ac-ft/day to cfs
  UVQUAN imaxf  GLOBAL     WORKSP466         0.50417
  UVQUAN inwvce GLOBAL     WORKSP467
  UVQUAN idmraa GLOBAL     WORKSP468  

  UVQUAN istg   RCHRES 187 STAGE
  UVQUAN iifl   COPY     1 MEAN   10
*** 1.98348 converts cfs to ac-ft
  UVQUAN iiflv  COPY     1 MEAN   10         1.98348
  UVQUAN idmd   COPY     1 MEAN    9 
  UVQUAN isto   RCHRES 187 VOL              4 2.2957E-5
  UVQUAN ievp   RCHRES 187 VOLEV             0.00001157 
  UVQUAN istol  RCHRES 187 VOL              40.00001157 DY  1            
  UVQUAN istot  RCHRES 187 VOL              40.00001157 
  UVQUAN ispvf  RCHRES 187 CVOL   sp        40.00001157
  UVQUAN inwvf  RCHRES 187 CVOL   nw        40.00001157

***   istg    -  independence lake stage,elevation
***   iifl    -  independence lake inflow from dsn 149-r hall syn data, in cfs
***   iiflv   -  independence lake inflow syn data set, in ac-ft 
***   idmd    -  independence lake demand time series dsn 152,cfs
***   isto    -  independence volume - convert ft3 to ac-ft by   2.2957E-5
***   ievp    -  independence evaporation  0.000012 convert cubic ft to cfs
***   istol  -   independence yesterdays storage, lagged one day in cfs
***   istot  -   independence todays storage in cfs
***   ispvf  -   independence  sierra pac category volume in cfs
***   inwvf  -   independence  natural water category volume in cfs
 
 
*******************************************************************************
*** STAMPEDE RESERVOIR VARIABLES
*******************************************************************************
*** use 648-50 merge.uci from storage
  UVNAME  SSPRAA  1 WORKSP643         1.0  
  UVNAME  SNWRAA  1 WORKSP644         1.0  
  UVNAME  SNWRA   1 WORKSP645         1.0  
  UVNAME  SREL    1 WORKSP646         1.0  
  UVNAME  SDMRAA  1 WORKSP647         1.0  
  UVNAME  SWCAP   1 WORKSP648         1.0  
  UVNAME  SFSRAA  1 WORKSP649         1.0  
  UVNAME  SDUMP   1 WORKSP650         1.0  
*** use 651 merge.uci
  UVNAME  SSHTVF  1 WORKSP651         1.0  
*** add 652-655 master.uci
  UVNAME  STOTV   1 WORKSP652         1.0  
  UVNAME  SDIFV   1 WORKSP653         1.0  
  UVNAME  SSPL    1 WORKSP654         1.0  
  UVNAME  SMAXQ   1 WORKSP655         1.0      
*** add 656-659 store.uci
  UVNAME  SCAP    1 WORKSP656         1.0  
  UVNAME  SNETRE  1 WORKSP657         1.0  
  UVNAME  SNWVCE  1 WORKSP658         1.0  
  UVNAME  SNWVC   1 WORKSP659         1.0  
  UVNAME  SRLS    1 WORKSP660         1.0  
  UVNAME  SSPRA   1 WORKSP661         1.0  
  UVNAME  SFSRA   1 WORKSP662         1.0  
  UVNAME  SOFL    1 WORKSP663         1.0  
  UVNAME  SMFL    1 WORKSP664         1.0  
  UVNAME  SAVLV   1 WORKSP665         1.0  
  UVNAME  SDRW    1 WORKSP666         1.0  
*** add 667 store.uci
  UVNAME  SRLST   1 WORKSP667         1.0   
  UVNAME  SMAX    1 WORKSP668         1.0  
  UVNAME  SNET    1 WORKSP669         1.0  
  UVNAME  SFLAG   1 WORKSP670         1.0         
  UVNAME  SNVOL   1 WORKSP671         1.0  
  UVNAME  SNWTRA  1 WORKSP672         1.0  

***              sspraa - additional stampede sp releases to meet SOP 
***                       demand not met by releases from other blocks, in cfs
***              snwraa - additional stampede nw releases to meet SOP 
***                       demand not met by releases from other blocks, in cfs
***              snwra  - stampede nw release, cfs
***              srel   - maximum of all types of releases for merge routine
***              sdmraa - stmapede demands adjusted, in cfs
***              swcap  - stampede winter cpacity to store, ac-ft
***              sfsraa - additional stampede fish releases to meet SOP 
***                       demand not met by releases from other blocks, in cfs
***              sdump  - stampede release from storage per storage priority,in cfs 
***              sshtvf - shortfall in stampede min releases, in cfs
***              stotv  - total volume, stampede, ac-ft
***              sdifv  - difference in volume. ac-ft stampede
***              sdifvf - difference in volume.converted to cfs stampede
***              sspl   - stampede spill, cfs
***              smaxq  - maximum gated release, stampede, cfs
***              scap   - stampede capacity storage, ac-ft
***              snetre - stampede excess net release after adjustment,cfs
***              snwvce - excess cummulative amount ,ac-ft,
***              snwvc  - cummulative amount stored ,ac-ft, up to 128,000 ac-ft
***  variables   srls   - counter to minimum stampede releases,cfs
***              sspra  - release demand for sppc water,cfs
***              sfsra  - release demand for pyramid water,cfs
***              sofl   - total release demand for stampede,cfs
***              soflv  - total release demand for stampede,ac-ft
***              smfl   - minimum release demand for stampede,cfs
***              savlv  - storage avail  in ac-ft/day
***              savlvf - storage avail  in cfs
***              sdrw   - counter for precautionary drawdown in oct1-nov1,cfs
***              srlst  - stampede running total of all releases, in cfs 
***              smax   - maximum storage to stay on spring rule curve,ac-ft
***              smaxf  - maximum storage to stay on spring rule curve,cfs
***              snet   - stampede daily inflow calculated from storage change,
***                       in cfs
***              sflag  - storage flag based on SOP's, no storage = 0,
***                       storage = 1
***              snvol  - stampede daily net avaialble storage, in ac-ft
***              snwtra - stampede natural water, after proposed release, 
***                       available for storage, in cfs  
***              snwtrv - stampede natural water, after proposed release, 
***                       available for storage, in ac-ft
***              snwtrf - stampede natural water, after proposed release, 
***                       available for storage, in ft3

  UVQUAN sspraa GLOBAL     WORKSP643
  UVQUAN snwraa GLOBAL     WORKSP644
  UVQUAN snwra  GLOBAL     WORKSP645
  UVQUAN srel   GLOBAL     WORKSP646
  UVQUAN sdmraa GLOBAL     WORKSP647
  UVQUAN swcap  GLOBAL     WORKSP648
  UVQUAN sfsraa GLOBAL     WORKSP649
  UVQUAN sdump  GLOBAL     WORKSP650
  UVQUAN sshtvf GLOBAL     WORKSP651
  UVQUAN stotv  GLOBAL     WORKSP652 
  UVQUAN sdifv  GLOBAL     WORKSP653 
  UVQUAN sdifvf GLOBAL     WORKSP653         0.50417
  UVQUAN sspl   GLOBAL     WORKSP654 
  UVQUAN smaxq  GLOBAL     WORKSP655  
  UVQUAN scap   GLOBAL     WORKSP656
  UVQUAN snetre GLOBAL     WORKSP657
  UVQUAN snwvce GLOBAL     WORKSP658 
  UVQUAN snwvc  GLOBAL     WORKSP659 
  UVQUAN srls   GLOBAL     WORKSP660 
  UVQUAN sspra  GLOBAL     WORKSP661 
  UVQUAN sfsra  GLOBAL     WORKSP662 
  UVQUAN sofl   GLOBAL     WORKSP663
  *** 1.98348 convert cfs to ac-ft
  UVQUAN soflv  GLOBAL     WORKSP663         1.98348         
  UVQUAN smfl   GLOBAL     WORKSP664
  UVQUAN savlv  GLOBAL     WORKSP665
  ***  use 0.50417 to convert ac-ft/day to cfs
  UVQUAN savlvf GLOBAL     WORKSP665         0.50417
  UVQUAN sdrw   GLOBAL     WORKSP666
  UVQUAN srlst  GLOBAL     WORKSP667
  UVQUAN smax   GLOBAL     WORKSP668
  ***  use 0.50417 to convert ac-ft/day to cfs
  UVQUAN smaxf  GLOBAL     WORKSP668         0.50417
  UVQUAN snet   GLOBAL     WORKSP669
  UVQUAN sflag  GLOBAL     WORKSP670        2
  UVQUAN snvol  GLOBAL     WORKSP671
  UVQUAN snwtra GLOBAL     WORKSP672         
*** 1.98348 converts cfs to ac-ft
  UVQUAN snwtrv GLOBAL     WORKSP672         1.98348
*** 86400.  converts cfs to ft3
  UVQUAN snwtrf GLOBAL     WORKSP672         86400.

  UVQUAN sstg   RCHRES 199 STAGE                          
  UVQUAN sifl   RCHRES 199 IVOL              0.00001157         
  UVQUAN siflv  RCHRES 199 IVOL               2.2957E-5
  UVQUAN sdmd   COPY     1 MEAN   11      
  UVQUAN ssto   RCHRES 199 VOL              4 2.2957E-5
  UVQUAN sevp   RCHRES 199 VOLEV             0.00001157 
  UVQUAN sstol  RCHRES 199 VOL              40.00001157 DY  1              
  UVQUAN sstot  RCHRES 199 VOL              40.00001157
  UVQUAN sspvf  RCHRES 199 CVOL   sp        40.00001157
  UVQUAN sfsvf  RCHRES 199 CVOL   py        40.00001157
  UVQUAN snwvf  RCHRES 199 CVOL   nw        40.00001157

***   sstg   - stampede lake stage,elevation
***   sifl   - all inflows above stampede, 0.000012 convert cubic ft to cfs 
***   siflv  - all inflows ab stampede, convert ft3 to ac-ft,by 2.2957E-5
***   sdmd   - stampede lake demand time series dsn 176,cfs
***   ssto   - stampede volume - convert ft3 to ac-ft by 2.2957E-5
***   sevp   - evap for stampede, 0.000012 convert cubic ft to cfs   
***   sstol  - stampede yesterdays storage, lagged one day in cfs
***   sstot  - stampede todays storage in cfs
***   sspvf  -  stampede sierra pac category volume in cfs
***   sfsvf  -  stampede pyramid category volume in cfs
***   snwvf  -  stampede nw category volume in cfs
 
*******************************************************************************
*** BOCA RESERVOIR VARIABLES
*******************************************************************************
*** use 759-61 master.uci
  UVNAME  BSPL    1 WORKSP759         1.0  
  UVNAME  BTOTV   1 WORKSP760         1.0  
  UVNAME  BDIFV   1 WORKSP761         1.0  
*** use 762-769 store.uci
  UVNAME  BCAP1   1 WORKSP762         1.0  
  UVNAME  BCAP2   1 WORKSP763         1.0 
  UVNAME  BNETRE  1 WORKSP764         1.0  
  UVNAME  BNCVCE  1 WORKSP765         1.0  
  UVNAME  BACVCE  1 WORKSP766         1.0  
  UVNAME  BNWVC   1 WORKSP767         1.0  
  UVNAME  BNWVCE  1 WORKSP768         1.0  
  UVNAME  BNWTRA  1 WORKSP769         1.0  
  UVNAME  BRLS    1 WORKSP770         1.0  
  UVNAME  BSPRA   1 WORKSP771         1.0  
  UVNAME  BFSRA   1 WORKSP772         1.0  
  UVNAME  BOFL    1 WORKSP773         1.0  
  UVNAME  BMFL    1 WORKSP774         1.0  
  UVNAME  BFFLAG  1 WORKSP775         1.0  
  UVNAME  BDRW    1 WORKSP776         1.0  
  UVNAME  BFLAG   1 WORKSP777         1.0  
*** use 777 store.uci
  UVNAME  BMAX    1 WORKSP778         1.0  
  UVNAME  BNET    1 WORKSP779         1.0  
  UVNAME  BNVOL   1 WORKSP780         1.0  
  UVNAME  BMIN    1 WORKSP781         1.0  

  UVNAME  BACRA   1 WORKSP782         1.0  
  UVNAME  BNCRA   1 WORKSP784         1.0  
  UVNAME  BPWRA   1 WORKSP785         1.0  
  UVNAME  BMAXQ   1 WORKSP786         1.0  
  UVNAME  BACRB   1 WORKSP787         1.0  
  UVNAME  BNCRB   1 WORKSP788         1.0  
  UVNAME  BSUMPW  1 WORKSP789         1.0  
  UVNAME  BNWRA   1 WORKSP790         1.0  
  UVNAME  BNWRB   1 WORKSP791         1.0  
  UVNAME  BRLSF   1 WORKSP792         1.0 
  UVNAME  BRLST   1 WORKSP793         1.0   
*** use 794-96 from merge.uci storage
  UVNAME  BNWRAA  1 WORKSP794         1.0  
  UVNAME  BDUMP   1 WORKSP795         1.0  
  UVNAME  BWCAP   1 WORKSP796         1.0  
  UVNAME  BACRAA  1 WORKSP797         1.0  
  UVNAME  BNCRAA  1 WORKSP798         1.0  
  UVNAME  BDMRAA  1 WORKSP799         1.0  
  UVNAME  BREL    1 WORKSP800         1.0  
  UVNAME  BFSRAA  1 WORKSP802         1.0  
  UVNAME  BAVLV   1 WORKSP803         1.0  
  UVNAME  BNWTF   1 WORKSP804         1.0  

***              bspl   - spill boca, cfs
***              btotv  - total volume with inflows added, ac-ft
***              bdifv  - difference in volume, ac-ft
***              bdifvf - difference in volume, cfs 
***              bcap1  - boca capacity adverse to canal, 25000 ac-ft
***              bcap2  - boca capacity non-adverse to canal, 15850 ac-ft
***              bnetre - boca excess net release after adjustment,cfs
***              bncvce - excess cum amount stored,not adverse-to-canal,
***                       in ac-ft
***              bacvce - excess cumulative amount stored,adverse-to-canal,ac-ft
***              bnwvc  - boca cumulative amount stored,pooled water,ac-ft
***              bnwvce - boca excess cum amount stored,pooled water,ac-ft
***              bnwtra - boca natural water, after releases, available for
***                       storage,cfs  
***              bnwtrv - boca natural water, after releases, available for
***                       storage, ac-ft
***              bnwtrf - boca natural water, after releases, available for
***                       storage, ft3  
***              brls   - counter to minimum boca releases,cfs
***              bspra  - release demand for sppc water,cfs
***              bfsra  - release demand for pyramid water,cfs
***              bofl   - total release demand for boca,cfs
***              bmfl   - minimum release demand for boca,cfs   
***              bfflag - boca flag if drawing from storage to meet 
***                       floriston rates 0-yes 1- no
***              bdrw   - counter for precautionary drawdown in oct1-nov1,cfs
***              bflag  - storage flag based on SOP's, no storage = 0,
***                       storage =1
***              bmax   - maximum storage to stay on spring rule curve,ac-ft
***              bnet   - boca daily inflow calculated from storage change,cfs
***              bnvol  - boca daily net storage available, in ac-ft
***              bmin   - boca minimum storage, in ac-ft
***              bacra  - boca adverse to canal release after adjustment, 
***                       in cfs
***              bncra  - boca nonadverse to canal release after adjustment, 
***                       in cfs
***              bpwra  - boca pooled water release after adjustment, in cfs 
***              bmaxq  - boca maximum release flow, in cfs
***              bacrb  - boca adverse to canal release before adjustment, 
***                       in cfs
***              bncrb  - boca nonadverse to canal release before adjustment, 
***                       in cfs 
***              bsumpw - boca scratch variable of sum of pooled water release,
***                       in cfs 
***              bnwra  - boca natural water release after adjustment,
***                       in cfs 
***              bnwrb  - boca natural water release before adjustment,
***                       in cfs 
***              brlsf  - boca releases from Flrstn Rates routine, in cfs
***              brlst  - boca running total of all releases, in cfs 
***              bnwraa - additional boca natural flow releases to meet SOP 
***                       demand not met by releases from other blocks, in cfs
***              bdump  - boca release from storage per storage priority, in cfs  
***              bwcap  - boca winter capacity to store, ac-ft
***              bacraa - additional boca adverse-to-canal releases to meet 
***                       SOP demand not met by releases from other blocks, 
***                       in cfs
***              bncraa - additional boca nonadverse-to-canal releases to meet 
***                       SOP demand not met by releases from other blocks, 
***                       in cfs
***              bdmraa - proposed additional releases determined by comparing 
***                       SOP and Floriston Rates demands
***              brel   - maximum of all types of releases for merge routine
***              bfsraa - additional boca fish  releases to meet SOP demand
***                       not met by releases from other blocks, in cfs
***              bavlv  - boca available storage, in ac-ft
***              bavlvf - boca available storage, converted to cfs
***              bnwtf  - boca total natural water avialable, in cfs
***         

  UVQUAN bspl   GLOBAL     WORKSP759
  UVQUAN btotv  GLOBAL     WORKSP760 
  UVQUAN bdifv  GLOBAL     WORKSP761 
  UVQUAN bdifvf GLOBAL     WORKSP761         0.50417 
  UVQUAN bcap1  GLOBAL     WORKSP762
  UVQUAN bcap2  GLOBAL     WORKSP763
  UVQUAN bnetre GLOBAL     WORKSP764
  UVQUAN bncvce GLOBAL     WORKSP765
  UVQUAN bacvce GLOBAL     WORKSP766
  UVQUAN bnwvc  GLOBAL     WORKSP767
  UVQUAN bnwvce GLOBAL     WORKSP768
  UVQUAN bnwtra GLOBAL     WORKSP769
*** 1.98348 converts cfs to ac-ft
  UVQUAN bnwtrv GLOBAL     WORKSP769         1.98348
*** 86400.  converts cfs to ft3  
  UVQUAN bnwtrf GLOBAL     WORKSP769         86400. 
  UVQUAN brls   GLOBAL     WORKSP770 
  UVQUAN bspra  GLOBAL     WORKSP771 
  UVQUAN bfsra  GLOBAL     WORKSP772 
  UVQUAN bofl   GLOBAL     WORKSP773
  UVQUAN bmfl   GLOBAL     WORKSP774
  UVQUAN bfflag GLOBAL     WORKSP775        2
  UVQUAN bdrw   GLOBAL     WORKSP776
  UVQUAN bflag  GLOBAL     WORKSP777        2
  UVQUAN bmax   GLOBAL     WORKSP778
  ***  use 0.50417 to convert ac-ft/day to cfs
  UVQUAN bmaxf  GLOBAL     WORKSP778         0.50417
  UVQUAN bnet   GLOBAL     WORKSP779
  UVQUAN bnvol  GLOBAL     WORKSP780
  UVQUAN bmin   GLOBAL     WORKSP781
  UVQUAN bacra  GLOBAL     WORKSP782                         
  UVQUAN bncra  GLOBAL     WORKSP784                         
  UVQUAN bpwra  GLOBAL     WORKSP785                   
  UVQUAN bmaxq  GLOBAL     WORKSP786                   
  UVQUAN bacrb  GLOBAL     WORKSP787                   
  UVQUAN bncrb  GLOBAL     WORKSP788                   
  UVQUAN bsumpw GLOBAL     WORKSP789                   
  UVQUAN bnwra  GLOBAL     WORKSP790                   
  UVQUAN bnwrb  GLOBAL     WORKSP791                   
  UVQUAN brlsf  GLOBAL     WORKSP792                   
  UVQUAN brlst  GLOBAL     WORKSP793                    
  UVQUAN bnwraa GLOBAL     WORKSP794                   
  UVQUAN bdump  GLOBAL     WORKSP795
  UVQUAN bwcap  GLOBAL     WORKSP796
  UVQUAN bacraa GLOBAL     WORKSP797 
  UVQUAN bncraa GLOBAL     WORKSP798
  UVQUAN bdmraa GLOBAL     WORKSP799
  UVQUAN brel   GLOBAL     WORKSP800
  UVQUAN bfsraa GLOBAL     WORKSP802
  UVQUAN bavlv  GLOBAL     WORKSP803
  UVQUAN bavlvf GLOBAL     WORKSP803         0.50417
  UVQUAN bnwtf  GLOBAL     WORKSP804

  UVQUAN bstg   RCHRES 209 STAGE                          
  UVQUAN bifl   RCHRES 209 IVOL              0.00001157
  UVQUAN biflv  RCHRES 209 IVOL               2.2957E-5         
  UVQUAN blfl   COPY     1 MEAN   13   
  UVQUAN blflv  COPY     1 MEAN   13         1.98348 
  UVQUAN bdmd   COPY     1 MEAN   12  
  UVQUAN bsto   RCHRES 209 VOL              4 2.2957E-5
  UVQUAN bevp   RCHRES 209 VOLEV             0.00001157
  UVQUAN bstol  RCHRES 209 VOL              40.00001157 DY  1               
  UVQUAN bstot  RCHRES 209 VOL              40.00001157
  UVQUAN bspvf  RCHRES 209 CVOL   sp        40.00001157
  UVQUAN bfsvf  RCHRES 209 CVOL   py        40.00001157
  UVQUAN bacv   RCHRES 209 CVOL   ac        4 2.2957E-5
  UVQUAN bacvf  RCHRES 209 CVOL   ac        40.00001157
  UVQUAN bncv   RCHRES 209 CVOL   nc        4 2.2957E-5
  UVQUAN bncvf  RCHRES 209 CVOL   nc        40.00001157
  UVQUAN bnwv   RCHRES 209 CVOL   nw        4 2.2957E-5
  UVQUAN bnwvf  RCHRES 209 CVOL   nw        40.00001157

***   bstg   -  boca lake stage,elevation
***   bifl   -  boca inflows , 0.000012 convert cubic ft to cfs 
***   biflv  -  all inflows ab boca, convert ft3 to ac-ft,by 2.2957E-5
***   blfl   -  boca trib inflows,in cfs,from rods syn data, dsn 181*13/16
***   blflv  -  boca trib inflows , 1.98348 convert cfs to ac-ft
***   bdmd   -  boca lake demand time series dsn 191,cfs
***   bsto   -  boca volume  convert ft3 to ac-ft by   2.2957E-5
***   bevp   -  evap for the boca, 0.000012 convert cubic ft to cfs   
***   bstol  -  boca yesterdays storage, lagged one day in cfs
***   bstot  -  boca todays storage in cfs, could lag this using VOL(today) 
***             and VOLS(yesterday)
***   bspvf  -  boca sierra pac category volume in cfs
***   bfsvf  -  boca pyramid category volume in cfs
***   bacvf  -  boca adverse to canal volume converted to flow, in cfs
***   bacv   -  boca adverse to canal volume, in ac-ft
***   bncvf  -  boca nonadverse to canal volume converted to flow, in cfs
***   bncv   -  boca nonadverse to canal volume, in ac-ft
***   bnwv   -  boca natural water volume, in ac-ft
***   bnwvf  -  boca natural water volume converted to flow, in cfs
 
****************************************************************************
*** TRUCKEE RIVER VARIABLES
****************************************************************************
  UVNAME  TMFL    1 WORKSP890         1.0     

***  variables   tmfl   - truckee river min flow requirement 50 or 70 cfs

  UVQUAN tmfl   GLOBAL     WORKSP890
 
****************************************************************************
*** TRUCKEE RIVER AT FARAD VARIABLES
****************************************************************************

  UVNAME  FADJ    1 WORKSP850         1.0  
  UVNAME  FNEED   1 WORKSP852         1.0 
  UVNAME  FLRATE  1 WORKSP853         1.0 
  UVNAME  SIDH2O  1 WORKSP854         1.0 
  UVNAME  FEXCES  1 WORKSP855         1.0 
  UVNAME  FTOL    1 WORKSP856         1.0 

  UVNAME  FNWFSV  1 WORKSP891         1.0
  UVNAME  FNWFWM  1 WORKSP892         1.0
  UVNAME  FNWFSC  1 WORKSP893         1.0
*** use 894-899 store.uci
  UVNAME  FLFLAG  1 WORKSP894         1.0
  UVNAME  RTFLAG  1 WORKSP895         1.0
  UVNAME  CACF    1 WORKSP896         1.0
  UVNAME  CNCF    1 WORKSP897         1.0
***   cexces = fq - flrate
  UVNAME  CEXCES  1 WORKSP898         1.0

***              fadj   - diff in floriston rates and farad flow,cfs 
***              fneed  - amount needed to meet floriston rates, in cfs
***              flrate - floriston rates as specified in TRA,cfs
***              sidh2o - side water as calculated by FWM method,cfs
***              fexces - farad excess flow, in cfs
***              ftol   - floriston tolerance for reservoir adjustments, cfs
***              fnwfsv - natural flow at farad, calculated, 3 day average
***                       by sierra valley decree method,cfs
***              fnwfwm - natural flow at farad, calculated, FWM method,cfs
***              fnwfsc - natural flow at farad, calculated, SCS method,cfs
***              flflag - flag if meeting florsiton rates 0-no, 1-yes
***              rtflag - flag for right to store in reservoir,0-no, 1-yes
***              cacf   - Truckee Canal adverse to canal flows, cfs
***              cncf   - Truckee Canal not adverse to canal flows, cfs
***              cexces - Truckee Canal excess flow above Orr Ditch rights,cfs
 
  UVQUAN fadj   GLOBAL     WORKSP850                          DY  3 AVER ***
  UVQUAN fadj   GLOBAL     WORKSP850  
  UVQUAN fneed  GLOBAL     WORKSP852  
  UVQUAN flrate GLOBAL     WORKSP853  
  UVQUAN sidh2o GLOBAL     WORKSP854  
  UVQUAN fexces GLOBAL     WORKSP855  
  UVQUAN ftol   GLOBAL     WORKSP856  

  UVQUAN fnwfsv GLOBAL     WORKSP891                          DY  3 AVER   
  UVQUAN fnwfwm GLOBAL     WORKSP892                       
  UVQUAN fnwfsc GLOBAL     WORKSP893                       
  UVQUAN flflag GLOBAL     WORKSP894        2
  UVQUAN rtflag GLOBAL     WORKSP895        2
  UVQUAN cacf   GLOBAL     WORKSP896       
  UVQUAN cncf   GLOBAL     WORKSP897       
  UVQUAN cexces GLOBAL     WORKSP898       

*** fq    - modeled flow at farad, cfs
*** ffor  - SCS truckee r at farad forecast, 1000 ac-ft, converted to ac-ft
*** cdvr  - obeserved flows at USGS Truckee Canal at Wadsworth gage,cfs

  UVQUAN fq     RCHRES 240 RO                            
  UVQUAN ffor   COPY     2 MEAN    3         1000.                 
  UVQUAN cdvr   COPY     2 MEAN   10
   
*******************************************************************************
*** MISCELLANEOUS HSPF VARIABLES
*******************************************************************************
  UVNAME  SUMRSF  1 WORKSP900         1.0  
  UVNAME  CHANGE  1 WORKSP901         1.0  
  UVNAME  AVLSTF  1 WORKSP902         1.0  
  UVNAME  AVLQ    1 WORKSP903         1.0  

***              sumrsf - sum of reservoir releases, in cfs
***              change - release adjustments, in cfs
***              avlstf - available storage as flow, in cfs     
***              avlq   - available flow below maxq, in cfs

  UVQUAN sumrsf GLOBAL     WORKSP900  
  UVQUAN change GLOBAL     WORKSP901  
  UVQUAN avlstf GLOBAL     WORKSP902  
  UVQUAN avlq   GLOBAL     WORKSP903  

*** Action Lines  **********************************************************
***                                        addr or              uvq or
***                                       <------>              <---->
*** opt fop lop     year mo dy hr mn d t   vnam  s1 s2 s3 ac quantity  tc  ts rp
  <****><-><-->     <--> <> <> <> <><><>  <----><-><-><-><-><--------> <> <-><->
***=========================================================================
***     1. Determine input variables, such as time-dependent targets
***        (eg. Floriston Rates)
***=========================================================================
***---------------------------------------------------------------------------
*** set up logic for numeric date
***---------------------------------------------------------------------------
  GENER   1                               MO_DA            =   day
  GENER   1                               MO_DA           *=  0.01
  GENER   1                               MO_DA           +=  month

***---------------------------------------------------------------------------
*** set up logic for julian day calculation, 
***---------------------------------------------------------------------------
      *** Account for month
  IF (month = 1) THEN
    GENER   1                               JUL_DA           =    0
  ELSE IF (month = 2) THEN
    GENER   1                               JUL_DA           =    31
  ELSE IF (month = 3) THEN
    GENER   1                               JUL_DA           =    59
  ELSE IF (month = 4) THEN
    GENER   1                               JUL_DA           =    90
  ELSE IF (month = 5) THEN
    GENER   1                               JUL_DA           =    120
  ELSE IF (month = 6) THEN
    GENER   1                               JUL_DA           =    151
  ELSE IF (month = 7) THEN
    GENER   1                               JUL_DA           =    181
  ELSE IF (month = 8) THEN
    GENER   1                               JUL_DA           =    212
  ELSE IF (month = 9) THEN
    GENER   1                               JUL_DA           =    243
  ELSE IF (month = 10) THEN
    GENER   1                               JUL_DA           =    273
  ELSE IF (month = 11) THEN
    GENER   1                               JUL_DA           =    304
  ELSE IF (month = 12) THEN
    GENER   1                               JUL_DA           =    334
  END IF

     *** Account for day of month
  GENER   1                               JUL_DA           =    jul_da
  GENER   1                               JUL_DA          +=    day

     *** Account for leap & non-leap years
  GENER   1                               ITEMP            =    year 
  GENER   1                               ITEMP          MOD    4 

  IF (itemp < 0.1) THEN 
    *** Leap year
    GENER   1                               JMAY15           =    136
    GENER   1                               JMAY20           =    141 
    GENER   1                               JJUN1            =    153
    GENER   1                               JJUN8            =    160
    GENER   1                               JJUN15           =    167
    GENER   1                               JJUN23           =    175
    GENER   1                               JJUL5            =    187
    GENER   1                               JJUL15           =    197
    GENER   1                               JNOV1            =    306
    GENER   1                               JNOV16           =    321
    IF (month >= 3) THEN 
      GENER   1                               JUL_DA           =    jul_da 
      GENER   1                               JUL_DA          +=    1 
    END IF
  ELSE 
    *** Non-leap year
    GENER   1                               JMAY15           =    135 
    GENER   1                               JMAY20           =    140
    GENER   1                               JJUN1            =    152
    GENER   1                               JJUN8            =    159
    GENER   1                               JJUN15           =    166
    GENER   1                               JJUN23           =    174
    GENER   1                               JJUL5            =    186 
    GENER   1                               JJUL15           =    196 
    GENER   1                               JNOV1            =    305
    GENER   1                               JNOV16           =    320
  END IF 

***---------------------------------------------------------------------------
*** Assign initial reservoir releases from yesterday's releases
***---------------------------------------------------------------------------
  GENER   1                               TPWRB            =  tpwra  
  GENER   1                               PTXRB            =  ptxra 
  GENER   1                               BACRB            =  bacra 
  GENER   1                               BNCRB            =  bncra 
  GENER   1                               PUWRB            =  puwra 
   *** PUWRA reset to 0.0---not updated in uci yet SNB 11/21/95
  GENER   1                               PUWRA            =  0.0

  GENER   1                               PNWRB            =  0.0
  GENER   1                               BNWRB            =  0.0

  GENER   1                               PNWRB            =  pnwra *** GWH9/19/95
  GENER   1                               BNWRB            =  bnwra *** GWH9/19/95


***---------------------------------------------------------------------------
*** SPECIFY WET OR DRY YEAR
***---------------------------------------------------------------------------
*** based on SCS forecasts of flows at Truckee River at Farad, the long term 
*** mean flow is 261,000 ac-ft. Assume that if the April forecast is greater
*** than 261,000 call it a wet year. If the april forecast is less than 261,000
*** then call it a dry year.
***
*** forecasts are only avialable from jan to may, set wdflag during that time 
***
*** for now, to simplify the flood control diagram, use a flag, wdflag, to
*** specify a wet year or dry year when filling the prosser, stampede, and 
*** boca reservoirs in April to July

  IF (mo_da >= 1.01) AND (mo_da <= 6.01) THEN
    IF (ffor > 261000) THEN 
      *** set wdflag = 1 for wet year
      GENER   1                            2  WDFLAG           =       1 
    ELSE IF (ffor <= 261000) THEN 
      *** set wdflag = 0 for dry year, 
      GENER   1                            2  WDFLAG           =       0 
    END IF  
  END IF

***---------------------------------------------------------------------------
*** SPECIFY WET OR DRY OR AVERAGE YEAR
***---------------------------------------------------------------------------
*** based on SCS forecasts of flows at Truckee River at Farad, the long term 
*** mean flow is 261,000 ac-ft. Assume that if the forecast is greater
*** than 288,000 call it a wet year. If the april forecast is less than 166,000
*** then call it a dry year. In between 166,000 and 288,000 ac-ft an average
*** year if less than 120,000 then call it a drought, to be used for donner
*** early fill forecasts are only available from jan to may

  IF (mo_da >= 1.01) AND (mo_da <= 5.31) THEN
    IF (ffor < 120000) THEN 
      *** set frflag = 0 for drought year
      GENER   1                            2  FRFLAG           =       0 
    ELSE IF (ffor < 166000) THEN 
      *** set frflag = 1 for dry year
      GENER   1                            2  FRFLAG           =       1 
    ELSE IF (ffor < 288000) THEN 
      *** set frflag = 2 for average year, 
      GENER   1                            2  FRFLAG           =       2
    ELSE 
      *** (ffor > 288000) 
      *** set frflag = 3 for wet year, 
      GENER   1                            2  FRFLAG           =       3 
    END IF  
  END IF   

*****************************************************************************
*** SET TAHOE TIME DEPENDENT TARGETS
*****************************************************************************
***---------------------------------------------------------------------------
***SET TAHOE PROPOSED MINIMUM RELEASES
***---------------------------------------------------------------------------
*** from tahoe prosser exchange 
*** Required instream flow demand of 70.0 cfs beginning on 8/1 begin model run
  GENER   1         1989  8  1  0  0      TMFL             =      70.0 
*** Required instream flow demand of 50.0 cfs beginning on 10/1 winter
  GENER   1         1989 10  1  0  0      TMFL             =      50.0 YR   1 10
*** Required instream flow demand of 70.0 cfs beginning on 4/1 summer
  GENER   1         1990  4  1  0  0      TMFL             =      70.0 YR   1 10

***---------------------------------------------------------------------------
***ASSIGN MAXIMUM FLOW THROUGH LAKE TAHOE OUTLET
***---------------------------------------------------------------------------

***                                        addr or              uvq or
***                                       <------>              <---->
*** opt fop lop     year mo dy hr mn d t   vnam  s1 s2 s3 ac quantity  tc  ts rp
  <****><-><-->     <--> <> <> <> <><><>  <----><-><-><-><-><--------> <> <-><->
*** regression equations to determine tmaxq
  IF (tstg <= 6223.0) THEN
    GENER   1                               TMAXQ            =       0.0
  ELSE IF [(tstg > 6223.0) AND (tstg <= 6223.3)] THEN
    GENER   1                               TMAXQ            =    56.667  
    GENER   1                               TMAXQ           *=      tstg
    GENER   1                               TMAXQ           -= 352636.67 
  ELSE IF [(tstg > 6223.3) AND (tstg <= 6225.0)] THEN
    GENER   1                               TMAXQ            =   255.262  
    GENER   1                               TMAXQ           *=      tstg
    GENER   1                               TMAXQ           -= 1588545.4 
  ELSE IF [(tstg > 6225.0) AND (tstg <= 6226.0)] THEN
    GENER   1                               TMAXQ            =   525.000  
    GENER   1                               TMAXQ           *=      tstg
    GENER   1                               TMAXQ           -= 3267675.0 
  ELSE IF (tstg > 6226.0) THEN
    GENER   1                               TMAXQ            =   730.140  
    GENER   1                               TMAXQ           *=      tstg
    GENER   1                               TMAXQ           -= 4544874.3 
  END IF


***---------------------------------------------------------------------------
***CALCULATE LAKE TAHOE DAILY NET INFLOWS FROM STORAGE CHANGE
***---------------------------------------------------------------------------
*** calculate change in storage, all units in cfs 
  GENER   1                               TNET             =    tstot 
  GENER   1                               TNET            -=    tstol 
*** add yesterdays releases from lake tahoe
  GENER   1                               TNET            +=    trlst


***---------------------------------------------------------------------------
***CALCULATE LAKE TAHOE DAILY STORAGE AVAILABLE ABOVE RIM
***---------------------------------------------------------------------------
*** calculate daily net storage available, all units in ac-ft
  GENER   1                               TVOL             =    tsto   
*** volume at elevation 6223.0 (rim) = 482720  ac-ft
  GENER   1                               TVOL            -=    482720. 
*** make sure volume is not negative
  GENER   1                               TVOL           MAX    0.0     

***---------------------------------------------------------------------------
***CALCULATE LAKE TAHOE DAILY NET STORAGE AVAILABLE ABOVE RIM
***---------------------------------------------------------------------------
*** calculate daily net storage available, all units in ac-ft
  GENER   1                               TNVOL            =    tsto    ***
*** volume at elevation 6223.0 (rim) = 482720  ac-ft
  GENER   1                               TNVOL           -=    482720. ***
*** add todays inflows to lake tahoe
  GENER   1                               TNVOL           +=    tiflv  ***
*** make sure volume is not negative
  GENER   1                               TNVOL          MAX    0.0     ***


*******************************************************************************
*** SET DONNER TIME DEPENDENT TARGETS
*******************************************************************************
***---------------------------------------------------------------------------
***ASSIGN MAXIMUM FLOW THROUGH DONNER LAKE OUTLET
***---------------------------------------------------------------------------
***regression equation to determine dmaxq
  IF (dstg <= 5926.9) THEN
    GENER   1                               DMAXQ            =   0.0
  ELSE IF [(dstg > 5926.9) AND (dstg <= 5927.23)] THEN
    GENER   1                               DMAXQ            =      dstg
    GENER   1                               DMAXQ           -=  5920.
    GENER   1                               DMAXQ           *=   5.7576
    GENER   1                               DMAXQ           -= 39.7273 
    GENER   1                               DMAXQ          MAX 0.0
  ELSE IF [(dstg > 5927.23) AND (dstg <= 5927.6)] THEN
    GENER   1                               DMAXQ            =      dstg
    GENER   1                               DMAXQ           -=  5920.
    GENER   1                               DMAXQ           *=   6.5253
    GENER   1                               DMAXQ           -= 45.4382 
  ELSE IF [(dstg > 5927.6) AND (dstg <= 5928.03)] THEN
    GENER   1                               DMAXQ            =      dstg
    GENER   1                               DMAXQ           -=  5920.
    GENER   1                               DMAXQ           *=   43.2119
    GENER   1                               DMAXQ           -= 327.7962
  ELSE IF [(dstg > 5928.03) AND (dstg <= 5928.44)] THEN
    GENER   1                               DMAXQ            =   69.935
    GENER   1                               DMAXQ           *=      dstg
    GENER   1                               DMAXQ           -= 414562.74 
  ELSE IF (dstg > 5928.44) THEN
    GENER   1                               DMAXQ            =   80.757   
    GENER   1                               DMAXQ           *=      dstg
    GENER   1                               DMAXQ           -= 478737.12 
  END IF

***---------------------------------------------------------------------------
***SET DONNER PROPOSED MINIMUM RELEASES
***---------------------------------------------------------------------------
*** set min flows of 3 cfs based on TROA notes      
  GENER   1         1989  8  1  0  0      DMFL             =       3.0   

***---------------------------------------------------------------------------
***CALCULATE DONNER LAKE DAILY NET INFLOWS FROM STORAGE CHANGE
***---------------------------------------------------------------------------
*** calculate change in storage, all units in cfs 
  GENER   1                               DNET             =    dstoft
  GENER   1                               DNET            -=    dstofl
*** add yesterdays releases from donner lake
  GENER   1                               DNET            +=    drlst

***---------------------------------------------------------------------------
***SET DONNER MAXIMUM ANNUAL STORAGE COUNTER 
***---------------------------------------------------------------------------
***  maximum of 9,500 ac-ft to be stored in donner lake on annual basis
***  reset the annual donner storage  = 0 on October 1 
  GENER   1  ***    1989 10 01  0  0      DPSVC            =       0.0 YR   1 20
 
***---------------------------------------------------------------------------
***SET DONNER MAXIMUM ANNUAL STORAGE
***---------------------------------------------------------------------------
***  maximum of 9,500 ac-ft to be stored in donner lake on annual basis
  GENER   1         1989  8  1  0  0      DCAP             =     9500.

***---------------------------------------------------------------------------
***SET DONNER MAXIMUM WINTER STORAGE
***---------------------------------------------------------------------------
***  maximum of 2275 ac-ft (5926.9 ft) to be stored in donner lake on winter
***  basis
***  NOTE : in practice, elevation is held at about 5927.5 (2800 ac-ft)
  GENER   1         1989  8  1  0  0      DWCAP            =     2800. YR   1 20

***---------------------------------------------------------------------------
***SET DONNER MINIMUM ANNUAL STORAGE COUNTER 
***-------------------------------------------------------------------------- 
  IF (mo_da >= 7.01) AND (mo_da < 4.16) AND (dsto < dmin) THEN  ***
    GENER   1                               DMIN             =   dsto ***
  END IF ***
 

*******************************************************************************
*** SET MARTIS CREEK RESERVOIR TIME DEPENDENT TARGETS
*******************************************************************************
***---------------------------------------------------------------------------
***SET MARTIS PROPOSED MINIMUM RELEASES
***---------------------------------------------------------------------------
*** there are no minimum releases at Martis Creek Reservoir, as it is used for 
*** flood control only

***---------------------------------------------------------------------------
***ASSIGN MAXIMUM FLOW THROUGH MARTIS RESERVOIR OUTLET
***---------------------------------------------------------------------------
***regression equations to determine mmaxq
  IF (mstg <= 5780.0) THEN
    GENER   1                               MMAXQ            =       0.0
  ELSE IF [(mstg > 5780.0) AND (mstg <= 5781.0)] THEN
    GENER   1                               MMAXQ            =     10.0   
    GENER   1                               MMAXQ           *=      mstg
    GENER   1                               MMAXQ           -=    57800.    
  ELSE IF [(mstg > 5781.0) AND (mstg <= 5783.0)] THEN
    GENER   1                               MMAXQ            =     120.0  
    GENER   1                               MMAXQ           *=      mstg
    GENER   1                               MMAXQ           -= 693710.0  
  ELSE IF [(mstg > 5783.0) AND (mstg <= 5784.0)] THEN
    GENER   1                               MMAXQ            =   235.000  
    GENER   1                               MMAXQ           *=      mstg
    GENER   1                               MMAXQ           -= 1358755.0 
  ELSE IF [(mstg > 5784.0) AND (mstg <= 5790.0)] THEN
    GENER   1                               MMAXQ            =   6.667    
    GENER   1                               MMAXQ           *=      mstg
    GENER   1                               MMAXQ           -= 38075.    
  ELSE IF [(mstg > 5790.0) AND (mstg <= 5810.0)] THEN
    GENER   1                               MMAXQ            =      5.50  
    GENER   1                               MMAXQ           *=      mstg
    GENER   1                               MMAXQ           -= 31320.  
  ELSE IF [(mstg > 5810.0) AND (mstg <= 5820.0)] THEN
    GENER   1                               MMAXQ            =      4.50   
    GENER   1                               MMAXQ           *=      mstg
    GENER   1                               MMAXQ           -=  25510.  
  ELSE IF [(mstg > 5820.0) AND (mstg <= 5838.0)] THEN
    GENER   1                               MMAXQ            =      4.44  
    GENER   1                               MMAXQ           *=      mstg
    GENER   1                               MMAXQ           -=   25186.0    
  ELSE IF (mstg > 5838.0) THEN
    GENER   1                               MMAXQ            =      760.  
  END IF

***---------------------------------------------------------------------------
***CALCULATE MARTIS RESERVOIR DAILY NET INFLOWS FROM STORAGE CHANGE
***---------------------------------------------------------------------------
*** calculate change in storage, all units in cfs 
  GENER   1                               MNET             =    msto  
  GENER   1                               MNET            -=    mstol 
*** add  yesterdays releases from martis reservoir
  GENER   1                               MNET            +=    mrls

*******************************************************************************
*** SET PROSSER RESERVOIR TIME DEPENDENT TARGETS
*******************************************************************************
***---------------------------------------------------------------------------
***SET PROSSER PROPOSED MINIMUM RELEASES
***---------------------------------------------------------------------------
***  set minimum prosser releases = 5 cfs fish release,(SOP )
  GENER   1         1989  8  1  0  0      PMFL             =      5.0 

***
***---------------------------------------------------------------------------
***ASSIGN MAXIMUM FLOW THROUGH PROSSER CREEK RESERVOIR OUTLET
***---------------------------------------------------------------------------
  GENER   1                               PMAXQ ***        =    4600  
***                                        addr or              uvq or
***                                       <------>              <---->
*** opt fop lop     year mo dy hr mn d t   vnam  s1 s2 s3 ac quantity  tc  ts rp
  <****><-><-->     <--> <> <> <> <><><>  <----><-><-><-><-><--------> <> <-><->
***regression equations to determine pmaxq
  IF (pstg <= 5630.0) THEN
    GENER   1                               PMAXQ            =       0.0
  ELSE IF [(pstg > 5630.0) AND (pstg <= 5640.0)] THEN
    GENER   1                               PMAXQ            =      10.0  
    GENER   1                               PMAXQ           *=      pstg
    GENER   1                               PMAXQ           -=   56300.0   
  ELSE IF [(pstg > 5640.0) AND (pstg <= 5650.0)] THEN
    GENER   1                               PMAXQ            =      65.0     
    GENER   1                               PMAXQ           *=      pstg
    GENER   1                               PMAXQ           -=  366500.0  
  ELSE IF [(pstg > 5650.0) AND (pstg <= 5670.0)] THEN
    GENER   1                               PMAXQ            =    17.823  
    GENER   1                               PMAXQ           *=      pstg
    GENER   1                               PMAXQ           -=  99934.26
  ELSE IF [(pstg > 5670.0) AND (pstg <= 5745.0)] THEN
    GENER   1                               PMAXQ            =    10.274  
    GENER   1                               PMAXQ           *=      pstg
    GENER   1                               PMAXQ           -=  57109.92
  ELSE IF (pstg > 5745.0) THEN
    GENER   1                               PMAXQ            =    1880.0   
  END IF

***---------------------------------------------------------------------------
***SET PROSSER MAXIMUM ANNUAL STORAGE COUNTER 
***---------------------------------------------------------------------------
*** NOTE: set = 0 on october 1
  GENER   1   ***   1989 10 01  0  0      PUWVC            =       0.0 YR   1 20

***---------------------------------------------------------------------------
***SET PROSSER MAXIMUM ANNUAL STORAGE
***---------------------------------------------------------------------------
***  maximum of 30,000 ac-ft to be stored in prosser lake on annual basis
  GENER   1         1989  8  1  0  0      PCAP             =    30000. 

***---------------------------------------------------------------------------
***SET PROSSER MAXIMUM WINTER STORAGE
***---------------------------------------------------------------------------
***  maximum of 9850 ac-ft (5703.7ft) to be stored in prosser lake on winter
***  basis
  GENER   1         1989  8  1  0  0      PWCAP            =     9850.

***---------------------------------------------------------------------------
***SET PROSSER FLORISTON RATES FLAG
***---------------------------------------------------------------------------
***  prosser flag if drawing from storage to meet floriston rates 0-yes 1-no
*** set for initial conditions
  GENER   1         1989  8  1  0  0   2  PFFLAG ***       =       0  
*** set for additional years of model run
  GENER   1         1990  4 10  0  0   2  PFFLAG    ***    =       1   YR   1 20

***---------------------------------------------------------------------------
***CALCULATE PROSSER RESERVOIR DAILY NET INFLOWS FROM STORAGE CHANGE
***---------------------------------------------------------------------------
*** calculate change in storage, all units in cfs 
  GENER   1                               PNET             =    pstot 
  GENER   1                               PNET            -=    pstol 
*** add  yesterdays releases from prosser reservoir
  GENER   1                               PNET            +=    prlst

***---------------------------------------------------------------------------
***CALCULATE PROSSER RESERVOIR DAILY NET STORAGE AVAILABLE ABOVE RIM
***---------------------------------------------------------------------------
*** calculate daily net storage available, all units in ac-ft
  GENER   1                               PNVOL            =    psto   ***
*** volume at elevation 5660.6 (rim) =  1201 ac-ft
  GENER   1                               PNVOL           -=    1201.  ***
*** add todays inflows to prosser reservoir
  GENER   1                               PNVOL           +=    piflv  ***
*** make sure volume is not negative
  GENER   1                               PNVOL          MAX    0.0     ***

***--------------------------------------------------------------------------
*** total storage, ptotv = storage plus inflow to prosser (ac-ft) = psto + piflv
***--------------------------------------------------------------------------
  GENER   1                               PTOTV            =   psto
  GENER   1                               PTOTV           +=  piflv 

***--------------------------------------------------------------------------
***Assign initial values to Prosser volume threshold above rim 
*** (dead storage = 1201.0 acre-ft)
***-------------------------------------------------------------------------
***
  GENER   1                               PVOL             =    psto    
  GENER   1                               PVOL            -=     1201.0

***--------------------------------------------------------------------------
***Assign initial values to Prosser recreation volume threshold above
*** rim (dead storage = 1201.0 acre-ft)
***-------------------------------------------------------------------------
***
  GENER   1         1989  8  1  0  0      PRECV            =    19000.0
  GENER   1         1989  8  1  0  0      PRECV           -=     1201.0

***--------------------------------------------------------------------------
***Calculate Prosser category volumes above rim (dead storage = 1201.0).
***  Assumes exchange water is on top of uncommitted water.
***-------------------------------------------------------------------------
  *** Add 2 categories together puws + ptxs = puwvt
  GENER   1                               PUWVT            =    puws
  GENER   1                               PUWVT           +=    ptxs

  IF (puws > 1201.) THEN
    *** dead storage is all puws water 
    GENER   1                               PUWV             =   puws
    GENER   1                               PUWV            -=   1201.
    GENER   1                               PNWV             =   pnws
    GENER   1                               PTXV             =   ptxs
  ELSE IF (puwvt >1201.) THEN
    *** dead storage is uw + some exchange
    GENER   1                               PUWV             =   0.0 
    GENER   1                               PNWV             =   pnws
    GENER   1                               PTXV             =   puwvt
    GENER   1                               PTXV            -=   1201.
  ELSE IF (psto > 1201.) THEN
    *** dead storage is uw + tx + some natural water 
    GENER   1                               PUWV             =   0.0 
    GENER   1                               PTXV             =   0.0 
    GENER   1                               PNWV             =  psto
    GENER   1                               PNWV            -=  1201. 
  ELSE
    *** all water in dead storage
    GENER   1                               PUWV             =   0.0 
    GENER   1                               PNWV             =   0.0 
    GENER   1                               PTXV             =   0.0 
  END IF

***---------------------------------------------------------------------------
***CALCULATE PROSSER RESERVOIR DAILY NET NATURAL AVAILABLE 
***---------------------------------------------------------------------------
*** calculate daily natural flow available, all units in cfs
  GENER   1                               PNWTF            =    pnwvf
*** add todays inflows to prosser reservoir flowing in as nw water
  GENER   1                               PNWTF           +=    pifl


*******************************************************************************
*** INDEPENDENCE TIME DEPENDENT TARGETS
*******************************************************************************
***---------------------------------------------------------------------------
***ASSIGN MAXIMUM FLOW THROUGH INDEPENDENCE LAKE OUTLET
***---------------------------------------------------------------------------
***regression equations to determine imaxq
  IF (istg <= 6921.0) THEN  
    GENER   1                               IMAXQ            =       0.0 
  ELSE IF [(istg > 6921.0) AND (istg <= 6925.0)] THEN 
    GENER   1                               IMAXQ            =   47.250    
    GENER   1                               IMAXQ           *=      istg 
    GENER   1                               IMAXQ           -=  327017.25   
  ELSE IF [(istg > 6925.0) AND (istg <= 6929.0)] THEN 
    GENER   1                               IMAXQ            =   27.750
    GENER   1                               IMAXQ           *=      istg  
    GENER   1                               IMAXQ           -=  191979.75
  ELSE IF [(istg > 6929.0) AND (istg <= 6933.0)] THEN  
    GENER   1                               IMAXQ            =   23.750    
    GENER   1                               IMAXQ           *=      istg  
    GENER   1                               IMAXQ           -=  164263.75
  ELSE IF [(istg > 6933.0) AND (istg <= 6937.0)] THEN  
    GENER   1                               IMAXQ            =   15.250    
    GENER   1                               IMAXQ           *=      istg
    GENER   1                               IMAXQ           -=  105333.75
  ELSE IF [(istg > 6937.0)] THEN  
    GENER   1                               IMAXQ            =   12.233    
    GENER   1                               IMAXQ           *=      istg 
    GENER   1                               IMAXQ           -=   84403.83
  END IF  
 
***---------------------------------------------------------------------------
***SET INDEPENDENCE PROPOSED MINIMUM RELEASES
***---------------------------------------------------------------------------
*** set min flow 2 cfs based on sec 525 -ltmfland game code, 1939 agreement
  GENER   1         1989  8  1  0  0      IMFL             =       2.0 

***---------------------------------------------------------------------------
***SET INDEPENDENCE MAXIMUM ANNUAL STORAGE COUNTER 
***---------------------------------------------------------------------------
*** from 1966 certificate of approval, from Dec 1 to July 1 maximum of 
***   17,500 ac-ft to be stored in independence lake on annual basis
***  reset the annual independence storage  = 0 on July 1
  GENER   1 ***     1990  7  1  0  0      ISPVC            =       0.0 YR   1 20

***---------------------------------------------------------------------------
***SET FIRST RIGHT INDEPE MAXIMUM ANNUAL STORAGE
***---------------------------------------------------------------------------
***  maximum of 3,000 ac-ft to be stored in indep lake on annual basis
  GENER   1         1989  8  1  0  0      ICAP1            =     3000. 

***---------------------------------------------------------------------------
***SET SECOND RIGHT INDEPE MAXIMUM ANNUAL STORAGE
***---------------------------------------------------------------------------
***  maximum of 17500 ac-ft to be stored in indep lake on annual basis
  GENER   1         1989  8  1  0  0      ICAP2            =   17500.  

***---------------------------------------------------------------------------
***SET INDEPENDENCE MAXIMUM WINTER STORAGE
***---------------------------------------------------------------------------
***  maximum of 15215 ac-ft (6946.0 ft) to be stored in indep lake on winter
***  basis
  GENER   1         1989  8  1  0  0      IWCAP            =    15215. YR   1 20

***---------------------------------------------------------------------------
***CALCULATE INDEPENDENCE DAILY NET INFLOWS FROM STORAGE CHANGE
***---------------------------------------------------------------------------
***  change in storage, all units in cfs 
  GENER   1                               INET             =   istot  
  GENER   1                               INET            -=   istol  
*** add  yesterdays releases from indepenedence lake
  GENER   1                               INET            +=   irlst

******************************************************************************
*** SET SIERRA VALLEY TIME DEPENDENT TARGETS
******************************************************************************
***---------------------------------------------------------------------------
***SET SIERRA VALLEY PROPOSED MINIMUM RELEASES
***---------------------------------------------------------------------------
*** from sierra valley decree
*** Specify fish flow dates, fish varies on  3/15, 6/15 and 10/1
*** dates need to be within time span of model run
***                                        addr or              uvq or
***                                       <------>              <---->
*** opt fop lop     year mo dy hr mn d t   vnam  s1 s2 s3 ac quantity  tc  ts rp
  <****><-><-->     <--> <> <> <> <><><>  <----><-><-><-><-><--------> <> <-><->
*** set to run model
  GENER   1         1989  8  1  0  0      LTMFL            =       3.0
  GENER   1         1989 10  1  0  0      LTMFL            =       0.0 YR   1 20
  GENER   1         1990 03 15  0  0      LTMFL            =       5.0 YR   1 20
  GENER   1         1990 06 16  0  0      LTMFL            =       3.0 YR   1 20

***---------------------------------------------------------------------------
***SET SIERRA VALLEY MAXIMUM ANNUAL DIVERSION COUNTER 
***---------------------------------------------------------------------------
***  reset the annual sierra valley diversion = 0 at Oct 1
  GENER   1         1989 10  1  0  0      SVCUMV           =       0.0 YR   1 20

********************************************************************************
*** SET STAMPEDE TIME DEPENDENT TARGETS
********************************************************************************
***---------------------------------------------------------------------------
***SET STAMPEDE PROPOSED MINIMUM RELEASES
***---------------------------------------------------------------------------
*** set min flows of 30 cfs based on state of Calif permit 22011 (1969)
  GENER   1         1989  8  1  0  0      SMFL             =       30.0

***---------------------------------------------------------------------------
***SET STAMPEDE PRECAUTIONARY DRAWDOWN DEFAULT DATE
***---------------------------------------------------------------------------

***
***---------------------------------------------------------------------------
***ASSIGN MAXIMUM FLOW THROUGH STAMPEDE RESERVOIR OUTLET
***---------------------------------------------------------------------------
  GENER   1                               SMAXQ ***        =    4600  
***regression equations to determine smaxq
  IF (sstg <= 5765.0) THEN  
    GENER   1                               SMAXQ            =       0.0 
  ELSE IF [(sstg > 5765.0) AND (sstg <= 5775.0)] THEN 
    GENER   1                               SMAXQ            =    123.0    
    GENER   1                               SMAXQ           *=      sstg 
    GENER   1                               SMAXQ           -=  709095.0    
  ELSE IF [(sstg > 5775.0) AND (sstg <= 5800.0)] THEN 
    GENER   1                               SMAXQ            =      12.4  
    GENER   1                               SMAXQ           *=      sstg  
    GENER   1                               SMAXQ           -=   70380.0  
  ELSE IF [(sstg > 5800.0) AND (sstg <= 5825.0)] THEN  
    GENER   1                               SMAXQ            =       9.6   
    GENER   1                               SMAXQ           *=      sstg  
    GENER   1                               SMAXQ           -=   54140.0  
  ELSE IF [(sstg > 5825.0) AND (sstg <= 5860.0)] THEN  
    GENER   1                               SMAXQ            =      8.17   
    GENER   1                               SMAXQ           *=      sstg
    GENER   1                               SMAXQ           -=  45825.0  
  ELSE IF [(sstg > 5860.0) AND (sstg <= 5900.0)] THEN  
    GENER   1                               SMAXQ            =      6.96   
    GENER   1                               SMAXQ           *=      sstg 
    GENER   1                               SMAXQ           -=  38703.4  
  ELSE IF [(sstg > 5900.0) AND (sstg <= 5930.0)] THEN  
    GENER   1                               SMAXQ            =      6.71   
    GENER   1                               SMAXQ           *=      sstg 
    GENER   1                               SMAXQ           -=  37265.0 
  ELSE IF [(sstg > 5930.0) AND (sstg <= 5956.0)] THEN  
    GENER   1                               SMAXQ            =      6.49   
    GENER   1                               SMAXQ           *=      sstg 
    GENER   1                               SMAXQ           -=  35946.0 
  ELSE IF (sstg > 5956.0) THEN  
    GENER   1                               SMAXQ            =    2720.7    
  END IF  
 
***---------------------------------------------------------------------------
***CALCULATE STAMPEDE DAILY NET INFLOWS FROM STORAGE CHANGE
***---------------------------------------------------------------------------
*** calculate change in storage, all units in cfs 
  GENER   1                               SNET             =    sstot  
  GENER   1                               SNET            -=    sstol  
*** add  yesterdays releases from stampede
  GENER   1                               SNET            +=    srlst

***---------------------------------------------------------------------------
***SET STAMPEDE MAXIMUM ANNUAL STORAGE COUNTER 
***---------------------------------------------------------------------------
*** use october 1 for now for testing
  GENER   1 ***     1989 10 01  0  0      SNWVC            =       0.0 YR   1 20

***---------------------------------------------------------------------------
***SET STAMPEDE MAXIMUM ANNUAL STORAGE
***---------------------------------------------------------------------------
***  maximum of 226000 ac-ft to be stored in stampede lake on annual basis
***  a TROA document states that 126,000 is the annual cap,( which is probably
***  from the licence of the reservoir), but according to Buchanan and Boyer
***  nobody would complain if the storage was more than 126,000 because the 
***  water ultimately goes to Pyramid anyway.
  GENER   1         1989  8  1  0  0      SCAP             =   226000.

***---------------------------------------------------------------------------
***SET STAMPEDE MAXIMUM WINTER STORAGE
***---------------------------------------------------------------------------
***  maximum of 204576 ac-ft(5942.1 ft) to be stored in stampede on winter basis
  GENER   1         1989  8  1  0  0      SWCAP            =   204576.
 
*******************************************************************************
*** SET BOCA TIME DEPENDENT TARGETS
*******************************************************************************
***---------------------------------------------------------------------------
***SET BOCA PROPOSED MINIMUM RELEASES
***---------------------------------------------------------------------------
*** there are no minimum releases at Boca Reservoir

***---------------------------------------------------------------------------
***ASSIGN MAXIMUM FLOW THROUGH BOCA RESERVOIR OUTLET
***---------------------------------------------------------------------------
  GENER   1  ***                          BMAXQ            =    9000  

***regression equations to determine pmaxq
  IF (bstg <= 5521.0) THEN
    GENER   1                               BMAXQ            =       0.0
  ELSE IF [(bstg > 5521.0) AND (bstg <= 5525.0)] THEN
    GENER   1                               BMAXQ            =     71.25  
    GENER   1                               BMAXQ           *=      bstg
    GENER   1                               BMAXQ           -=  393371.2   
  ELSE IF [(bstg > 5525.0) AND (bstg <= 5527.5)] THEN
    GENER   1                               BMAXQ            =      36.0     
    GENER   1                               BMAXQ           *=      bstg
    GENER   1                               BMAXQ           -=  198615.0  
  ELSE IF [(bstg > 5527.5) AND (bstg <= 5530.0)] THEN
    GENER   1                               BMAXQ            =     18.00  
    GENER   1                               BMAXQ           *=      bstg
    GENER   1                               BMAXQ           -=  99120.00
  ELSE IF [(bstg > 5530.0) AND (bstg <= 5540.0)] THEN
    GENER   1                               BMAXQ            =    10.598  
    GENER   1                               BMAXQ           *=      bstg
    GENER   1                               BMAXQ           -=  58182.33
  ELSE IF [(bstg > 5540.0) AND (bstg <= 5560.0)] THEN
    GENER   1                               BMAXQ            =    6.6071  
    GENER   1                               BMAXQ           *=      bstg
    GENER   1                               BMAXQ           -=  36073.81
  ELSE IF [(bstg > 5560.0) AND (bstg <= 5605.0)] THEN
    GENER   1                               BMAXQ            =    5.2290  
    GENER   1                               BMAXQ           *=      bstg
    GENER   1                               BMAXQ           -=  28408.85
  ELSE IF (bstg > 5605.0) THEN
    GENER   1                               BMAXQ            =    900.00  
  END IF

***---------------------------------------------------------------------------
***SET BOCA FLORISTON RATES FLAG
***---------------------------------------------------------------------------
***  boca flag if drawing from storage to meet floriston rates 0-yes 1- no 
*** set for initial conditions
  GENER   1         1989  8  1  0  0   2  BFFLAG           =       0  ***
*** set for additional years of model run
  GENER   1         1990  4 10  0  0   2  BFFLAG ***       =       1   YR   1 20

***---------------------------------------------------------------------------
***SET BOCA MAX ANNUAL STORAGE COUNTER - FIRST 25,000 AC-FT,SECOND 15,850 AC-FT
***---------------------------------------------------------------------------
***  maximum of 25,000 ac-ft (adverse to canal) stored in boca on annual basis
***  addtional 15,850 ac-ft(not adverse to canal)stored in boca on annual basis
*** set storage = 0. on october 1
  IF (mo_da >= 10.01) AND (mo_da < 6.01) AND (bsto < bmin) THEN  ***
    GENER   1      ***                      BNWVC            =       0.0 
  END IF ***

***---------------------------------------------------------------------------
***SET FIRST RIGHT BOCA MAXIMUM ANNUAL STORAGE
***---------------------------------------------------------------------------
***  maximum of 25,000 ac-ft to be stored in indep lake on annual basis
  GENER   1         1989  8  1  0  0      BCAP1            =    25000.

***---------------------------------------------------------------------------
***SET SECOND RIGHT BOCA MAXIMUM ANNUAL STORAGE
***---------------------------------------------------------------------------
***  maximum total of 40850 ac-ft to be stored in indep lake on annual basis
  GENER   1         1989  8  1  0  0      BCAP2            =   40850. 

***---------------------------------------------------------------------------
***SET BOCA MAXIMUM WINTER STORAGE
***---------------------------------------------------------------------------
***  maximum of 32800 ac-ft (5596.4 ft)to be stored in boca on winter basis
  GENER   1         1989  8  1  0  0      BWCAP            =    32800. 

***---------------------------------------------------------------------------
***CALCULATE BOCA DAILY NET INFLOWS FROM STORAGE CHANGE
***---------------------------------------------------------------------------
*** calculate change in storage, all units in cfs 
  GENER   1                               BNET             =    bstot 
  GENER   1                               BNET            -=    bstol     
*** add  yesterdays releases from boca
  GENER   1                               BNET            +=    brlst

***---------------------------------------------------------------------------
*** inflow to boca (ac-ft) btotv = bsto + soflv + blflv
***---------------------------------------------------------------------------
  GENER   1                               BTOTV            =    bsto
  GENER   1                               BTOTV           +=   soflv 
  GENER   1                               BTOTV           +=   blflv

***---------------------------------------------------------------------------
*** amount of natural water avaialble in boca,cfs
***---------------------------------------------------------------------------
  GENER   1                               BNWTF            =    bnwvf
  GENER   1                               BNWTF            =    blfl 

*******************************************************************************
*** CALCULATE SIDE WATER BY FWM METHOD
*******************************************************************************
***----------------------------------------------------------------------------
***   calculate side water flow by FWM method
***   = flow at farad - tahoe release  - Donner release
***   - Prosser release - Boca release 
***----------------------------------------------------------------------------
*** all units are in cfs here
  GENER   1                               SIDH2O           =    fq     ***
*** these releases need to be looked at 
  GENER   1                               SIDH2O          -=    trls   ***
  GENER   1                               SIDH2O          -=    dofl   ***
  GENER   1                               SIDH2O          -=    pofl   ***
  GENER   1                               SIDH2O          -=    bofl   ***

*******************************************************************************
*** CALCULATE NATURAL FLOW AT FARAD BY FWM METHOD
*******************************************************************************
***  natural flow at farad by FWM method = side water + net inflow from 
***  reservoirs
***----------------------------------------------------------------------------
***   calculate natural flow at farad by FWM method
***   = flow at farad - tahoe release  + ^storage Donner 
***   + ^storage Prosser + ^storage Boca + ^storage Stampede 
***   + ^storage Independence  + sierra valley div(actual) 
***    (^ indicates change or delta)
***----------------------------------------------------------------------------
*** all units are in cfs here
  GENER   1                               FNWFWM           =    fq    ***
  GENER   1                               FNWFWM          -=    trlst  ***

***  storage for yesterday in reservoirs
  GENER   1                               FNWFWM          -=    dstofl ***
  GENER   1                               FNWFWM          -=    pstol ***
  GENER   1                               FNWFWM          -=    bstol   ***
  GENER   1                               FNWFWM          -=    sstol   ***
  GENER   1                               FNWFWM          -=    istol ***

***   storage for today in reservoirs
  GENER   1                               FNWFWM          +=    dstoft ***
  GENER   1                               FNWFWM          +=    pstot ***
  GENER   1                               FNWFWM          +=    bstot  ***
  GENER   1                               FNWFWM          +=    sstot  ***
  GENER   1                               FNWFWM          +=    istot ***

  GENER   1                               FNWFWM          +=    svrb  ***  


********************************************************************************
*** CALCULATE NATURAL FLOW AT FARAD BY SCS METHOD
********************************************************************************
***----------------------------------------------------------------------------
***   calculate natural flow at farad by SCS method
***   = flow at farad - tahoe release  
***   + ^storage Prosser + ^storage Boca + ^storage Stampede
***    (^ indicates change or delta)
***----------------------------------------------------------------------------
*** all units are in cfs here
  GENER   1                               FNWFSC           =    fq    ***
  GENER   1                               FNWFSC          -=    trlst  ***

***  storage for yesterday in reservoirs
  GENER   1                               FNWFSC          -=    pstol  ***
  GENER   1                               FNWFSC          -=    bstol   ***
  GENER   1                               FNWFSC          -=    sstol   ***

***   storage for today in reservoirs
  GENER   1                               FNWFSC          +=    pstot  ***
  GENER   1                               FNWFSC          +=    bstot  ***
  GENER   1                               FNWFSC          +=    sstot  ***

*******************************************************************************
*** CALCULATE NATURAL FLOW AT LITTLE TRUCKEE RIVER BY FWM METHOD
*******************************************************************************
***----------------------------------------------------------------------------
***   calculate natural flow at little truckee by FWM method
***   = flow in l. truckee blw boca  + ^storage Boca + ^storage Stampede 
***   + ^storage Independence  + sierra valley div(actual) 
***    (^ indicates change or delta)
***----------------------------------------------------------------------------
*** all units are in cfs here
  GENER   1                               LTNWFW           =    bofl  ***

***  storage for yesterday in reservoirs
  GENER   1                               LTNWFW          -=    bstol  ***
  GENER   1                               LTNWFW          -=    sstol  ***
  GENER   1                               LTNWFW          -=    istol  ***

***   storage for today in reservoirs
  GENER   1                               LTNWFW          +=    bstot  ***
  GENER   1                               LTNWFW          +=    sstot  ***
  GENER   1                               LTNWFW          +=    istot  ***
  GENER   1                               LTNWFW          +=    svrb   ***

*******************************************************************************
*** CALCULATE NATURAL FLOW AT LITTLE TRUCKEE RIVER BY SCS METHOD
*******************************************************************************
***----------------------------------------------------------------------------
***   calculate natural flow at little truckee by SCS method
***   = flow in l. truckee blw boca + ^storage Stampede 
***    (^ indicates change or delta)
***----------------------------------------------------------------------------
*** all units are in cfs here
  GENER   1                               LTNWFS           =    bofl  ***
***  storage for yesterday in reservoirs
  GENER   1                               LTNWFS          -=    sstol  ***
***   storage for today in reservoirs
  GENER   1                               LTNWFS          +=    sstot  ***


*******************************************************************************
*** CALCULATE NATURAL FLOW AT FARAD BY SIERRA VALLEY DECREE METHOD
*******************************************************************************
***----------------------------------------------------------------------------
***   calculate natural flow at farad = flow at farad + sierra valley div-actual
***       + evap prosser  + evap stampede + evap boca  + ^storage Donner 
***       + ^storage Prosser + ^storage Independence + ^storage Stampede
***       + ^storage Boca  (^ indicates change or delta)
***----------------------------------------------------------------------------
*** all units are in cfs here
  GENER   1                               FNWFSV           =    fq    
  GENER   1                               FNWFSV          +=    svrb    
***  evaporation in 3 reservoirs
  GENER   1                               FNWFSV          +=    pevp    
  GENER   1                               FNWFSV          +=    sevp    
  GENER   1                               FNWFSV          +=    bevp    
***  storage for yesterday in reservoirs
  GENER   1                               FNWFSV          -=    dstofl 
  GENER   1                               FNWFSV          -=    pstol 
  GENER   1                               FNWFSV          -=    istol 
  GENER   1                               FNWFSV          -=    sstol   
  GENER   1                               FNWFSV          -=    bstol   
***   storage for today in reservoirs
  GENER   1                               FNWFSV          +=    dstoft
  GENER   1                               FNWFSV          +=    pstot 
  GENER   1                               FNWFSV          +=    istot 
  GENER   1                               FNWFSV          +=    sstot  
  GENER   1                               FNWFSV          +=    bstot  

***-----------------------------------------------------------------------------
*** CALCULATE FLORISTON RATES AND DIFF IN FLORISTON RATES AND FARAD FLOW  
***-----------------------------------------------------------------------------
***                                        addr or              uvq or
***                                       <------>              <---->
*** opt fop lop     year mo dy hr mn d t   vnam  s1 s2 s3 ac quantity  tc  ts rp
  <****><-><-->     <--> <> <> <> <><><>  <----><-><-><-><-><--------> <> <-><->
*** begin calculations with total Farad flow ***
  GENER   1                               FADJ             =   fq     
***determine floriston rate and subtract appropriate Floriston Rate from farad
  IF {month = 10.0 OR [tstg >= 6226.0 AND (month >= 11 OR month <= 2)]} THEN
    GENER   1                               FLRATE           =     400.0
    GENER   1                               FADJ            -=   flrate
    GENER   1                               FADJ            -=     400.0 ***
  ELSE IF [(month >= 4. AND month <= 9.) OR (month = 3 AND tstg >= 6226.0)] THEN
    GENER   1                               FLRATE           =     500.0
    GENER   1                               FADJ            -=     500.0***
    GENER   1                               FADJ            -=   flrate
  *** calculate reduced floriston rate
  ELSE IF {tstg < 6225.25 AND (month >= 11 OR month <= 3)} THEN 
    GENER   1                               FLRATE           =     300.0
    GENER   1                               FADJ            -=   flrate
    GENER   1                               FADJ            -=     300.0 ***
  *** calculate reduced floriston rate
  ELSE IF [(tstg >= 6225.25 AND tstg < 6226.0) AND (month >= 11 OR 
            month <= 3)] THEN 
    GENER   1                               FLRATE           =     350.0
    GENER   1                               FADJ            -=     350.0***
    GENER   1                               FADJ            -=   flrate
  END IF

***----------------------------------------------------------------------------
***   assign tolerance of Floriston Rates for reservoir releases
***----------------------------------------------------------------------------

*** all units are in cfs here
  GENER   1         1989  8  1  0  0      FTOL             =      10.0

***=========================================================================
***     2. Determine proposed spills and pre-cautionary drawdowns, following
***        SOPs
***     3. Determine downstream-flood-prevention measures
***=========================================================================

*** tttttt
***+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
*** LAKE TAHOE SPILL SITUATION
***+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

*** according to the truckee river agreement (TRA), determine lake tahoe
*** rise in Mar 1 and April 1, which are dates of SCS forecasts when TRA
*** was written. However today, SCS forecasts are available for Jan to May.
*** the following logic uses Jan - May forecasts for TRA lake tahoe spills

  IF (tstg >= 6228.0) THEN
    IF (mo_da <= 5.31) THEN   
      *** jan-may, use scs forecast (tfor)
      *** tahoe estimated volume = todays volume + forecast, all in ac-ft
      GENER   1                               TSTOE            =    tsto   
      GENER   1                               TSTOE           +=    tfor   
    ELSE 
      *** whenever not in Jan - May period, use logic as described by FWM. 
      *** An empirical method was used to determine this estimated forecast.
      *** Knowing that the maximum  spill out of tahoe is 2600 cfs,
      *** if the lake stage is 6228.5, it takes 14 
      *** days of inflow at 2600 cfs to fill lake at 6229.1 
      *** Use this logic to describe an estimated 'forecast' and when to spill.
      *** june-dec use est forecast (tfore ) volume
      *** tahoe est forecast volume= net daily inflow (tnetv )x 14 days, in ac-ft
      GENER   1                               TFORE            =    tnetv 
      GENER   1                               TFORE           *=    14.
      *** if net inflow is negative, use zero as inflow for calculation
      GENER   1                               TFORE          MAX    0.0 
      *** tahoe estimated volume = todays volume + forecast, all in ac-ft
      GENER   1                               TSTOE            =    tsto  
      GENER   1                               TSTOE           +=    tfore 
    END IF
    IF (tstoe > 1227368) THEN 
      *** if estimated tahoe storage above 1227368 ac-ft (6229.1 ft stage) 
      IF (fq > 6000.) THEN 
        *** flows are high at reno, shut down releases
        GENER   1                               TDRW             =    0.0
        ***  set flag for storage = 1, must store water
        GENER   1                            2  TFLAG            =    1
        IF (tstg > 6229.0) THEN 
          ***  send down inflows, very little freeboard left
          GENER   1                               TDRW             =    tnet
          *** make sure release is a positve value
          GENER   1                               TDRW           MAX   0.0
          *** set tdrw to tmaxq
          GENER   1                               TDRW           MIN    tmaxq
          ***  set flag for storage = 0
          GENER   1                            2  TFLAG            =    0
        END IF
      ELSE 
        *** condition where reno flows less than 6000
        *** spill amount of estimate > 6229.1, probable actual operating
        *** procedures
        GENER   1                               TDIFV            =    tstoe 
        GENER   1                               TDIFV           -=   1227368
        *** covert volume to a flow
        GENER   1                               TDRW             =    tdifvf
        GENER   1                               TDRW           MIN    tmaxq
        ***  set flag for storage = 0
        GENER   1                            2  TFLAG            =    0
      END IF
    ELSE 
      *** tstoe < 1.2 million
      GENER   1                               TDRW             =   0.0
      ***  set flag for storage = 1
      GENER   1                            2  TFLAG            =    1
    END IF 
  END IF 

     ***-----------------------------------------------------------------------
     *** calculate total tahoe release and outflow
     *** At this point, drawdown is the only release
     ***-----------------------------------------------------------------------
  GENER   1                               TRLS             =    tdrw 
  GENER   1                               TOFL             =    trls
  GENER   1                               TRLST            =    0.0 


*** ddddddd
***+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
***  DONNER LAKE RELEASES - SOP
***+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

*******************************************************************************
*** DONNER LAKE UNCONTROLLED SPILLS
*******************************************************************************
***----------------------------------------------------------------------------
*** donner lake spills as mentioned in the donner lake indenture
*** if donner lake elev > 5935.8, release inflow (difl  ) up to max of 
*** 700 cfs (channel capacity per usgs gage at donner and r. moser) or dmaxq
*** this is not in the decree, but it appears from historic inflow and outflow
*** data that the flood releases from Donner Lake are such that :
***   1.5 * inflow  = outflow until the elevation returns to less than 5935.8
*** spilled water is counted as TCID water for now
***  there is a human element to spills at this lake
***----------------------------------------------------------------------------
  IF (dstg   > 5935.8 ) THEN   
    GENER   1                               DSPL             =    difl   
    GENER   1                               DSPL            *=    1.5 
    GENER   1                               DSPL           MIN    dmaxq
    GENER   1                               DRLS             =    0.0
    ***  set flag for storage = 0
    GENER   1                            2  DFLAG            =    0
  ELSE 
    GENER   1                               DSPL             =       0.0 
    GENER   1                               DRLS             =    0.0
    ***  set flag for storage = 1
    GENER   1                            2  DFLAG            =    1
    GENER   1                               DSPRA            =    0.0 
    GENER   1                               DTCRA            =    0.0 
    GENER   1                               DDRW             =    0.0 
  END IF   


*******************************************************************************
*** DONNER LAKE PRECAUTIONARY DRAWDOWNS
*******************************************************************************
***----------------------------------------------------------------------------
*** from 1970 certificate of approval, must drop lake elevation to 5926.9
***   by Nov 15. This apparently happens after Sept 15 according to
***   operational procedures in R. hall's book.
***----------------------------------------------------------------------------
***  if donner lake elev >= 5926.9 on sept 15, calculate amount of precautionary
***  drawdown 

  IF (dstg   >= 5926.9) AND (dstg   < 5935.8) AND (fq     <= 6000) AND
     (mo_da >= 9.15 AND mo_da <= 11.15) THEN 
    ***Compute how many days from today to nov 16
    GENER   1                               DAYS             =    jnov16
    GENER   1                               DAYS            -=    jul_da
    ***Calculate amount needed to drop to 2275 ac-ft storage
    GENER   1                               DDIFV            =    dsto
    GENER   1                               DDIFV           -=  2275. 
    ***Calculate daily storage drawdown from today to nov 1
    GENER   1                               DDRW             =    ddifvf
    GENER   1                               DDRW            /=    days
    *** add in inflows
    GENER   1                               DDRW            +=    dnet
    ***Make sure spill is not negative
    GENER   1                               DDRW           MAX    0.0
    ***Set flag for no no storage.
    GENER   1                            2  DFLAG            =    0
    ***  use calculated spills, ddrw  , as calculated above
  ELSE IF (mo_da >= 9.15 AND mo_da <= 11.15) AND (dstg   < 5926.9) THEN 
    *** stage is below 5926.9 during period from sept 15 to nov 15 
    GENER   1                               DDRW             =    0.0 
    GENER   1                               DSPRA            =    0.0 
    GENER   1                               DTCRA            =    0.0 
    ***  set flag for storage = 1
    GENER   1                            2  DFLAG            =    1
  END IF  
 
*******************************************************************************
*** DONNER LAKE WINTERTIME CAPACITY
*******************************************************************************
***----------------------------------------------------------------------------
*** from 1970 certificate of approval, from Nov 16 to April 15 gates shall
***   be held wide open at elevation of 5926.9 ft i.e. release inflows
*** from calif division of safety of dams. however in practice moser follows
***  several different filling patterns.
***----------------------------------------------------------------------------

***  if donner lake elev >= 5927.6 dump inflows nov 16 to march 15 
*** testing flows at farad is not in any decree
  IF (dstg < 5935.8) AND (fq <= 6000.) AND
     (mo_da >= 11.16 OR mo_da <= 3.15) THEN 
    ***  if early filling of doner, use targets from moser early filling memo
    ***  target date   lake elevation
    ***  Feb 14        5927.6
    ***  March 15      5928.5
    IF (frflag = 0) THEN 
      ***  drought - early filling of donner
      IF (mo_da >= 11.16) OR (mo_da <= 2.14) THEN
        *** calculate total amount needed to hold at 5927.6 (storage = 2800 ac-ft)
        GENER   1                               DWCAP            =    2800.

      ELSE IF (mo_da >= 2.15) AND (mo_da <= 3.15) THEN
        *** calculate total amount needed to hold at 5928.5 (storage = 3190 ac-ft)
        GENER   1                               DWCAP            =    3190.

      END IF 
    ELSE 
      *** not in drought situation
      *** calculate total amount needed to hold at 5927.6 (storage = 2800 ac-ft)
      GENER   1                               DWCAP            =    2800.

    END IF  
  END IF

  ***  if donner lake elev >= 5929.5 dump inflows mar 16 to april 15 
  ***  this partial filling from march 15 to apr 15 is from the moser 1995 fill chart
  *** set fill schedule on the basis of moser fill charts for any year 
  ***  target date   lake elevation
  ***  April 15      5929.5
  ***  May 1         5930.5

  ***  this partial filling from march 15 to apr 15 is from
  ***   the moser 1995 fill chart for early filling 
  *** set fill schedule on the basis of moser fill charts 
  ***  target date   lake elevation
  ***  April 15      5932.0
  ***  May 1         5933.5

  *** testing flows at farad is not in any decree
  IF (dstg   < 5935.8) AND (fq <= 6000.) AND
     (mo_da >= 3.16 AND mo_da <= 4.15) THEN 
    IF (frflag = 0) THEN 
      ***  drought - early filling of donner
      *** calculate total amount needed to hold at 5932.0 (storage = 6310 ac-ft)
      GENER   1                               DWCAP            =    6310.

    ELSE 
      *** not in early filling situation
      *** calculate total amount needed to hold at 5929.5 (storage = 4295 ac-ft)
      GENER   1                               DWCAP            =    4295.

    END IF 
  END IF  

 *** testing flows at farad is not in any decree
  IF (dstg   < 5935.8) AND (fq <= 6000.) AND
     (mo_da >= 4.16 AND mo_da <= 5.01) THEN 
    IF (frflag = 0) THEN 
      ***  drought - early filling of donner
      *** calculate total amount needed to hold at 5933.5 (storage = 7550 ac-ft)
      GENER   1                               DWCAP            =    7550.
    ELSE 
      *** not in early filling situation
      *** calculate total amount needed to hold at 5930.5 (storage = 5090 ac-ft)
      GENER   1                               DWCAP            =    5090.
    END IF 

  END IF

 IF (dstg   < 5935.8) AND (fq <= 6000.) AND
     (mo_da >= 11.16 OR mo_da <= 5.01) THEN 
 *** compute amount above or below dwcap, ac-ft
      GENER   1                               DAVLV            =    dsto   
      GENER   1                               DAVLV           -=    dwcap  

    IF (davlv > 0.0) THEN 
      *** above dwcap, compute flow needed to release

      IF (dnet < 0.0) THEN
      *** then release amount above dwcap
      GENER   1                               DDRW             =    davlvf 
      GENER   1                               DDRW           MIN    dmaxq ***

      ELSE 
      *** then release amount above dwcap + dnet
      GENER   1                               DDRW             =    davlvf 
      GENER   1                               DDRW            +=    dnet
      GENER   1                               DDRW           MIN    dmaxq ***

      END IF 
      ***  set flag for storage = 0
      GENER   1                            2  DFLAG            =    0

    ELSE 
      *** below target then dont release anything at this point 
      GENER   1                               DSPRA            =    0.0 
      GENER   1                               DTCRA            =    0.0 
      GENER   1                               DDRW             =    0.0 
      ***  set flag for storage = 1
      GENER   1                            2  DFLAG            =    1
    END IF
 END IF  

**********************************************************************
***  DONNER LAKE SPRINGTIME RESERVOIR FILLING
**********************************************************************

*** for the period may 2 to june 15, fill donner on the basis
***  of a wet, average  or dry forecast schedule on basis of moser fill charts

  IF (fq <= 6000) AND (mo_da > 5.01 AND mo_da < 6.15) AND (dstg < 5935.8) THEN  

    *** seperate into various forecasts
    IF (frflag = 3) THEN 
      *** frflag = 3 for wet year 
      *** set fill schedule on the basis of moser fill charts for a wet year
      ***  target date   lake elevation  lake storage
      ***  may 15        5931.0           5490.
      ***  June 1        5933.5           7550.
      ***  june 15       5935.8           9494.
      IF (mo_da < 5.15) THEN 
        *** calculate amount needed to hold at 5931.0 (storage = 5490. ac-ft)
        GENER   1                               DWCAP            =    5490.
        ***compute how many days from today to may15  
        GENER   1                               DAYS             =    jmay15 
      ELSE IF (mo_da < 6.01)  THEN 
        *** calculate amount needed to hold at 5933.5 (storage = 7550. ac-ft)
        GENER   1                               DWCAP            =    7550.
        ***compute how many days from today to june1  
        GENER   1                               DAYS             =    jjun1
      ELSE 
        ***mo_da <= 6.15
        *** calculate amount needed to hold at 5935.8 (storage = 9494. ac-ft)
        GENER   1                               DWCAP            =    9494.      
        ***compute how many days from today to june15
        GENER   1                               DAYS             =    jjun15 
      END IF 
    ELSE IF (frflag = 1) THEN 
      *** frflag = 1 for dry year 
      *** set fill schedule on the basis of moser fill charts for a dry year
      ***  target date   lake elevation  lake storage 
      ***  May 15        5932.0           6310.
      ***  June 1        5935.0           8810.
      ***  June 15       5935.8           9494.
      IF (mo_da < 5.15) THEN 
        *** calculate amount needed to hold at 5932.0 (storage = 6310. ac-ft)
        GENER   1                               DWCAP            =    6310.
        ***compute how many days from today to may15  
        GENER   1                               DAYS             =    jmay15
      ELSE IF (mo_da < 6.01)  THEN 
        *** calculate amount needed to hold at 5935.0 (storage = 8810. ac-ft)
        GENER   1                               DWCAP            =    8810.
        ***compute how many days from today to june1
        GENER   1                               DAYS             =    jjun1
      ELSE   
        *** mo_da <= 6.15
        *** calculate amount needed to hold at 5935.8 (storage = 9494. ac-ft)
        GENER   1                               DWCAP            =    9494. 
        ***compute how many days from today to june 15 
        GENER   1                               DAYS             =    jjun15
      END IF 
    ELSE IF (frflag = 0) THEN 
      *** frflag = 0 for drought year 
      *** set fill schedule on the basis of moser fill charts for an early fill
      ***  target date   lake elevation  lake storage 
      ***  May 15        5935.0           8810.
      ***  June 15       5935.8           9494.
      IF (mo_da < 5.15) THEN 
        *** calculate amount needed to hold at 5935.0 (storage = 8810. ac-ft)
        GENER   1                               DWCAP            =    8810.
        ***compute how many days from today to may15  
        GENER   1                               DAYS             =    jmay15
      ELSE   
        *** mo_da <= 6.15
        *** calculate amount needed to hold at 5935.8 (storage = 9494. ac-ft)
        GENER   1                               DWCAP            =    9494. 
        ***compute how many days from today to june 15 
        GENER   1                               DAYS             =    jjun15
      END IF 
    ELSE IF (frflag = 2) THEN
      *** frflag = 2 for average year 
      *** set fill schedule on the basis of moser fill charts for a avg year
      *** (the average of a wet and dry curve)
      ***  target date   lake elevation  lake storage 
      ***  May 15        5931.5           5900.
      ***  June 1        5934.5           8390.
      ***  June 15       5935.8           9494.
      IF (mo_da < 5.15) THEN 
        *** calculate amount needed to hold at 5931.5 (storage = 5900. ac-ft)
        GENER   1                               DWCAP            =    5900.
        ***compute how many days from today to may15  
        GENER   1                               DAYS             =    jmay15
      ELSE IF (mo_da < 6.01)  THEN 
        *** calculate amount needed to hold at 5934.5 (storage = 8390. ac-ft)
        GENER   1                               DWCAP            =    8390.
        ***compute how many days from today to june1
        GENER   1                               DAYS             =    jjun1
      ELSE   
        *** mo_da <= 6.15
        *** calculate amount needed to hold at 5935.8 (storage = 9494. ac-ft)
        GENER   1                               DWCAP            =    9494. 
        ***compute how many days from today to june 15 
        GENER   1                               DAYS             =    jjun15
      END IF 
    END IF 

  *** determine dmax storage
    *** calculate amount needed to hold at dwcap storage ac-ft
    GENER   1                               DAVLV            =    dwcap 
    GENER   1                               DAVLV           -=    dsto 
    GENER   1                               DAVLV          MAX   0.0  
    ***compute how many days from today to target date
    GENER   1                               DAYS            -=    jul_da 
    ***Calculate daily storage for XX days from today to target date
    GENER   1                               DMAX             =    davlvf 
    GENER   1                               DMAX            /=    days 
    GENER   1                               DMAX           MAX    0.0 

  *** determine amount to dump
    IF (dsto < dwcap) AND (dflag = 1) THEN
      *** can store in donner
      IF (dnet   > 0.) THEN 
        *** compare ddump to davlvf (flow available below cap)
        GENER   1                               DDUMP            =   dnet
        GENER   1                               DDUMP           -=   davlvf
        GENER   1                               DDUMP          MAX    0.0
        GENER   1                               DDUMP          MIN   dmaxq ***
        *** compare max store from SOP,dmaxf to dnet,compute excess inflow 
        GENER   1                               DPSVCE           =    dnet   
        GENER   1                               DPSVCE          -=    dmaxf
        GENER   1                               DPSVCE         MAX    0.0
        *** compare ddump to dpsvce  
        GENER   1                               DDUMP          MAX    dpsvce
      ELSE 
        GENER   1                               DDUMP            =    0.0
      END IF
    ELSE
      ***  no storage  if above dwcap or dflag = 0
      IF (dnet > 0.) THEN 
        GENER   1                               DDUMP            =    dnet  
        GENER   1                               DDUMP          MIN    dmaxq ***
      ELSE 
        GENER   1                               DDUMP            =    0.0
      END IF 
    END IF

  END IF 
  
***----------------------------------------------------------------------------
*** calculate total proposed donner releases
***----------------------------------------------------------------------------

  GENER   1                               DRLS             =    ddrw

  GENER   1                               DOFL             =    drls
  GENER   1                               DOFL            +=    dspl

  GENER   1                               DRLS             =    dofl

  GENER   1                               DRLST            =    0.0 
  GENER   1                               DNWRA            =    0.0
 
**************************************************************************
*** DONNER LAKE NON-FLOOD OPERATIONS
**************************************************************************

***----------------------------------------------------------------------------
*** otherwise for testing purposes split releases into two catgories for period 
***  june 16 to Sept 14
*** for now, in order to have releases from donner all the time, use ddmd  
***----------------------------------------------------------------------------

  IF (mo_da >= 6.16) AND (mo_da <= 9.14) AND (dstg   < 5935.8) THEN 
    *** this will be changed when ownership is known
    GENER   1                               DNWRA            =    ddmd  
    GENER   1                               DNWRA          MIN    dmaxq ***
    GENER   1                               DNWRA          MIN    dnwvf 
    GENER   1                               DRLS             =    0.0
    ***  set flag for storage = 1
    GENER   1                            2  DFLAG            =    1
  END IF  

***----------------------------------------------------------------------------
*** calculate total proposed donner releases
***----------------------------------------------------------------------------

  GENER   1                               DRLST            =    dspra 
  GENER   1                               DRLST           +=    dtcra
  GENER   1                               DRLST           +=    dnwra 


*** ppppppp

***+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
***  PROSSER CREEK RESERVOIR RELEASES - SOP
***+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

*****************************************************************************
***  PROSSER CREEK RESERVOIR UNCONTROLLED SPILLS
*****************************************************************************

  IF (pstg > 5741.2) THEN
    ***---------------------------------------------------------------------
    *** Prosser Reservoir uncontrolled spills.
    *** From SOP Flood Control Operation, if stage > 5741.2 (29800 ac-ft) then
    *** use emergency spillway diagram regardless of flows at reno
    ***---------------------------------------------------------------------
    *** set spill
    GENER   1                               PSPL             =    pmaxq
    *** set pdrw = 0
    GENER   1                               PDRW             =    0
    GENER   1                            2  PFLAG            =    0
  ELSE IF (ptotv >= 29800.0) THEN
    ***Prosser storage is projected to exceed volume at spill height
    ***(29800 ac-ft), so make a pre-cautionary drawdown.
    ***NOTE: This check is pretty crude for now. We need something
    ***better for later. Check for 2-5 days in advance.
    GENER   1                               PSPL             =    0.0
    *** pdrw = pmaxq for gates
    GENER   1                               PDRW             =    pmaxq
    GENER   1                            2  PFLAG            =    0
  ELSE
    IF (fq >= 6000.0) THEN
      ***Prosser stage is low, but Reno is flooding, so store Prosser inflow.
      GENER   1                               PSPL             =    0
      ***pdrw = (either 0 or some value to prevent spill and dam damage.)
      GENER   1                               PDRW             =    0.0
      ***Set flag for storage.
      GENER   1                            2  PFLAG            =    1
    ELSE
      ***Prosser stage is low and Reno is not flooding, so store and release
      ***to meet SOPs.
      ***Set initial conditions for SOP variables. These settings will be
      ***used through remainder of Special Actions block unless reset
      ***for Standing Operating Proceedures (SOP).
      GENER   1                               PDRW             =    0.0
      GENER   1                               PSPL             =    0.0
      GENER   1                            2  PFLAG            =    1

      ***Now evaluate for each time period and determine if drawdown is
      ***required.

      **********************************************************************
      ***  PROSSER RESERVOIR PRECAUTIONARY DRAWDOWNS
      **********************************************************************
      ***-------------------------------------------------------------------
      *** October SOP operation.
      *** From SOP Flood Control Operation, if flows at reno are < 6000 cfs,
      *** must drop lake elevation to 5703.7 or 20,000 ac-ft flood storage
      *** by Nov 1. This happens from Oct 1 to Nov 1
      ***
      ***-------------------------------------------------------------------
      IF ( (mo_da >= 10.01) AND (mo_da <= 10.31) AND (psto >= 9850.0) ) THEN
        ***If prosser storage > 9850.0 on oct 1, calculate amount of release
        ***Calculate flow for every day between oct 1 to nov 1 .
        ***For now, calculation is a simple linear reduction over the month
        ***as limited by the outflow capacity (pmaxq).
        ***
        ***NEEDS WORK: for later revision, include logic that will consider
        ***concurrent drawdown rate of Prosser, whether drawdown should be
        ***earlier in year because of pmaxq limitation, and maybe consider
        ***recreational interests.
        ***Compute how many days from today to nov 1
        GENER   1                               DAYS             =    jnov1
        GENER   1                               DAYS            -=    jul_da
        ***Calculate amount needed to drop to 9850 ac-ft storage
        GENER   1                               PDIFV            =    psto
        GENER   1                               PDIFV           -=  9850. 
        ***Calculate daily storage drawdown from today to nov 1
        GENER   1                               PDRW             =    pdifvf
        GENER   1                               PDRW            /=    days
        *** add in inflows
        GENER   1                               PDRW            +=    pnet
        ***Make sure spill is not negative
        GENER   1                               PDRW           MAX    0.0
        ***Limit proposed drawdown by outflow capacity
        ***This needs to be done now so that later routines (eg. floadjust)
        ***have a realistic value.
        GENER   1                               PDRW           MIN    pmaxq
        ***Set flag for no no storage.
        GENER   1                            2  PFLAG            =    0
      END IF 

      *****************************************************************************
      ***  PROSSER CREEK RESERVOIR PRECAUTIONARY DRAWDOWNS - EMPIRICAL METHOD
      *****************************************************************************

      ***----------------------------------------------------------------------------
      *** on august 5 of each year, determine lake contents, then determine 
      *** schedule for precautionary drawdown so that by Nov 1 down to lake 
      *** elevation of 5703.7 ft per flood control diagram
      ***----------------------------------------------------------------------------

      *** from observed record, it appears that the lake is drawn down to 
      *** an storage of 9800 ac-ft, or an elevation of 5703.7 ft about nov 1

      *** logic for the case when a storm hits between aug 5 & nov 1
      ***  we are dumping inflows in addition to the calculated
      ***  amount for drawdown, so any storm would be taken care of in total 
      ***  drawdown releases

      IF (psto > 9800) THEN  ***
        *** calculate the lake storage above 9800 ac-ft on August 5
        GENER   1         1989/08/05 ***        PDIFV            =    psto        1 10
        GENER   1         1989/08/05    ***     PDIFV           -=    9800        1 10
      ELSE  ***
        *** case where on Aug 5, below needed drawdown, set drawdown date = nov 1
        GENER   1***      1989/08/05            PDAT             =    11.0        1 10
      END IF  ***
 
      ***----------------------------------------------------------------------------
      *** the following logic for precautionary drawdown is empirical logic from 
      *** observed record and is not in any decree
      ***----------------------------------------------------------------------------

      ***  calculate how much drawdown is needed over a time period of 85,60,or 
      ***  30 days
      IF (pdifv > 17000) THEN  ***
        ***lake storage > 27000 ac-ft, dump for 85 days to reach 9,800 by nov 1
        *** varaible pdifvf is storage in cfs
        GENER   1         1989/08/05***         PDRW             =    pdifvf      1 10
        GENER   1         1989/08/05   ***      PDRW            /=    85          1 10
        *** set starting precautionary drawdown date to Aug 7
        GENER   1         1989/08/05      ***   PDAT             =    8.07        1 10
      ELSE IF (pdifv > 3000) THEN  ***
        *** condition where  17000 > pdifv > 3000
        ***lake storage > 13000 ac-ft, dump for 60 days to reach 9,800 by nov 1
        GENER   1         1989/08/05  ***       PDRW             =    pdifvf      1 10
        GENER   1         1989/08/05     ***    PDRW            /=    60          1 10
        *** set starting precautionary drawdown date to Sep 1
        GENER   1         1989/08/05    ***     PDAT             =    9.01        1 10
      ELSE IF (pdifv > 0) THEN  ***
        *** condition where  3000 < pdifv < 0
        ***lake storage < 13000 ac-ft, dump for 30 days to reach 9,800 by nov 1
        GENER   1         1989/08/05 ***        PDRW             =    pdifvf      1 10
        GENER   1         1989/08/05 ***        PDRW            /=    30          1 10
        *** set starting precautionary drawdown date to Oct 1
        GENER   1         1989/08/05    ***     PDAT             =   10.01        1 10
      END IF  ***

      *** re-evaluate drawdown on oct. 1
      IF (psto > 9800) THEN   ***
        *** calculate the lake storage above 9800 ac-ft 
        GENER   1         1989/10/01 ***        PDIFV            =    psto        1 10
        GENER   1         1989/10/01    ***     PDIFV           -=    9800        1 10
        ***, dump for 30 days to reach 9,800 by nov 1
        GENER   1         1989/10/01 ***        PDRW             =    pdifvf      1 10
        GENER   1         1989/10/01    ***     PDRW            /=    30          1 10
      END IF  ***

      *** check if precautionary start drawdown situation, if so dump calculated
      *** drawdown pdrw  
      IF (mo_da >= pdat  ) AND (mo_da <= 11.01) AND (psto   > 9800) THEN ***
        *** dump precautionary drawdown calculated plus inflows minus evap
        GENER   1        ***                    PDRW             =  pdrw
        GENER   1           ***                 PDRW            +=  pnet
        *** there is an 1800 cfs max channel capacity 
        *** per usgs gage  below prosser 
        GENER   1              ***              PDRW           MIN  pmaxq
        GENER   1                 ***           PDRW           MAX  0.0
        ***  set flag for storage = 0
        GENER   1                ***         2  PFLAG            =    0
      ELSE IF (mo_da >= pdat) AND (mo_da <= 11.01) AND (psto < 9800) THEN***
        GENER   1                    ***        PDRW             =       0.0 
      END IF  ***
  
      *****************************************************************************
      ***  PROSSER CREEK RESERVOIR WINTERTIME CAPACITY
      *****************************************************************************

      ***------------------------------------------------------------------
      ***November through Spring SOP operation (Nov.1 - April 9 or May 31).
      ***from SOP Flood Control Operation, from Nov 1 to April 10 gates
      ***shall be held wide open at elevation of 5703.7 ft i.e. release net
      ***inflows to maintain 20,000 ac-ft storage
      ***if dry year hold elevation until apr 10, wdflag = 0 for dry year
      ***if wet year hold elevation until june 1, wdflag = 1 for wet year
      ***-------------------------------------------------------------------

      ***&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&
      ***  if DRY year hold elevation until apr 10, wdflag = 0 for dry year
      ***  if prosser elev > 5703.7 dump above 5703.7 nov 1 to apr 10
      ***&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&
      ***  if WET year hold elevation until june 1, wdflag = 1 for WET year
      ***  if prosser elev > 5703.7 dump above 5703.7 nov 1 to jun 1
      ***&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&
 
      IF ((((mo_da >= 11.01) OR (mo_da <= 4.09)) AND (wdflag = 0))
            OR (((mo_da >= 11.01) OR (mo_da <= 5.31)) AND (wdflag = 1))
            AND (psto > 9850.0) ) THEN
        ***calculate amount needed to hold at 5703.7 (storage = 9850 ac-ft)
        GENER   1                               PDIFV            =    psto
        GENER   1                               PDIFV           -=    9850.0
        ***add in todays trib inflow in ac-ft, piflv
        GENER   1                               PDIFV           +=    piflv
        IF (pdifv > 0.0) THEN
          *** check to see if storage > 9850 and flow available to release
          *** there is no max channel capacity due to emer spillway
          *** requirements
          GENER   1                               PDRW             =    pdifvf
          ***Make sure spill is not negative
          GENER   1                               PDRW           MAX    0.0
          ***Limit proposed drawdown by outflow capacity
          GENER   1                               PDRW           MIN    pmaxq
          ***Set flag for no storage.
          GENER   1                            2  PFLAG            =    0
        END IF
      END IF

      **********************************************************************
      ***  PROSSER RESERVOIR SPRINGTIME RESERVOIR FILLING
      **********************************************************************
      ***------------------------------------------------------------------
      ***from SOP Flood Control Operation, from Apr 10 to May 19 gates shall
      ***be adjusted to fill reservoir , in a DRY year.
      ***extreme simplification of adding 20,000 ac-ft at 253 cfs/day for 40
      ***days to arrive at elevation of 5741.2 or calculate pmax every
      ***10 days
      ***-------------------------------------------------------------------
      ***from SOP Flood Control Operation, from June 1 to July 4 gates shall
      ***be adjusted to fill reservoir, in WET year. extreme simplification
      ***of adding 20,000 ac-ft at 289 cfs/day for 35 days to elevation of
      ***5741.2
      ***-------------------------------------------------------------------

      ***pmax - max allowable increase in storage to fill to 0 flood storage
      ***calc amount need to hold to arrive at 5741.2 (storage=29800 ac-ft)
      IF ( ((mo_da >= 4.10) AND (mo_da <= 5.19) AND (wdflag = 0))
        OR ((mo_da >= 6.01) AND (mo_da <= 7.04) AND (wdflag = 1)) ) THEN

        GENER   1                               PDIFV            =    29800.0
        GENER   1                               PDIFV           -=    psto
        ***Calculate flow for every day between Apr 10 and May 20
        IF (wdflag = 0) THEN
          ***julian day of may 20 = 140(use 141 so no divide by 0
          ***compute how many days from today to may 20
          GENER   1                               DAYS             =    jmay20
          GENER   1                               DAYS            -=    jul_da
        ELSE
          ***julian day of jul 5  = 186(use 187 so no divide by 0)
          ***compute how many days from today to jul 5
          GENER   1                               DAYS             =    jjul5
          GENER   1                               DAYS            -=    jul_da
        END IF

        ***NOTE: For late revisions, use SOP filling curves. The current
        ***routine assumes a simple linear fill rate.
        ***Calculate daily storage for XX days from today to may 20
        GENER   1                               PMAX             =    pdifvf
        GENER   1                               PMAX            /=    days
        GENER   1                               PMAX           MAX    0.0
        ***For dry year, add inflows april 10 to May 20 to bring up to full
        ***pool elevation 
        ***For wet year, add inflows june 1 to July 5 to bring up to full
        ***pool elevation
        ***NOTE: this logic has a fallacy because you dont know what the inflows
        ***are going to contribute. Earlier on in april too much is spilled
        ***because inflows are higher than inflows in may. Forecasts need to
        ***be used here.
      END IF
    END IF
  END IF 

***-----------------------------------------------------------------------
*** calculate total prosser release and outflow
*** At this point, drawdown is the only release
***-----------------------------------------------------------------------
  GENER   1                               PRLS             =    pdrw
  GENER   1                               POFL             =    pspl
  GENER   1                               POFL            +=    prls
  GENER   1                               PRLS             =    pofl
  GENER   1                               PNWRA            =    0.0 

*** mmmmmmm

***+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
***  MARTIS RESERVOIR RELEASES- SOP
***+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

*****************************************************************************
***  MARTIS RESERVOIR UNCONTROLLED SPILLS
*****************************************************************************
***----------------------------------------------------------------------------
*** from water control manual spillway elevation is 5838.0
*** although it appears that the lake elevation doesnt get this high,
*** it possibly could, so even though not written anywhere, use the 
*** following logic if the lake elevation > 5838.0 ft
***----------------------------------------------------------------------------

***  determine flood spills if above spillway elevations 
***  no spill if reno flow > 6000 cfs
***  specify martis spillway elevation = 5838.0 ft

  IF (fq <= 6000) AND (mstg > 5838.0) THEN  
    GENER   1                               MSPL             =    mifl 
    GENER   1                               MSPL           MIN    mmaxq
    *** max channel capacity - 1880 cfs from usgs gage downstream or mmaxq
  ELSE  
    GENER   1                               MSPL             =       0.0 
  END IF


********************************************************************************
*** MARTIS CREEK RESERVOIR PRECAUTIONARY DRAWDOWNS
********************************************************************************

***----------------------------------------------------------------------------
*** from SOP Flood Control Operation, if flows at reno are > 14000cfs,
***   no releases from martis
***----------------------------------------------------------------------------

  IF (fq > 14000) THEN
    GENER   1                               MSPL             =    0.0
    ***----------------------------------------------------------------------------
    *** from SOP Flood Control Operation, if flows at reno are > 6000 cfs,
    ***   releases only inflows from martis
    ***----------------------------------------------------------------------------
    ***  condition where   6,000 < fq     < 14,000
  ELSE IF (fq > 6000) THEN 
    *** release inflow (mifl  ) up to max of 1880 cfs 
    *** (channel capacity per usgs gage at martis creek) or mmaxq
    GENER   1                               MSPL             =    mifl  
    GENER   1                               MSPL           MIN    mmaxq
    ***----------------------------------------------------------------------------
    *** from SOP Flood Control Operation, if flows at reno are < 6000 cfs,
    ***   releases inflow from martis up to max of 100 cfs
    ***----------------------------------------------------------------------------
    ***  note Water Control Manual shows inactive pool at elevation = 5780.0
    ***  although tables show storage below this elevation. did not implement.
  ELSE
    *** there is a fallacy in SOP logic - how do you drain reservoir ?
    *** set release here = 100 cfs until reservoir is empty-not in decrees
    GENER   1                               MSPL             =    mifl   ***
    GENER   1                               MSPL             =    100.
    GENER   1                               MSPL           MIN    100.
  END IF   

**************************************************************************
*** MARTIS CREEK RESERVOIR  NON-FLOOD OPERATIONS
**************************************************************************

*** there are no non-flood operations for martis reservoir

***----------------------------------------------------------------------------
*** calculate total proposed martis releases
***----------------------------------------------------------------------------

  GENER   1                               MRLS             =     mspl


*** iiiiiii

***+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
***  INDEPENDENCE LAKE RELEASES - SOP
***+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

********************************************************************************
***  INDEPENDENCE LAKE UNCONTROLLED SPILLS
********************************************************************************

***----------------------------------------------------------------------------
*** from 1966 certificate of approval,must keep lake elevation below 6949.0
*** which is top of 3 ft flashboards
***----------------------------------------------------------------------------

*** if independence  lake elev > 6949.0, release inflow (iifl  ) up to max of 
*** 291 cfs (channel capacity per usgs gage at independence creek)or imaxq
*** one category here for now,  all water is counted as SPPC water
*** this will be changed when ownership is known
*** there is a human element to spills at this lake

  IF (istg   > 6949.0) THEN   
    GENER   1                               ISPL             =    iifl  
    *** for now when spilling, dump 1.5*inflows, however we need to look at actual
    *** operations, they may dump 1.5 times inflow as in donner
    GENER   1                               ISPL            *=    1.5 
    GENER   1                               ISPL           MIN    imaxq
    GENER   1                               IRLS             =    0.0
    GENER   1                               ISPRA            =       0.0 
    ***  set flag for storage = 0
    GENER   1                            2  IFLAG            =    0
  ELSE 
    GENER   1                               ISPL             =       0.0 
    GENER   1                               ISPRA            =       0.0 
    GENER   1                               IRLS             =    0.0
    ***  set flag for storage = 1
    GENER   1                            2  IFLAG            =    1
  END IF   

********************************************************************************
***  INDEPENDENCE LAKE PRECAUTIONARY DRAWDOWNS
********************************************************************************

*** there are no specific flood control diagram or drawdown schedules here, but
*** on august 15 of each year, determine lake contents, then determine 
*** schedule for precautionary drawdown so that by Nov 1 down to lake 
*** elevation of 6946.0 ft per certificate of approval (1966)

*** from observed record 1988-94, it appears that the lake is drawn down to 
*** an average storage of 14,300 ac-ft, or an elevation of 6944.7 ft 
*** which is below the legal required 15,215 ac-ft at elevation of 6946.0. 
*** This is probably due to the fact it
*** is difficult to get to independence in the winter with heavy snows, thus
*** the lake is drawn down further than the law requires.

*** the logic for the case when a storm hits between aug 15 & nov 1 is 
***  we are dumping inflows in addition to the calculated
***  amount for drawdown, so any storm would be taken care of in total 
***  drawdown releases

  IF (isto   > 14300) AND (mo_da = 8.15) THEN 
    *** calculate the lake storage above 14300 ac-ft on August 15
    GENER   1                               IWCAP            =    14300       

    GENER   1                               IVOL             =    isto       
    GENER   1                               IVOL            -=    iwcap           
  ELSE IF (mo_da = 8.15) THEN
    *** case where on Aug 15, below needed drawdown, set drawdown date = nov 1
    GENER   1                               IDAT             =    11.01        ***
  END IF

  *** re-evaluate the drawdown amount on Oct 17
  IF (isto   > 14300) AND (mo_da = 10.17) THEN
    *** calculate the lake storage above 14300 ac-ft on August 15
    GENER   1                               IVOL             =    isto       
    GENER   1                               IVOL            -=    iwcap       
    ***, dump for 15 days to reach 14,300 by nov 1
    *** varaible ivolf  is storage in cfs
    GENER   1                               IDRW             =    ivolf      
    GENER   1                               IDRW            /=    15         
  END IF


***----------------------------------------------------------------------------
*** the following logic for precautionary drawdown is empirical logic from 
*** observed record and is not in any decree
***----------------------------------------------------------------------------

***  calculate how much drawdown is needed over a time period of 75,45,or 
***  15 days on August 15
  IF (ivol  > 2400) THEN
    ***lake storage >16700 ac-ft, dump for 75 days to reach 14,300 by nov 1
    *** variable ivolf  is storage in cfs
    GENER   1         1989/08/15            IDRW             =    ivolf       1 10
    GENER   1         1989/08/15            IDRW            /=    75          1 10
    *** set starting precautionary drawdown date to Aug 18
    GENER   1                               IDAT             =    8.18  
  ELSE IF (ivol  > 1300) THEN
    *** condition where  2400 < ivol  < 1300 on August 15
    ***lake storage >15600 ac-ft, dump for 45 days to reach 14,300 by nov 1
    *** variable ivolf  is storage in cfs
    GENER   1         1989/08/15            IDRW             =    ivolf       1 10
    GENER   1         1989/08/15            IDRW            /=    45          1 10
    *** set starting precautionary drawdown date to Sep 17
    GENER   1         1989/08/15            IDAT             =    9.17        1 10
  ELSE IF (ivol  > 0) THEN
    *** condition where  1300 < ivol  < 0 on August 15
    ***lake storage <15600 ac-ft, dump for 15 days to reach 14,300 by nov 1
    *** variable ivolf  is storage in cfs
    GENER   1         1989/08/15            IDRW             =    ivolf       1 10
    GENER   1         1989/08/15            IDRW            /=    15          1 10
    *** set starting precautionary drawdown date to Oct 17
    GENER   1         1989/08/15            IDAT             =   10.17        1 10
  END IF


*** check if precautionary start drawdown situation, if so dump calculated
*** drawdown idrw  
  IF (mo_da >= idat  ) AND (mo_da < 11.01) AND (isto   > 14300) AND
     (fq     <= 6000) THEN
    *** from observed record 1988-94, it appears that the lake is drawn down to 
    *** an average storage of 14,300 ac-ft, or an elevation of 6944.7 ft 
    *** which is below the legal required 15,215 ac-ft at elevation of 6946.0. 
    *** the lake storage is 14300 ac-ft at elevation of 6944.7 ft 
    *** testing flows at farad is not in any decree
 
    *** dump precautionary drawdown calculated plus inet
    GENER   1                               IRLS             =  idrw  
    GENER   1                               IRLS            +=  inet
    GENER   1                               IRLS           MAX  0.0 
    GENER   1                               IRLS           MIN    imaxq
    ***  set flag for storage = 0
    GENER   1                            2  IFLAG            =    0
  ELSE IF (mo_da >= idat) AND (mo_da < 11.01) AND (isto < 14300) THEN
    GENER   1                               ISPRA            =     0.0 
    GENER   1                               IRLS             =     0.0 
    ***  set flag for storage = 1
    GENER   1                            2  IFLAG            =    1
  END IF

 
********************************************************************************
***  INDEPENDENCE LAKE WINTERTIME CAPACITY
********************************************************************************
***----------------------------------------------------------------------------
*** from 1966 certificate of approval, from Nov 1 to April 1 flashboards 
***   be held wide open at elevation of 6946.0 ft i.e. release inflows
*** according to figures from rick moser, 
***   in a wet year, the elevation is held at 6944 until June 1
***   and in a dry year, the elevation is held at 6946 unti June 1
*** for modeling purposes, hold at 6944.7 ft until Feb 1,
***----------------------------------------------------------------------------

***  if independence elev >= 6944.7 dump water above 6944.7 nov 1 to feb 1
*** testing floods at farad is not in any decree

  IF (fq <= 6000) AND (mo_da >= 11.01 OR mo_da <= 2.01) THEN 
    *** calculate amount needed to hold at 6944.7 (storage = 14300 ac-ft)
    GENER   1                               IWCAP            =    14300 
  END IF  

***----------------------------------------------------------------------------
*** according to fill charts from rick moser, 
***   in a wet year, the elevation is held at 6944 until June 1
***   and in a dry year, the elevation is held at 6946 unti June 1
*** for modelling purposes, on feb 2, see if wet ,average or dry year forecast,
***   then determine where to hold elevation at until June 1

  IF (fq <= 6000) AND (mo_da >= 2.02 AND mo_da <= 5.31) THEN 
    IF (frflag = 3) THEN
      *** frflag = 3 for wet year 
      *** calculate amount needed to hold at 6944.0 (storage = 13870 ac-ft)
      GENER   1                               IWCAP            =    13870
 
    ELSE IF (frflag = 1) OR (frflag = 0) THEN 
      *** frflag = 1 for dry year 
      *** calculate amount needed to hold at 6946.0 (storage = 15215 ac-ft)
      GENER   1                               IWCAP            =    15215 

    ELSE IF (frflag = 2) THEN 
      *** frflag = 2 for avg year 
      *** calculate amount needed to hold at 6945.0 (storage = 14530 ac-ft)
      GENER   1                               IWCAP            =    14530 

    END IF  
  END IF 


  IF (fq <= 6000) AND (mo_da >= 11.01 OR mo_da <= 5.31) THEN 
 *** compute amount above or below iwcap, ac-ft
      GENER   1                               IAVLV            =    isto   
      GENER   1                               IAVLV           -=    iwcap  

    IF (iavlv > 0.0) THEN 
      *** above iwcap, compute flow needed to release

      IF (inet < 0.0) THEN
      *** then release amount above iwcap
      GENER   1                               IRLS             =    iavlvf 
      GENER   1                               IRLS           MIN    imaxq 

      ELSE 
      *** then release amount above iwcap + inet
      GENER   1                               IRLS             =    iavlvf 
      GENER   1                               IRLS            +=    inet
      GENER   1                               IRLS           MIN    imaxq 

      END IF 

    ELSE 
      *** below target then dont release anything at this point 
      GENER   1                               IRLS             =    0.0 
      ***  set flag for storage = 1
      GENER   1                            2  IFLAG            =    1
    END IF
 END IF  

********************************************************************************
***  INDEPENDENCE LAKE SPRINGTIME FILLING  PERIOD
******************************************************************************** 

*** for the period june1 to july 15, fill independence reservoir on the basis
***  of a wet or dry forecast schedule on basis of moser fill charts

  IF (fq <= 6000) AND (mo_da >= 6.01 AND mo_da < 7.15) THEN 
    IF (frflag = 3) THEN 
      *** frflag = 3 for wet year 
      *** set fill schedule on the basis of moser fill charts for a wet year
      ***  target date   lake elevation  lake storage
      ***  June 8        6945.              14530.
      ***  June 15       6946.5             15558.
      ***  june 23       6948.              16600.
      ***  july 15       6949.              17300.
      IF (mo_da < 6.08) THEN 
        *** calculate amount needed to hold at 6945.0 (storage = 14530 ac-ft)
        GENER   1                               IWCAP            =    14530.0 
        ***compute how many days from today to june 8 
        GENER   1                               DAYS             =    jjun8 

      ELSE IF (mo_da < 6.15)  THEN 
        *** calculate amount needed to hold at 6946.5 (storage = 15558 ac-ft)
        GENER   1                               IWCAP            =    15558.0 
        ***compute how many days from today to june15 
        GENER   1                               DAYS             =    jjun15 

      ELSE IF (mo_da < 6.23)  THEN 
        *** calculate amount needed to hold at 6948.0 (storage = 16600 ac-ft)
        GENER   1                               IWCAP            =    16600.0 
        ***compute how many days from today to june23 
        GENER   1                               DAYS             =    jjun23 
      END IF 
    ELSE IF (frflag = 1) OR (frflag = 0) THEN 
      *** frflag = 1 for dry year or drought year
      *** set fill schedule on the basis of moser fill charts for a dry year
      ***  target date   lake elevation lake storage 
      ***  June 8        6947.            15900.
      ***  June 15       6948.0           16600.
      ***  june 23       6948.5           16950.
      ***  july 15       6949.            17300.
      IF (mo_da < 6.08) THEN 
        *** calculate amount needed to hold at 6947.0 (storage = 15900 ac-ft)
        GENER   1                               IWCAP            =    15900.0 
        ***compute how many days from today to june 8 
        GENER   1                               DAYS             =    jjun8 
      ELSE IF (mo_da < 6.15)  THEN 
        *** calculate amount needed to hold at 6948.0 (storage = 16600 ac-ft)
        GENER   1                               IWCAP            =    16600.0 
        ***compute how many days from today to june15 
        GENER   1                               DAYS             =    jjun15 
      ELSE IF (mo_da < 6.23)  THEN 
        *** calculate amount needed to hold at 6948.5 (storage = 16950 ac-ft)
        GENER   1                               IWCAP            =    16950.0 
        ***compute how many days from today to june23 
        GENER   1                               DAYS             =    jjun23 
      END IF 
    ELSE IF (frflag = 2) THEN
      *** frflag = 2 for avg year 
      *** set fill schedule on the basis of moser fill charts for a avg year
      *** (the average of a wet and dry curve)
      ***  target date   lake elevation lake storage 
      ***  June 8        6946.            15215.
      ***  June 15       6947.5           16250.
      ***  june 23       6948.5           16950.
      ***  july 15       6949.            17300.
      IF (mo_da < 6.08) THEN 
        *** calculate amount needed to hold at 6946.0 (storage = 15215 ac-ft)
        GENER   1                               IWCAP            =    15215.0 
        ***compute how many days from today to june 8 
        GENER   1                               DAYS             =    jjun8 
      ELSE IF (mo_da < 6.15)  THEN 
        *** calculate amount needed to hold at 6947.5 (storage = 16250 ac-ft)
        GENER   1                               IWCAP            =    16250.0 
        ***compute how many days from today to june15 
        GENER   1                               DAYS             =    jjun15 
      ELSE IF (mo_da < 6.23)  THEN 
        *** calculate amount needed to hold at 6948.5 (storage = 16950 ac-ft)
        GENER   1                               IWCAP            =    16950.0 
        ***compute how many days from today to june23 
        GENER   1                               DAYS             =    jjun23 
      END IF 
    END IF  
    IF (mo_da >= 6.23) AND (mo_da < 7.15) THEN 
      *** calculate amount needed to hold at 6949.0 (storage = 17300 ac-ft)
      GENER   1                               IWCAP            =    17300.0 
      ***compute how many days from today to july15 
      GENER   1                               DAYS             =    jjul15 
    END IF


  *** determine imax storage
    *** calculate amount needed to hold at iwcap storage ac-ft
    GENER   1                               IAVLV            =    iwcap 
    GENER   1                               IAVLV           -=    isto 
    GENER   1                               IAVLV          MAX   0.0  
    ***compute how many days from today to target date
    GENER   1                               DAYS            -=    jul_da 
    ***Calculate daily storage for XX days from today to target date
    GENER   1                               IMAX             =    iavlvf 
    GENER   1                               IMAX            /=    days 
    GENER   1                               IMAX           MAX    0.0 

  END IF 
 
***----------------------------------------------------------------------------
*** calculate total independence releases
***----------------------------------------------------------------------------

  GENER   1                               IOFL             =    irls  
  GENER   1                               IOFL            +=    ispl  
*** linking variable irls 
  GENER   1                               IRLS             =    iofl
  GENER   1                               IRLST            =    0.0 
  GENER   1                               INWRA            =    0.0

**************************************************************************
*** INDEPENDENCE LAKE NON-FLOOD OPERATIONS
**************************************************************************

*** if independence lake elevation below flood stage of 6949.0 
*** for now, in order to have releases from indep all the time, use idmd  
*** for the non-flood period of june 1 to Aug 18

  IF (istg   < 6949.0) AND (mo_da > 7.15) AND (mo_da < 8.18) THEN
    GENER   1                               INWRA            =    idmd   
    ***  check to see if water is available in the nw category
    GENER   1                               INWRA          MIN    inwvf
    GENER   1                               INWRA          MIN    imaxq
    GENER   1                               IRLS             =    0.0
    ***  set flag for storage = 1
    GENER   1                            2  IFLAG            =    0
  END IF

***----------------------------------------------------------------------------
*** calculate total proposed independence releases
***----------------------------------------------------------------------------

  GENER   1                               IRLST            =    inwra 

 
*** ssssss

***+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
***  STAMPEDE RESERVOIR RELEASES - SOP
***+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

**************************************************************************
***  STAMPEDE RESERVOIR - SPILL SITUATION
**************************************************************************

*** inflow to stampede (ac-ft) stotv = ssto + siflv
  GENER   1                               STOTV            =   ssto
  GENER   1                               STOTV           +=  siflv 

  IF (sstg > 5948.7) THEN
    ***---------------------------------------------------------------------
    *** Stampede Reservoir uncontrolled spills.
    *** From SOP Flood Control Operation, if stage > 5948.7 (226500 ac-ft) then
    *** use emergency spillway diagram regardless of flows at reno
    ***---------------------------------------------------------------------
    *** set spill
    GENER   1                               SSPL             =    smaxq 
    GENER   1                            2  SFLAG            =    0
  ELSE IF (stotv >= 226500.0) THEN
    ***Stampede storage is projected to exceed volume at spill height
    ***(226500 ac-ft), so make a pre-cautionary drawdown.
    ***NOTE: This check is pretty crude for now. We need something
    ***better for later. Check for 2-5 days in advance.
    GENER   1                               SSPL             =    0.0
    *** sdrw = smaxq  for gates
    GENER   1                               SDRW             =    smaxq
    GENER   1                            2  SFLAG            =    0
  ELSE
    IF (fq >= 6000.0) THEN
      ***Stampede stage is low, but Reno is flooding, so store Stampede inflow.
      GENER   1                               SSPL             =    0
      ***sdrw = (either 0 or some value to prevent spill and dam damage.)
      GENER   1                               SDRW             =    0.0
      ***Set flag for storage.
      GENER   1                            2  SFLAG            =    1
    ELSE
      ***Stampede stage is low and Reno is not flooding, so store and release
      ***to meet SOPs.
      ***Set initial conditions for SOP variables. These settings will be
      ***used through remainder of Special Actions block unless reset
      ***for Standing Operating Proceedures (SOP).
      GENER   1                               SDRW             =    0.0
      GENER   1                               SSPL             =    0.0
      GENER   1                            2  SFLAG            =    1

      ***Now evaluate for each time period and determine if drawdown is
      ***required.

      **********************************************************************
      ***  STAMPEDE RESERVOIR PRECAUTIONARY DRAWDOWNS
      **********************************************************************
      ***-------------------------------------------------------------------
      *** October SOP operation.
      *** From SOP Flood Control Operation, if flows at reno are < 6000 cfs,
      *** must drop lake elevation to 5942.1 or 22,000 ac-ft flood storage
      *** by Nov 1. This happens from Oct 1 to Nov 1
      ***
      ***-------------------------------------------------------------------
      IF ( (mo_da >= 10.01) AND (mo_da <= 10.31) AND (ssto >= 204576.0) ) THEN
        ***If stampede storage > 204576.0 on oct 1, calculate amount of release
        ***Calculate flow for every day between oct 1 to nov 1 .
        ***For now, calculation is a simple linear reduction over the month
        ***as limited by the outflow capacity (smaxq).
        ***
        ***NEEDS WORK: for later revision, include logic that will consider
        ***concurrent drawdown rate of Stampede, whether drawdown should be
        ***earlier in year because of smaxq limitation, and maybe consider
        ***recreational interests.
        ***Compute how many days from today to nov 1
        GENER   1                               DAYS             =    jnov1
        GENER   1                               DAYS            -=    jul_da
        ***Calculate amount needed to drop to 204576 ac-ft storage
        GENER   1                               SDIFV            =    ssto
        GENER   1                               SDIFV           -=   204576.0
        ***Calculate daily storage drawdown from today to nov 1
        GENER   1                               SDRW             =    sdifvf
        GENER   1                               SDRW            /=    days
        *** add net inflows
        GENER   1                               SDRW            +=    snet
        ***Make sure spill is not negative
        GENER   1                               SDRW           MAX    0.0
        ***Limit proposed drawdown by outflow capacity
        ***This needs to be done now so that later routines (eg. floadjust)
        ***have a realistic value.
        GENER   1                               SDRW           MIN    smaxq 
        ***Set flag for no no storage.
        GENER   1                            2  SFLAG            =    0
      END IF
      ********************************************************************************
      ***  STAMPEDE LAKE WINTERTIME CAPACITY
      ********************************************************************************

      ***------------------------------------------------------------------
      ***November through Spring SOP operation (Nov.1 - April 9 or May 31).
      ***from SOP Flood Control Operation, from Nov 1 to April 10 gates
      ***shall be held wide open at elevation of 5942.1 ft i.e. release net
      ***inflows to maintain 22,000 ac-ft storage
      ***if dry year hold elevation until apr 10, wdflag = 0 for dry year
      ***if wet year hold elevation until june 1, wdflag = 1 for wet year
      ***-------------------------------------------------------------------

      ***&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&
      ***  if DRY year hold elevation until apr 10, wdflag = 0 for dry year
      ***  if stampede elev > 5942.1 dump above 5942.1 nov 1 to apr 10
      ***&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&
      ***  if WET year hold elevation until june 1, wdflag = 1 for WET year
      ***  if stampede elev > 5942.1 dump above 5942.1 nov 1 to jun 1
      ***&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&

      IF ((((mo_da >= 11.01) OR (mo_da <= 4.09)) AND (wdflag = 0)) OR
         (((mo_da >= 11.01) OR (mo_da <= 5.31)) AND (wdflag = 1)) AND
           (ssto > 204576.0) ) THEN
        ***calculate amount needed to hold at 5942.1 (storage = 204576 ac-ft)
        GENER   1                               SDIFV            =    ssto
        GENER   1                               SDIFV           -=   204576.0
        ***add in todays trib inflow in ac-ft, siflv
        GENER   1                               SDIFV           +=    siflv
        IF (sdifv > 0.0) THEN
          *** check to see if storage > 204576.0 and flow available to release
          *** there is no max channel capacity due to emer spillway
          *** requirements
          GENER   1                               SDRW             =    sdifvf
          ***Make sure spill is not negative
          GENER   1                               SDRW           MAX    0.0
          ***Limit proposed drawdown by outflow capacity
          GENER   1                               SDRW           MIN    smaxq  
          ***Set flag for no storage.
          GENER   1                            2  SFLAG            =    0
        END IF
      END IF
      **********************************************************************
      ***  STAMPEDE RESERVOIR SPRINGTIME RESERVOIR FILLING
      **********************************************************************
      ***------------------------------------------------------------------
      ***from SOP Flood Control Operation, from Apr 10 to May 19 gates shall
      ***be adjusted to fill reservoir , in a DRY year.
      ***extreme simplification of adding 22,000 ac-ft at 278 cfs/day for 40
      ***days to arrive at elevation of 5948.7 or calculate smax every
      ***10 days
      ***-------------------------------------------------------------------
      ***from SOP Flood Control Operation, from June 1 to July 4 gates shall
      ***be adjusted to fill reservoir, in WET year. extreme simplification
      ***of adding 22,000 ac-ft at 317 cfs/day for 35 days to elevation of
      ***5948.7
      ***-------------------------------------------------------------------

      ***smax - max allowable increase in storage to fill to 0 flood storage
      ***calc amount need to hold to arrive at 5948.7 (storage= 226500 ac-ft)
      IF ( ((mo_da >= 4.10) AND (mo_da <= 5.19) AND (wdflag = 0)) OR
           ((mo_da >= 6.01) AND (mo_da <= 7.04) AND (wdflag = 1)) ) THEN
        GENER   1                               SDIFV            =   226500.0
        GENER   1                               SDIFV           -=    ssto
        ***Calculate flow for every day between Apr 10 and May 20
        IF (wdflag = 0) THEN
          ***julian day of may 20 = 140(use 141 so no divide by 0)
          ***compute how many days from today to may 20
          GENER   1                               DAYS             =    jmay20
          GENER   1                               DAYS            -=    jul_da
        ELSE
          ***julian day of jul 5  = 186(use 187 so no divide by 0)
          ***compute how many days from today to jul 5
          GENER   1                               DAYS             =    jjul5
          GENER   1                               DAYS            -=    jul_da
        END IF
        ***NOTE: For late revisions, use SOP filling curves. The current
        ***routine assumes a simple linear fill rate.
        ***Calculate daily storage for XX days from today to may 20
        GENER   1                               SMAX             =    sdifvf
        GENER   1                               SMAX            /=    days
        GENER   1                               SMAX           MAX    0.0
        ***For dry year, add inflows april 10 to May 20 to bring up to full
        ***pool elevation 
        ***For wet year, add inflows june 1 to July 5 to bring up to full
        ***pool elevation
        ***NOTE: this logic has a fallacy because you dont know what the inflows
        ***are going to contribute. Earlier on in april too much is spilled
        ***because inflows are higher than inflows in may. Forecasts need to
        ***be used here.
        ***Set flag for storage.
        GENER   1                            2  SFLAG            =    1
      END IF
    END IF
  END IF 
     ***-----------------------------------------------------------------------
     *** calculate total stampede release and outflow
     *** At this point, drawdown is the only release
     ***-----------------------------------------------------------------------
  GENER   1                               SRLS             =    sdrw
  GENER   1                               SOFL             =    srls
  GENER   1                               SOFL            +=    sspl
  GENER   1                               SRLS             =    sofl
  GENER   1                               SRLST            =    0.0 

**************************************************************************
*** STAMPEDE RESERVOIR NON-FLOOD OPERATIONS
**************************************************************************
***----------------------------------------------------------------------------
*** for the time being to run model,
*** dump from stampede as specified in observed demand as variable sdmd  
***----------------------------------------------------------------------------

  IF ( ((mo_da >= 5.20) AND (mo_da <= 8.00) AND (wdflag = 0)) OR
       ((mo_da >= 7.05) AND (mo_da <= 8.00) AND (wdflag = 1)) ) THEN
    ***  split categories to 50% for SPPC and 50% for PYR
    *** this will be changed when ownership is known
    GENER   1                               SSPRA            =    sdmd   
    GENER   1                               SSPRA          MIN    smaxq
    GENER   1                               SSPRA          MIN    sspvf
    GENER   1                               SSPRA           *=    0.5   
    *** this is to split flows 50-50 using x and 1-x logic
    GENER   1                               SFSRA            =    sdmd  
    GENER   1                               SFSRA           -=    sspra 
    ***  set flag for storage = 1
    GENER   1                            2  SFLAG            =    1
  END IF 

***----------------------------------------------------------------------------
*** calculate total stampede releases
***----------------------------------------------------------------------------

  GENER   1                               SNWRA            =    0.0
  GENER   1                               SFSRA            =    0.0
  GENER   1                               SSPRA            =    0.0
  GENER   1                               SRLST            =    sspra 
  GENER   1                               SRLST           +=    sfsra 

*** bbbbbbb

***+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
***  BOCA RESERVOIR RELEASES - SOP
***+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

***    SUBROUTINE SOPCAP

*** NOTES **************************************************************

*** GENERAL NOTES:
*** Because of rating shifts, it is better to use storage instead
*** of stage for all reservoirs except for Tahoe. The agreements usually
*** specify volumes instead of stage.
***
*** Drawdown must be limited by channel capacity

**************************************************************************
***  BOCA RESERVOIR - SPILL SITUATION
**************************************************************************

  IF (bstg > 5605.0) THEN
    ***---------------------------------------------------------------------
    *** Boca Reservoir uncontrolled spills.
    *** From SOP Flood Control Operation, if stage > 5605.0 (40868 ac-ft) then
    *** use emergency spillway diagram regardless of flows at reno
    ***---------------------------------------------------------------------
    *** set spill
    GENER   1                               BSPL             =    bmaxq
    GENER   1                               BDRW             =    0.0
    GENER   1                            2  BFLAG            =    0
  ELSE IF (btotv >= 40868.0) THEN                                   
    ***Boca storage is projected to exceed volume at spill height
    ***(40868 ac-ft), so make a pre-cautionary drawdown.
    ***NOTE: This check is pretty crude for now. We need something
    ***better for later. Consider looking 2-5 days in advance.
    GENER   1                               BSPL             =    0.0    
    *** bdrw = bmaxq for gates
    GENER   1                               BDRW             =    bmaxq   
    GENER   1                            2  BFLAG            =    0     
  ELSE
    IF (fq >= 6000.0) THEN
      ***Boca stage is low, but Reno is flooding, so store Boca inflow.
      GENER   1                               BSPL             =    0
      ***bdrw = (either 0 or some value to prevent spill and dam damage.)
      GENER   1                               BDRW             =    0.0
      ***Set flag for storage.
      GENER   1                            2  BFLAG            =    1
    ELSE
      ***Boca stage is low and Reno is not flooding, so store and release
      ***to meet SOPs.
      ***Set initial conditions for SOP variables. These settings will be
      ***used through remainder of Special Actions block unless reset
      ***for Standing Operating Proceedures (SOP).
      GENER   1                               BDRW             =    0.0
      GENER   1                               BSPL             =    0.0
      GENER   1                            2  BFLAG            =    1

      ***Now evaluate for each time period and determine if drawdown is
      ***required.

      **********************************************************************
      ***  BOCA RESERVOIR PRECAUTIONARY DRAWDOWNS
      **********************************************************************
      ***-------------------------------------------------------------------
      *** October SOP operation.
      *** From SOP Flood Control Operation, if flows at reno are < 6000 cfs,
      *** must drop lake elevation to 5596.4 or 8,000 ac-ft flood storage
      *** by Nov 1. This happens from Oct 1 to Nov 1
      ***
      ***-------------------------------------------------------------------

      IF ( (mo_da >= 10.01) AND (mo_da <= 10.31) AND (bsto >= 32800.0) ) THEN
        ***If boca storage > 32800.0 on oct 1, calculate amount of release
        ***Calculate flow for every day between oct 1 to nov 1 .
        ***For now, calculation is a simple linear reduction over the month
        ***as limited by the outflow capacity (bmaxq).
        ***
        ***NEEDS WORK: for later revision, include logic that will consider
        ***concurrent drawdown rate of Prosser, whether drawdown should be
        ***earlier in year because of bmaxq limitation, and maybe consider
        ***recreational interests.
        ***Compute how many days from today to nov 1
        GENER   1                               DAYS             =    jnov1
        GENER   1                               DAYS            -=    jul_da
        ***Calculate amount needed to drop to 32800 ac-ft storage
        GENER   1                               BDIFV            =    bsto     
        GENER   1                               BDIFV           -=    32800.0
        ***Calculate daily storage drawdown from today to nov 1
        GENER   1                               BDRW             =    bdifvf
        GENER   1                               BDRW            /=    days
        *** add inflows
        GENER   1                               BDRW            +=   srlst
        GENER   1                               BDRW            +=   blfl 
        ***Make sure spill is not negative
        GENER   1                               BDRW           MAX    0.0
        ***Limit proposed drawdown by outflow capacity
        ***This needs to be done now so that later routines (eg. floadjust)
        ***have a realistic value.
        GENER   1                               BDRW           MIN    bmaxq
        ***Set flag for no no storage.
        GENER   1                            2  BFLAG            =    0
      END IF

      ********************************************************************************
      ***  BOCA WINTERTIME CAPACITY
      ********************************************************************************

      ***------------------------------------------------------------------
      ***November through Spring SOP operation (Nov.1 - April 9 or May 31).
      ***from SOP Flood Control Operation, from Nov 1 to April 10 gates
      ***shall be held wide open at elevation of 5596.4 ft i.e. release net
      ***inflows to maintain 8,000 ac-ft storage
      ***if dry year hold elevation until apr 10, wdflag = 0 for dry year
      ***if wet year hold elevation until june 1, wdflag = 1 for wet year
      ***-------------------------------------------------------------------

      ***&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&
      ***  if DRY year hold elevation until apr 10, wdflag = 0 for dry year
      ***  if boca elev > 5596.4 dump above 5596.4 nov 1 to apr 10
      ***&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&
      ***  if WET year hold elevation until june 1, wdflag = 1 for WET year
      ***  if boca elev > 5596.4 dump above 5596.4 nov 1 to jun 1
      ***&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&

      IF [(((mo_da >= 11.01) OR (mo_da <= 4.09)) AND (wdflag = 0)) OR
          (((mo_da >= 11.01) OR (mo_da <= 5.31)) AND (wdflag = 1)) AND
            (bsto > 32800.0)] THEN
        ***calculate amount needed to hold at 5596.4 (storage = 32800 ac-ft)
        GENER   1                               BDIFV            =    bsto
        GENER   1                               BDIFV           -=    32800.0
        ***add in todays inflow from stampede in ac-ft ,soflv
        ***NOTE: I'm unclear why inflows are added to the storage diff.
        GENER   1                               BDIFV           +=    soflv
        ***add in todays trib inflow in ac-ft, blflv
        GENER   1                               BDIFV           +=    blflv
        ***NOTE: This check may be unneeded provided soflv and blflv are>0.
        IF (bdifv > 0.0) THEN
          *** check to see if storage > 32800 and flow available to release
          GENER   1                               BDRW             =    bdifvf
          ***Make sure spill is not negative
          GENER   1                               BDRW           MAX    0.0
          ***Limit proposed drawdown by outflow capacity
          GENER   1                               BDRW           MIN    bmaxq 
          ***Set flag for no storage.
          GENER   1                            2  BFLAG            =    0
        END IF 
      END IF

      **********************************************************************
      ***  BOCA RESERVOIR SPRINGTIME RESERVOIR FILLING
      **********************************************************************
      ***------------------------------------------------------------------
      ***from SOP Flood Control Operation, from Apr 10 to May 19 gates shall
      ***be adjusted to fill reservoir , in a DRY year.
      ***extreme simplification of adding 8,000 ac-ft at 101 cfs/day for 40
      ***days to arrive at elevation of 5605.0 or calculate bmax every
      ***10 days
      ***-------------------------------------------------------------------
      ***from SOP Flood Control Operation, from June 1 to July 4 gates shall
      ***be adjusted to fill reservoir, in WET year. extreme simplification
      ***of adding 8,000 ac-ft at 115 cfs/day for 35 days to elevation of
      ***5605.0
      ***-------------------------------------------------------------------

      ***bmax - max allowable increase in storage to fill to 0 flood storage
      ***calc amount need to hold to arrive at 5605.0 (storage=40868 ac-ft)

      IF ( ((mo_da >= 4.10) AND (mo_da <= 5.19) AND (wdflag = 0)) OR
           ((mo_da >= 6.01) AND (mo_da <= 7.04) AND (wdflag = 1)) ) THEN
        GENER   1                               BDIFV            =    40868.0
        GENER   1                               BDIFV           -=    bsto
        ***Calculate flow for every day between Apr 10 and May 20
        IF (wdflag = 0) THEN
          ***julian day of may 20 = 140(use 141 so no divide by 0)
          ***compute how many days from today to may 20
          GENER   1                               DAYS             =    jmay20
          GENER   1                               DAYS            -=    jul_da
        ELSE
          ***julian day of jul 5  = 186(use 187 so no divide by 0)
          ***compute how many days from today to jul 5
          GENER   1                               DAYS             =    jjul5
          GENER   1                               DAYS            -=    jul_da
        END IF
        ***NOTE: For late revisions, use SOP filling curves. The current
        ***routine assumes a simple linear fill rate.
        ***Calculate daily storage for XX days from today to may 20
        GENER   1                               BMAX             =    bdifvf
        GENER   1                               BMAX            /=    days
        GENER   1                               BMAX           MAX    0.0
        ***For dry year, add inflows april 10 to May 20 to bring up to full
        ***pool elevation 
        ***For wet year, add inflows june 1 to July 5 to bring up to full
        ***pool elevation
        ***NOTE: this logic has a fallacy because you dont know what the inflows
        ***are going to contribute. Earlier on in april too much is spilled
        ***because inflows are higher than inflows in may. Forecasts need to
        ***be used here.
        ***Set flag for storage.
        GENER   1                            2  BFLAG            =    1
      END IF
    END IF
  END IF 

  ***-----------------------------------------------------------------------
  *** calculate total boca release and outflow
  *** At this point, drawdown is the only release
  ***-----------------------------------------------------------------------

  GENER   1                               BRLS             =    bdrw
  GENER   1                               BOFL             =    bspl
  GENER   1                               BOFL            +=    brls
  GENER   1                               BRLS             =    bofl
  GENER   1                               BNWRA            =    0.0 
  GENER   1                               BSPRA            =    0.0
  GENER   1                               BFSRA            =    0.0



***==========================================================================
***     4. Determine proposed release for meeting Floriston Rates
***==========================================================================

*** florflorflor

***--------------------------------------------------------------------------
***Determine initial Farad need or Farad excess flow
***--------------------------------------------------------------------------
  GENER   1                               FADJ             =    fq
  GENER   1                               FADJ            -=    flrate
  IF (fadj < 0.0) THEN
    GENER   1                               FNEED          ABS    fadj
  ELSE
    GENER   1                               FEXCES           =    fadj
  END IF


*******************************************************************
***Make adjustments for irrigation season during recreation period.
***Assume that Sept. 3 is Labor Day
*******************************************************************
  IF ( (mo_da >= 4.01) AND (mo_da <= 9.03) ) THEN

    ***-------------------------------------------------------------***
    ***  Initialize Prosser variables active only during the
    ***  recreation season (April 1 - September 3).
    ***  Assumes that Tahoe-Exchange-Water is released first to make
    ***    Floriston rates if needed.
    ***-------------------------------------------------------------***

    *** check to see if reservoir storage above or below precv
    IF (pvol > precv) THEN
      GENER   1                               PVOLN            =    pvol
      GENER   1                               PVOLN           -=    precv
      *** reservoir storage is above recreation level , precv. Add 2 categories
      ***  together puwv + pnwv = puwvt
      GENER   1                               PUWVT            =    puwv
      GENER   1                               PUWVT           +=    pnwv
      *** check to see if puwvt = pu + nw categories above precv
      IF (puwvt > precv) THEN 
        *** puwvt > precv, so only non recreational exchange water available
        ***  ptxv_n: Prosser non-recreation exchange volume above 19,000 ac-ft 
        ***  ptxv_r: Prosser recreation exchange volume equal to or less 
        ***    than 19,000 ac-ft
        GENER   1                               PTXV_N           =    ptxv 
        GENER   1                               PTXV_R           =    0.0  
      ELSE
        *** puwvt < precv, so both recreational and non-recreational water avaialble
        ***  determine volume of each. first calculate non-recreational volume 
        ***  above precv
        GENER   1                               PTXV_N           =    pvoln
        *** next determine recreation volume left in tx categoryby subtracting
        ***  non recreation from total tx
        GENER   1                               PTXV_R           =    ptxv
        GENER   1                               PTXV_R          -=    ptxv_n
      END IF
    ELSE 
      *** reservoir storage is below recreation level, so only recreational 
      ***  water available
      GENER   1                               PTXV_N           =    0.0 
      GENER   1                               PTXV_R           =    ptxv
    END IF
  END IF

*******************************************************************
***    WATER SWAP
***    Compute sum of all reservoir releases for adjustments of
***    releases.
***    If Tahoe is below rim, make no Tahoe release and maximize
***    Prosser and Boca releases.
***    Make Prosser/Boca water swap.
***    If Tahoe is above rim, make Tahoe/Prosser/Boca water swap.
***    Between Sept 4 and March 31, there are no Prosser recreational
***    categories.
***
***    NOTE: the comparison with channel capacity (xmaxq) may
***    not necessarily be the same in HSPF
*******************************************************************
  GENER   1                               SUMRSF           =    prlsf 
  GENER   1                               SUMRSF          +=    brlsf
  IF (tstg > 6223.0) THEN
    GENER   1                               SUMRSF          +=    trlsf
  END IF

***INTITIAL CONDITIONS GENERS
*** GENER 101 - TAHOE POOLED WATER RELEASE
*** GENER 301 - PROSSER EXCHANGE WATER RELEASE
*** GENER 310 - PROSSER EXCHANGE WATER VOLUME 
*** GENER 601 - BOCA ADVERSE TO CANAL RELEASE
*** GENER 610 - BOCA ADVERSE TO CANAL VOLUME  
*** GENER 602 - BOCA NONADVERSE TO CANAL RELEASE
*** GENER 611 - BOCA NONADVERSE TO CANAL VOLUME
*** GENER 901 - RESERVOIR SUM RELEASE
*** GENER 902 - FARAD ADJUSTMENT

  GENER 101                               K       1        =    tpwrb 
  GENER 301                               K       1        =    ptxrb 
  GENER 310                               K       1        =    ptxv  
  GENER 601                               K       1        =    bacrb 
  GENER 610                               K       1        =    bacv  
  GENER 602                               K       1        =    bncrb 
  GENER 611                               K       1        =    bncv  
  GENER 901                               K       1        =    sumrsf
  GENER 902                               K       1        =    fadj  

  IF (sumrsf > 0.0) THEN
    IF ((mo_da >= 4.01) AND (mo_da <= 10.31)) THEN
      *** Recreation and non-recreation seasons
      IF ((tstg > 6223.0) AND (tstg <= 6225.5)) THEN
        GENER   1                               TPWRA            =    sumrsf
        GENER   1                               TPWRA          MIN    tpwvf
        GENER   1                               TPWRA          MIN    tmaxq
        GENER   1                               SUMRSF           =    sumrsf
        GENER   1                               SUMRSF          -=    tpwra
      ELSE
        GENER   1                               TPWRA            =    0.0
      END IF
    ELSE
      *** Non-irrigation season
      IF (tstg > 6223.0) THEN
        GENER   1                               TPWRA            =    sumrsf
        GENER   1                               TPWRA          MIN    tpwvf
        GENER   1                               TPWRA          MIN    tmaxq
        GENER   1                               SUMRSF           =    sumrsf
        GENER   1                               SUMRSF          -=    tpwra
      ELSE
        GENER   1                               TPWRA            =    0.0
      END IF
    END IF
  END IF

  IF ((mo_da >= 4.01) AND (mo_da <= 9.03 )) THEN
    *** Recreation season
    IF (sumrsf > 0.0) THEN
      GENER   1                               PTXR_N           =    sumrsf
      GENER   1                               PTXR_N         MIN    ptxvfn
      GENER   1                               PTXR_N         MIN    pmaxq
      GENER   1                               SUMRSF           =    sumrsf
      GENER   1                               SUMRSF          -=    ptxr_n
    ELSE
      GENER   1                               PTXR_N           =    0.0
    END IF
  ELSE
    *** Non-irrigation and non-recreation seasons
    IF (sumrsf > 0.0) THEN
      GENER   1                               PTXRA            =    sumrsf
      GENER   1                               PTXRA          MIN    ptxvf
      GENER   1                               PTXRA          MIN    pmaxq
      GENER   1                               SUMRSF           =    sumrsf
      GENER   1                               SUMRSF          -=    ptxra
    ELSE
      GENER   1                               PTXRA            =    0.0
    END IF
  END IF

  IF (sumrsf > 0.0) THEN
    GENER   1                               BACRA            =    sumrsf
    GENER   1                               BACRA          MIN    bacvf
    GENER   1                               BACRA          MIN    bmaxq
    GENER   1                               SUMRSF           =    sumrsf
    GENER   1                               SUMRSF          -=    bacra
  ELSE
    GENER   1                               BACRA            =    0.0
  END IF

  IF (sumrsf > 0.0) THEN
    GENER   1                               BNCRA            =    sumrsf
    GENER   1                               BNCRA          MIN    bncvf
    *******************************************************************
    *** bsumpw is a scratch variable of Boca sum of pooled water
    GENER   1                               BSUMPW           =    bncra
    GENER   1                               BSUMPW          +=    bacra
    *******************************************************************
    IF (bsumpw > bmaxq) THEN
      GENER   1                               BNCRA            =    bmaxq
      GENER   1                               BNCRA           -=    bacra
    END IF
    GENER   1                               SUMRSF           =    sumrsf
    GENER   1                               SUMRSF          -=    bncra
  ELSE
    GENER   1                               BNCRA            =    0.0
  END IF

  IF ((mo_da >= 4.01) AND (mo_da <= 9.03 )) THEN
    *** Recreation season
    IF (sumrsf > 0.0) THEN
      GENER   1                               PTXR_R           =    sumrsf
      GENER   1                               PTXR_R         MIN    ptxvfr
      *******************************************************************
      *** psumtx is a scratch variable of Prosser sum of exchange water
      GENER   1                               PSUMTX           =    bncra
      GENER   1                               PSUMTX          +=    bacra
      *******************************************************************
      IF (psumtx > pmaxq) THEN
        GENER   1                               PTXR_R           =    pmaxq
        GENER   1                               PTXR_R          -=    ptxr_n
      END IF
      GENER   1                               SUMRSF           =    sumrsf
      GENER   1                               SUMRSF          -=    ptxr_r
    ELSE
      GENER   1                               PTXR_R           =    0.0
    END IF
  END IF

  IF ((mo_da >= 4.01) AND (mo_da <= 10.31)) THEN
    *** Recreation and non-recreation seasons
    IF ((tstg > 6225.5) AND (tstg < 6229.1) AND
        (sumrsf > 0.0)) THEN
      GENER   1                               TPWRA            =    sumrsf
      GENER   1                               TPWRA          MIN    tpwvf
      GENER   1                               TPWRA          MIN    tmaxq
      GENER   1                               SUMRSF           =    sumrsf
      GENER   1                               SUMRSF          -=    tpwra
    END IF
  END IF

***-------------------------------------------------------------***
*** Determine total release and Pooled-Water release from reservoirs.
***-------------------------------------------------------------***

  GENER   1                               TRLSF            =    tpwra
  GENER   1 *** SNB 11/2/95               PUWRA            =    puwrb
*** gwh 10/13/95
  GENER   1    *** SNB 11/2/95            PUWRA            =    0.0  
  GENER   1     *** gwh 10/6/95           PNWRA            =    pnwrb

  IF ((mo_da >= 4.01) AND (mo_da <= 9.03 )) THEN
    *** Recreation season
    GENER   1                               PTXRA            =    ptxr_n
    GENER   1                               PTXRA           +=    ptxr_r
    GENER   1                               PRLSF            =    ptxr_n
    GENER   1                               PRLSF           +=    ptxr_r
    GENER   1        SNB 11/2/95     ***    PRLSF           +=    puwra
    GENER   1     ***GWH 9/25/95     ***    PRLSF           +=    pnwra
  ELSE
    GENER   1                               PRLSF            =    ptxra
    GENER   1        SNB 11/2/95     ***    PRLSF           +=    puwra
    GENER   1     ***GWH 9/25/95            PRLSF           +=    pnwra
  END IF

  GENER   1                               BPWRA            =    bncra
  GENER   1                               BPWRA           +=    bacra
  GENER   1     *** GWH 10/6/95           BNWRA            =    bnwrb 

  *** NEEDS WORK - specify all other categories in Boca
  GENER   1                               BRLSF            =    bncra
  GENER   1                               BRLSF           +=    bacra
  GENER   1        ***GWH 10/6/95         BRLSF           +=    bnwra


*******************************************************************
*** FARAD ADJUSTMENT
*** Readjust Farad need or Farad excess flow.  If sumrsf > 0.0, then
*** releases have been reduced due to outlet control constraints,
*** storage volume previously available for release has been depleted
*** or some other reason that won't allow all original releases to be
*** released.
*******************************************************************

  GENER   1                               FADJ             =    fadj
  GENER   1                               FADJ            -=    sumrsf
  IF (fadj < 0.0) THEN
    GENER   1                               FNEED          ABS    fadj
    GENER   1                               FEXCES           =    0.0
  ELSE
    GENER   1                               FEXCES           =    fadj
    GENER   1                               FNEED            =    0.0
  END IF


*** AFTER WATER SWAP GENERS
*** GENER 903 - SUM OF RESERVOIR RELEASES
*** GENER 904 - FLORISTON RATES
*** GENER 905 - FARAD FLOWS
*** GENER 906 - FARAD NEED
*** GENER 907 - FARAD EXCESSMENT
*** GENER 908 - FARAD ADJUSTMENT

  GENER 903                               K       1        =    sumrsf
  GENER 904                               K       1        =    flrate
  GENER 905                               K       1        =    fq
  GENER 906                               K       1        =    fneed 
  GENER 907                               K       1        =    fexces
  GENER 908                               K       1        =    fadj  
  

  IF (fneed > ftol) THEN
    ***-------------------------------------------------------------***
    *** NEED TO HAVE ADDITIONAL RELEASES
    *** IF fneed > ftol THEN not meeting Floriston rates. More water needs to
    *** be released from the reservoirs which have stored pooled water.
    ***
    *** A running calculation of additional flow needed to meet
    *** floriston rate (fneed) will be determined.
    ***
    *** Check elevation of Lake Tahoe first.
    ***
    *** For recreation and non-recreation season:
    ***   If tstg <= 6223.0, then water will be released from Boca and
    ***   Prosser depending on their volumes of given categories.
    ***
    ***   If tstg > 6223.0 and <= 6225.5, then water will be first released
    ***   from Lake Tahoe to maintain FR.  Releases from Prosser and
    ***   Boca will only be made if necessary to maintain FR.
    ***
    ***   If tstg > 6225.5 and < 6229.1, then releases from Lake Tahoe will
    ***   be reduced as low as possible by releasing from Prosser and Boca
    ***   first, and then releasing from Lake Tahoe last, only if necessary
    ***   to maintain FR.
    ***
    *** For non-irrigation season:
    ***   If tstg > 6223.0, then water will be released from Tahoe, Boca
    ***   and Prosser depending on their volumes of given categories.
    ***   Lake Tahoe storages above 6225.5 and Prosser recreational 
    ***   categories are not used for operations during this period.
    ***-------------------------------------------------------------***

    IF ((mo_da >= 4.01) AND (mo_da <= 10.31)) THEN
      *** Recreation and non-recreation seasons
      IF ((tstg > 6223.0) AND (tstg <= 6225.5)) THEN
        GENER   1                               AVLSTF           =    tpwvf
        GENER   1                               AVLSTF          -=    tpwra
        GENER   1                               AVLSTF         MAX    0.0
        GENER   1                               AVLQ             =    tmaxq
        GENER   1                               AVLQ            -=    trlsf
        GENER   1                               AVLQ           MAX    0.0
        GENER   1                               CHANGE           =    fneed
        GENER   1                               CHANGE         MIN    avlstf
        GENER   1                               CHANGE         MIN    avlq
        GENER   1                               TPWRA            =    tpwra
        GENER   1                               TPWRA           +=    change
        GENER   1                               TRLSF            =    tpwra
        GENER   1                               FNEED            =    fneed
        GENER   1                               FNEED           -=    change
      END IF
    ELSE
      *** Non-irrigation season
      IF (tstg > 6223.0) THEN
        GENER   1                               AVLSTF           =    tpwvf
        GENER   1                               AVLSTF          -=    tpwra
        GENER   1                               AVLSTF         MAX    0.0
        GENER   1                               AVLQ             =    tmaxq
        GENER   1                               AVLQ            -=    trlsf
        GENER   1                               AVLQ           MAX    0.0
        GENER   1                               CHANGE           =    fneed
        GENER   1                               CHANGE         MIN    avlstf
        GENER   1                               CHANGE         MIN    avlq
        GENER   1                               TPWRA            =    tpwra
        GENER   1                               TPWRA           +=    change
        GENER   1                               TRLSF            =    tpwra
        GENER   1                               FNEED            =    fneed
        GENER   1                               FNEED           -=    change
      END IF
    END IF

    ***-------------------------------------------------------------***
    *** For recreation season:
    ***   If more water is still needed after the above release from Lake Tahoe,
    ***   then check non-recreation Prosser Reservoir volume
    ***   (volume > 19,000 acre-feet) for available release to meet FR.
    *** For other seasons:
    ***   If more water is still needed after the above release from Lake Tahoe,
    ***   then check Prosser Reservoir regardless of lake level for
    ***   more pooled (exchange) water release to meet FR.
    ***
    *** Add minimum of fneed and ptxvfn for prosser release, ptxr_n, to
    *** yesterdays release.
    ***-------------------------------------------------------------***
    IF ((mo_da >= 4.01) AND (mo_da <= 9.03 )) THEN
      *** Recreation season
      IF ((fneed > 0.0) AND (ptxv_n > 0.0)) THEN
        GENER   1                               AVLSTF           =    ptxvfn
        GENER   1                               AVLSTF          -=    ptxr_n
        GENER   1                               AVLSTF         MAX    0.0
        GENER   1                               AVLQ             =    pmaxq
        GENER   1                               AVLQ            -=    prlsf
        GENER   1                               AVLQ           MAX    0.0
        GENER   1                               CHANGE           =    fneed
        GENER   1                               CHANGE         MIN    avlstf
        GENER   1                               CHANGE         MIN    avlq
        GENER   1                               PTXR_N           =    ptxr_n
        GENER   1                               PTXR_N          +=    change
        GENER   1                               PTXRA            =    ptxr_n
        GENER   1                               PTXRA           +=    ptxr_r
        GENER   1                               PRLSF            =    ptxra
        GENER   1                               FNEED            =    fneed
        GENER   1                               FNEED           -=    change
      END IF
    ELSE
      *** Non-irrigation and non-recreation seasons
      IF ((fneed > 0.0) AND (ptxv > 0.0)) THEN
        GENER   1                               AVLSTF           =    ptxvf
        GENER   1                               AVLSTF          -=    ptxra
        GENER   1                               AVLSTF         MAX    0.0
        GENER   1                               AVLQ             =    pmaxq
        GENER   1                               AVLQ            -=    prlsf
        GENER   1                               AVLQ           MAX    0.0
        GENER   1                               CHANGE           =    fneed
        GENER   1                               CHANGE         MIN    avlstf
        GENER   1                               CHANGE         MIN    avlq
        GENER   1                               PTXRA            =    ptxra
        GENER   1                               PTXRA           +=    change
        GENER   1                               PRLSF            =    ptxra
        GENER   1                               FNEED            =    fneed
        GENER   1                               FNEED           -=    change
      END IF
    END IF

    ***-------------------------------------------------------------***
    *** If more water is still needed after the above release from Prosser
    *** Reservoir, then check Boca SSW (supplemental storage water which
    *** is synonymous with adverse-to-canal volume).  SSW is the first 
    *** 25,000 acre-feet stored in Boca each year.
    ***
    ***  Add minimum of fneed and bacvf for boca release, bacra to yesterdays
    ***  release:
    ***-------------------------------------------------------------***
    IF ((fneed > 0.0) AND (bacv > 0.0)) THEN
      GENER   1                               AVLSTF           =    bacvf
      GENER   1                               AVLSTF          -=    bacra
      GENER   1                               AVLSTF         MAX    0.0
      GENER   1                               AVLQ             =    bmaxq
      GENER   1                               AVLQ            -=    brlsf
      GENER   1                               AVLQ           MAX    0.0
      GENER   1                               CHANGE           =    fneed
      GENER   1                               CHANGE         MIN    avlstf
      GENER   1                               CHANGE         MIN    avlq
      GENER   1                               BACRA            =    bacra
      GENER   1                               BACRA           +=    change
      GENER   1                               BRLSF            =    bncra
      GENER   1                               BRLSF           +=    bacra
      GENER   1                               FNEED            =    fneed
      GENER   1                               FNEED           -=    change
    END IF

    ***-------------------------------------------------------------***
    *** If more water is still needed after the above release from Boca
    *** Reservoir, then check boca ASSW (additional supplemental storage
    *** water which is synonymous with nonadverse to Canal volume) third.
    *** ASSW is the volume of pooled water stored after the first 25,000 
    *** acre-feet in Boca.
    ***
    *** Add minimum of fneed and bncvf for boca release, bncra to yesterdays
    *** release.
    ***-------------------------------------------------------------***
    IF ((fneed > 0.0) AND (bncv > 0.0)) THEN
      GENER   1                               AVLSTF           =    bncvf
      GENER   1                               AVLSTF          -=    bncra
      GENER   1                               AVLSTF         MAX    0.0
      GENER   1                               AVLQ             =    bmaxq
      GENER   1                               AVLQ            -=    brlsf
      GENER   1                               AVLQ           MAX    0.0
      GENER   1                               CHANGE           =    fneed
      GENER   1                               CHANGE         MIN    avlstf
      GENER   1                               CHANGE         MIN    avlq
      GENER   1                               BNCRA            =    bncra
      GENER   1                               BNCRA           +=    change
      GENER   1                               BRLSF            =    bncra
      GENER   1                               BRLSF           +=    bacra
      GENER   1                               FNEED            =    fneed
      GENER   1                               FNEED           -=    change
    END IF

    ***-------------------------------------------------------------***
    *** For recreation season:
    *** If more water is still needed after the above release of Boca
    *** Reservoir ASSW, then check Prosser Reservoir recreation volume
    *** for more exchange water available for release to meet FR.
    ***
    *** Add minimum of fneed and ptxvfr for prosser release, ptxr_r, to
    *** yesterday's release
    ***-------------------------------------------------------------***
    IF ((mo_da >= 4.01) AND (mo_da <= 9.03 )) THEN
      *** Recreation season
      IF ((fneed > 0.0) AND (ptxv_r > 0.0)) THEN
        GENER   1                               AVLSTF           =    ptxvfr
        GENER   1                               AVLSTF          -=    ptxr_r
        GENER   1                               AVLSTF         MAX    0.0
        GENER   1                               AVLQ             =    pmaxq
        GENER   1                               AVLQ            -=    prlsf
        GENER   1                               AVLQ           MAX    0.0
        GENER   1                               CHANGE           =    fneed
        GENER   1                               CHANGE         MIN    avlstf
        GENER   1                               CHANGE         MIN    avlq
        GENER   1                               PTXR_R           =    ptxr_r
        GENER   1                               PTXR_R          +=    change
        GENER   1                               PTXRA            =    ptxr_n
        GENER   1                               PTXRA           +=    ptxr_r
        GENER   1                               PRLSF            =    ptxra
        GENER   1                               FNEED            =    fneed
        GENER   1                               FNEED           -=    change
      END IF
    END IF

    ***-------------------------------------------------------------***
    *** For recreation and non-recreation seasons:
    *** If more water is needed and Tahoe stage is greater than 6225.5, check
    *** tahoe.
    ***
    *** Add minimum of fneed and tpwvf for tahoe release, tpwra, to yesterdays
    ***   release:
    ***-------------------------------------------------------------***
    IF ((mo_da >= 4.01) AND (mo_da <= 10.31)) THEN
      *** Recreation and non-recreation seasons
      IF ((fneed > 0.0) AND (tstg > 6225.5)) THEN
        GENER   1                               AVLSTF           =    tpwvf
        GENER   1                               AVLSTF          -=    tpwra
        GENER   1                               AVLSTF         MAX    0.0
        GENER   1                               AVLQ             =    tmaxq
        GENER   1                               AVLQ            -=    trlsf
        GENER   1                               AVLQ           MAX    0.0
        GENER   1                               CHANGE           =    fneed
        GENER   1                               CHANGE         MIN    avlstf
        GENER   1                               CHANGE         MIN    avlq
        GENER   1                               TPWRA            =    tpwra
        GENER   1                               TPWRA           +=    change
        GENER   1                               TRLSF            =    tpwra
        GENER   1                               FNEED            =    fneed
        GENER   1                               FNEED           -=    change
      END IF
    END IF

    ***         If (fneed .GT. 0) at this point, cant meet FR
    ***
    ***-------------------------------------------------------------***
    *** Determine Pooled-Water release from reservoirs:
    ***-------------------------------------------------------------***
    GENER   1                               BPWRA            =    bncra
    GENER   1                               BPWRA           +=    bacra

    IF ((mo_da >= 4.01) AND (mo_da <= 9.03 )) THEN
      *** Recreation season
      GENER   1                               PTXRA            =    ptxr_n
      GENER   1                               PTXRA           +=    ptxr_r
    END IF


  ELSE IF (fexces > ftol) THEN

    ***-------------------------------------------------------------***
    *** NEED TO CUT BACK ON RELEASES:
    *** If fexces > 10, then flows at Farad exceed Floriston
    *** Rates.  Releases from the reservoirs need to be reduced in the
    *** reverse order of the above releases.
    ***
    *** A running calculation of excess flow above floriston rate (fexces) will
    *** be determined as reservoir releases are reduced.
    *******************************************************************

    *******************************************************************
    *** For recreation and non-recreation seasons:
    ***
    *** Check elevation of Lake Tahoe first.
    ***
    *** If Lake Tahoe WSE<=6225.5, then releases will be first
    *** reduced from Boca and Prosser so as not to exceed FR.
    *** Releases will be reduced for Lake Tahoe only if necessary so as not
    *** to exceed FR.
    ***
    *** If Lake Tahoe WSE>=6225.5, then releases will be first reduced from
    *** Lake Tahoe so as not to exceed FR. 
    ***-------------------------------------------------------------***
    IF ((mo_da >= 4.01) AND (mo_da <= 10.31)) THEN
      *** Recreation and non-recreation seasons
      IF ((tstg >= 6225.5) AND (tpwra > 0.0)) THEN
        GENER   1                               CHANGE           =    fexces
        GENER   1                               CHANGE         MIN    tpwra
        GENER   1                               TPWRA            =    tpwra
        GENER   1                               TPWRA           -=    change
        GENER   1                               TRLSF            =    tpwra
        GENER   1                               FEXCES           =    fexces
        GENER   1                               FEXCES          -=    change
      END IF
    END IF

    ***-------------------------------------------------------------***
    *** For recreation season only:
    *** If there are still excess flows at Farad then releases
    *** must be reduced even more.  Check if releases are being made
    *** from the recreation pool of exchange water at Prosser
    *** (volume < 19000 acre-feet).
    ***
    *** Subtract minimum of fexces and ptxr_r from yesterday's prosser.
    ***-------------------------------------------------------------***
    IF ((mo_da >= 4.01) AND (mo_da <= 9.03 )) THEN
      *** Recreation season
      IF ((fexces > 0.0) AND (ptxr_r > 0.0)) THEN
        GENER   1                               CHANGE           =    fexces
        GENER   1                               CHANGE         MIN    ptxr_r
        GENER   1                               PTXR_R           =    ptxr_r
        GENER   1                               PTXR_R          -=    change
        GENER   1                               PTXRA            =    ptxr_n
        GENER   1                               PTXRA           +=    ptxr_r
        GENER   1                               PRLSF            =    ptxra
        GENER   1                               FEXCES           =    fexces
        GENER   1                               FEXCES          -=    change
      END IF
    END IF

    ***-------------------------------------------------------------***
    *** If there are still excess flows at Farad, releases must be
    *** reduced even more.  Check if releases are being made from
    *** Boca ASSW pool.  ASSW pool is the volume above the first
    *** 25,000 in Boca.
    ***
    *** Subtract minimum of fexces and bncra from yesterday's boca release,
    ***-------------------------------------------------------------***
    IF ((fexces > 0.0) AND (bncra > 0.0)) THEN
      GENER   1                               CHANGE           =    fexces
      GENER   1                               CHANGE         MIN    bncra
      GENER   1                               BNCRA            =    bncra
      GENER   1                               BNCRA           -=    change
      GENER   1                               BRLSF            =    bncra
      GENER   1                               BRLSF           +=    bacra
      GENER   1                               FEXCES           =    fexces
      GENER   1                               FEXCES          -=    change
    END IF

    ***-------------------------------------------------------------***
    *** If there are still excess flows at Farad after reducing Boca ASSW releases,
    *** releases must be reduced even more.  Check if releases are being made from
    *** the Boca SSW pool.  SSW pool is the first 25,000 in Boca.
    ***
    *** Subtract minimum of fexces and bacra from yesterday's boca release,
    ***-------------------------------------------------------------***
    IF ((fexces > 0.0) AND (bacra > 0.0)) THEN
      GENER   1                               CHANGE           =    fexces
      GENER   1                               CHANGE         MIN    bacra
      GENER   1                               BACRA            =    bacra
      GENER   1                               BACRA           -=    change
      GENER   1                               BRLSF            =    bncra
      GENER   1                               BRLSF           +=    bacra
      GENER   1                               FEXCES           =    fexces
      GENER   1                               FEXCES          -=    change
    END IF

    ***-------------------------------------------------------------***
    *** If there are still excess flows at Farad after reducing Boca SSW releases,
    *** releases must be reduced even more.  Check if releases are being made
    *** from the non-recreational pool of exchange water from Prosser.
    ***
    *** For recreation season:
    ***   Subtract minimum of fexces and ptxr_n from yesterday's Prosser release.
    *** For other seasons:
    ***   Subtract minimum of fexces and ptxra from yesterday's Prosser release.
    ***-------------------------------------------------------------***
    IF ((mo_da >= 4.01) AND (mo_da <= 9.03 )) THEN
      *** Recreation season
      IF ((fexces > 0.0) AND (ptxr_n > 0.0)) THEN
        GENER   1                               CHANGE           =    fexces
        GENER   1                               CHANGE         MIN    ptxr_n
        GENER   1                               PTXR_N           =    ptxr_n
        GENER   1                               PTXR_N          -=    change
        GENER   1                               PTXRA            =    ptxr_n
        GENER   1                               PTXRA           +=    ptxr_r
        GENER   1                               PRLSF            =    ptxra
        GENER   1                               FEXCES           =    fexces
        GENER   1                               FEXCES          -=    change
      END IF
    ELSE
      *** Non-irrigation and non-recreation seasons
      IF ((fexces > 0.0) AND (ptxra > 0.0)) THEN
        GENER   1                               CHANGE           =    fexces
        GENER   1                               CHANGE         MIN    ptxra
        GENER   1                               PTXRA            =    ptxra
        GENER   1                               PTXRA           -=    change
        GENER   1                               PRLSF            =    ptxra
        GENER   1                               FEXCES           =    fexces
        GENER   1                               FEXCES          -=    change
      END IF
    END IF

    ***-------------------------------------------------------------***
    *** If there are still excess flows at Farad after reducing all Prosser
    *** releases, reduce all releases from Lake Tahoe.
    ***
    *** Subtract minimum of fexces and trlsf from yesterday's tahoe release,
    ***-------------------------------------------------------------***
    IF ((fexces > 0.0) AND (tpwra > 0.0)) THEN
      GENER   1                               CHANGE           =    fexces
      GENER   1                               CHANGE         MIN    tpwra
      GENER   1                               TPWRA            =    tpwra
      GENER   1                               TPWRA           -=    change
      GENER   1                               TRLSF            =    tpwra
      GENER   1                               FEXCES           =    fexces
      GENER   1                               FEXCES          -=    change
    END IF

    ***      If (fexces .GT. ftol) at this point, can't reduce Farad
    ***      flows to FR.

    ***      Determine total releases from lakes and reservoirs:
    GENER   1                               BPWRA            =    bncra
    GENER   1                               BPWRA           +=    bacra
    IF ((mo_da >= 4.01) AND (mo_da <= 9.03 )) THEN
      *** Recreation season
      GENER   1                               PTXRA            =    ptxr_n
      GENER   1                               PTXRA           +=    ptxr_r
    END IF
  END IF


***----------------------------------------------------------------------------
*** calculate total tahoe releases from floriston rates
***----------------------------------------------------------------------------

  GENER   1                               TRLSF            =    tpwra 

***----------------------------------------------------------------------------
*** calculate total prosser releases from floriston rates
***----------------------------------------------------------------------------

  GENER   1                               PRLSF            =    ptxra 

***----------------------------------------------------------------------------
*** calculate total boca releases from floriston rates
***----------------------------------------------------------------------------

  GENER   1                               BRLSF            =    bpwra 

***----------------------------------------------------------------------------
*** logic to swap proposed releases from pooled categories to natural water
***  water categories for water used to meet floriston rates in prosser and 
***  boca reservoirs
***----------------------------------------------------------------------------

*** prosser reservoir
  IF (ptxra > 0.0) AND (pnwtf > 0.0) THEN***SNB 11/21/95
  IF (ptxra > 0.0) AND (pnwvf > 0.0) THEN
    *** if proposed exchange release > 0.0 and natural water avaialble

    IF (pnwtf >= ptxra) THEN***SNB 11/21/95
    IF (pnwvf >= ptxra) THEN
      *** if natural water available is more than proposed exchange release, then swap
      ***  all exchange water for natural water
      GENER   1                               PNWRA            =    ptxra 
      GENER   1                               PTXRA            =    0.0  
    ELSE
      *** pnwvf < ptxra , not enough natural water to swap all of exchnage water
      *** calulate difference between exchange release and natural water avaialble
      GENER   1                               PDIFV            =    ptxra
      GENER   1 *** SNB 11/21/95              PDIFV           -=    pnwtf
      GENER   1                               PDIFV           -=    pnwvf
      GENER   1                               PTXRA            =    pdifv  
      GENER   1 ***SNB 11/21/95               PNWRA            =    pnwtf 
      GENER   1                               PNWRA            =    pnwvf 
    END IF
  END IF

*** boca reservoir
  IF (bpwra > 0.0) AND (bnwtf > 0.0) THEN      ***SNB 11/21/95
  IF (bpwra > 0.0) AND (bnwvf > 0.0) THEN      
    *** if proposed pooled release > 0.0 and total natural water avaialble
    IF (bnwtf >= bpwra) THEN     ***SNB 11/21/95
    IF (bnwvf >= bpwra) THEN     
      *** if natural water available is more than proposed pooled release,then swap 
      ***  all pooled water for natural water
      GENER   1                               BNWRA            =    bpwra 
      GENER   1                               BACRA            =    0.0  
      GENER   1                               BNCRA            =    0.0  
    ELSE
      *** bnwtf < bpwra , not enough total natural water to swap all of pooled water
      IF (bnwtf >= bacra) THEN ***SNB 11/21/95
      IF (bnwvf >= bacra) THEN
        GENER   1 ***SNB 11/21/95               BNWRA            =    bnwtf  
        GENER   1                               BNWRA            =    bnwvf  
        GENER   1                               BNCRA            =    bpwra 
        GENER   1 ***SNB 11/21/95               BNCRA           -=    bnwtf 
        GENER   1                               BNCRA           -=    bnwvf 
        GENER   1                               BACRA            =    0.0
       ELSE IF (bnwtf < bacra) THEN ***SNB 11/21/95
       ELSE IF (bnwvf < bacra) THEN
        GENER   1  ***SNB 11/21/95              BNWRA            =    bnwtf
        GENER   1                               BNWRA            =    bnwvf
        GENER   1                               BACRA           -=    bnwra
       END IF
    END IF
  END IF 



*** pbpbpb
***----------------------------------------------------------------------------
*** logic to determine end of storage season based on if drawing from storage 
***  to meet floriston rates in prosser and boca reservoirs
***----------------------------------------------------------------------------
  IF (mo_da >= 4.10) AND (mo_da <= 7.15) THEN ***
 
    ***&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&
    *** prosser reservoir

    ***  if drawing from storage to meet floriston rates,  then pfflag = 0
    *** or if using natural water to meet floriston rates, then pfflag = 1
    ***
    IF (ptxra > 20.0) AND (ptxrb > 20.0) THEN ***
      *** if ptxra > ptxrb then prosser tahoe-exchange releases have been increased 
      *** due to floriston rates logic, so drawing from storage to meet floriston 
      *** rates,  then pfflag = 0 
      GENER   1      ***                   2  PFFLAG           =       0
    END IF ***

    ***&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&
    *** boca reservoir

    ***  if drawing from storage to meet floriston rates,  then bfflag = 0
    *** or if using natural water to meet floriston rates, then bfflag = 1
    ***
    IF ((bacra > 20.0) OR (bncra > 20.0)) AND ((bacrb > 20.0) OR ***
        (bncrb > 20.0)) THEN ***
      *** if bacra > bacrb then pooled boca releases have been increased 
      *** due to floriston rates logic, then 
      *** drawing from storage to meet floriston rates,  then bfflag = 0
      GENER   1   ***                      2  BFFLAG           =       0 
    END IF ***
  END IF***


***=========================================================================
***     5. Determine proposed release for other demands, such as Pyramid
***        Fish, Truckee Canal, and Sierra Valley water
***=========================================================================

***  svsvsvsv

***+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
*** SIERRA VALLEY DECREES 
***+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

  IF (mo_da > 3.15 AND mo_da < 10.00) AND (fnwfsv > 196.) THEN

    ****   if flow at farad > 196 cfs then and in irrigation season,then
    ***     divert (based on Orr Ditch Decree)
    GENER   1                               SVRA             =    svdmd 
    ***   make sure diversion is not > 60 cfs
    GENER   1                               SVRA           MIN    60.       
    ***  calculate total flow physically available
    GENER   1                               LTQ              =    ltifl   
    GENER   1                               LTQ             -=    ltmfl   
    GENER   1                               LTQ            MAX    0.0     
    ***  is total flow avail > sierra valley demand ? if not set demand = ltq   
    GENER   1                               SVRA           MIN    ltq    
  ELSE IF (mo_da > 3.15 AND mo_da < 10.00) THEN
    ***   when flow at farad < 196 and in irrigation season, 
    ***    no diversion to sierra valley
    GENER   1                               SVRA             =    0.0
  END IF  

*** no diversion if total annual div  has been met, 5500 cfs is arbitrary
*** in reality, this number should be stated as ac-ft 
  IF (svcumv > 5500. ) THEN
    GENER   1                               SVRA             =    0.0 
  END IF

***----------------------------------------------------------------------------
***  sum the total yearly diversion 
***----------------------------------------------------------------------------

  GENER   1                               SVCUMV          +=    svra  

***storstor
***=========================================================================
***  7. Determine amount of water that needs to be released to satisfy storage 
***     priorities and rights.
***=========================================================================

*** the pseudo code for this section has the overall stategy and assumptions 


***SIMPLIFIED VERSION OF STORAGE PRIORITIES ON THE TRUCKEE RIVER :

***1. Meet SOP requirements
***2. Meet minimum flow requirements
***3. Reservoir in priority as listed below :
*** 1. Donner Lake - 9,500 ac-ft
*** 2. Independence Lake - initial 3,000 ac-ft
*** 3. Floriston Rates - which includes the following :
***   a. Claims 1 & 2 of Indian irrigation rights - 30 cfs (probably Indian Ditch)
***   b. SPPC M&I rights - 40 cfs
***   c. Newlands (TCID) Orr Ditch Decree rights -
***   d. all other truckee meadows Orr Ditch Decree rights
*** 4. Lake Tahoe
*** 5. Boca Reservoir adverse to canal rights = initial 25,000 ac-ft
*** 6. Newlands (TCID) rights above Orr Ditch Decree rights up to canal cap 
***    (900cfs) natural flow, not from storage
*** 7. Boca Reservoir not adverse to canal rights - additional 15,850 ac-ft
*** 8. Independence Lake - additional 14,500 ac-ft
*** 9. Stampede Reservoir - 126,000 ac-ft
*** NOTE : Capacity of stampede is 226,000 ac-ft
***10. Prosser Reservoir - 30,000 ac-ft
 
*** &&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&
*** reset storage dump values
*** &&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&

  GENER   1                               DDUMP            =    0.0 
  GENER   1                               IDUMP            =    0.0 
  GENER   1                               SDUMP            =    0.0 
  GENER   1                               BDUMP            =    0.0 
  GENER   1                               PDUMP            =    0.0 

***---------------------------------------------------------------------------
*** SET FLORISTON RATES FLAG
***---------------------------------------------------------------------------
  IF ((fexces > 0.0) OR (fneed < ftol)) THEN
    ***  set flflag = 1 for meeting floriston rates
    GENER   1                            2  FLFLAG           =    1 
  ELSE 
    ***  set flflag = 0 not meeting floriston rates
    GENER   1                            2  FLFLAG           =    0
  END IF


*** &&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&
*** determine if in allowable storage season - wintertime cap period
*** &&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&

*** NOTE: if outside of storage season do we need to set dump = net always ????

  IF (mo_da >= 1.01) AND (mo_da <= 4.09) THEN
    *** in wintertime cap period

    *** basic assumption for wintertime filling - 
    *** 1. reservoirs will not have enough inflows to satisfy their rights,
    *** 2. the reservoirs will fill concurrently , do not use RTFLAG
    *** 3. the only stipulation is that floriston rates be met for boca, 
    ***       stampede and prosser storage
    *** 4. canal rights are not considered because amount stored in winter is small

    *** Reservoir storage listed in priority ranking 
    *** tahoe storage is probably satisfied in the Floriston Rates section of code
    *** 1. Donner Lake 
    *** 2. Independence Lake
    *** 3. Floriston Rates 
    *** 4. Boca Reservoir 
    *** 5. Stampede Reservoir 
    *** 6. Prosser Reservoir 

    *** &&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&
    *** start storing in donner lake
    *** &&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&

    *** according to rick moser actions,storage in donner can occur outside storage
    *** season
    *** see sop block for determination of storage release DDUMP 


    *** &&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&
    *** start storing in independence lake
    *** &&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&

    *** according to rick moser actions,storage in indep can occur outside storage
    *** season
  
    *** &&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&
    *** tahoe storage
    *** &&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&

    *** tahoe storage is probably satisfied in the Floriston Rates section of code
 

    *** &&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&
    *** boca storage
    *** &&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&

    IF (flflag = 1) AND (bflag = 1) AND (bsto < bwcap) THEN 
      *** can store in boca if meeting floriston rates, boca not in SOP, boca stage
      *** below wintertime cap
      IF (bnet   > 0.) THEN  
        *** determine amount avaialble below winter cap
        GENER   1                               BAVLV            =   bwcap
        GENER   1                               BAVLV           -=   bsto 
        GENER   1                               BAVLV          MAX   0.0
        *** compare bdump to bavlvf (flow available up to cap)
        GENER   1                               BDUMP            =   bnet
        GENER   1                               BDUMP           -=   bavlvf
        GENER   1                               BDUMP          MAX   0.0
        GENER   1                               BDUMP          MIN   bmaxq
      ELSE 
        GENER   1                               BDUMP            =    0.0
      END IF
    ELSE 
      *** can not store in boca  flflag = 0 OR bflag = 0 OR bsto <= bwcap
      *** for lrb to see if he is paying attention , pryamid, proirity
      IF (bnet   > 0.) THEN 
        GENER   1                               BDUMP            =    bnet  
        GENER   1                               BDUMP          MIN    bmaxq 
      ELSE
        GENER   1                               BDUMP            =    0.0
      END IF 
    END IF 
 
    *** &&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&
    *** stampede reservoir
    *** &&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&

    IF (flflag = 1) AND (sflag = 1) AND (ssto < swcap) THEN 
      *** can store in stampede if meeting floriston rates, stampede not in SOP, 
      *** stampede stage below wintertime cap
      IF (snet   > 0.) THEN  
        *** determine amount avaialble below winter cap
        GENER   1                               SAVLV            =   swcap
        GENER   1                               SAVLV           -=   ssto 
        GENER   1                               SAVLV          MAX   0.0
        *** compare snet to savlvf (flow available up to cap)
        GENER   1                               SDUMP            =   snet
        GENER   1                               SDUMP           -=   savlvf
        GENER   1                               SDUMP          MAX   0.0
        GENER   1                               SDUMP          MIN   smaxq
      ELSE 
        GENER   1                               SDUMP            =    0.0
      END IF
    ELSE
      *** cant store in stampede if not meeting floriston rates,in SOP situation,
      *** or cumm storage > swcap ac-ft
      IF (snet   > 0.) THEN  
        GENER   1                               SDUMP            =    snet  
        GENER   1                               SDUMP          MIN    smaxq 
      ELSE
        GENER   1                               SDUMP            =    0.0
      END IF 
    END IF 
  
    *** &&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&
    *** start storing in prosser  reservoir
    *** &&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&

    IF (flflag = 1) AND (pflag = 1) AND (psto < pwcap) THEN 
      *** can store in prosser if meeting floriston rates, prosser not in SOP, 
      *** prosser stage below wintertime cap
      IF (pnet   > 0.) THEN  
        *** determine amount avaialble below winter cap
        GENER   1                               PAVLV            =   pwcap
        GENER   1                               PAVLV           -=   psto 
        GENER   1                               PAVLV          MAX   0.0
        *** compare pnet to pavlvf (flow available up to cap)
        GENER   1                               PDUMP            =   pnet
        GENER   1                               PDUMP           -=   pavlvf
        GENER   1                               PDUMP          MAX   0.0
        GENER   1                               PDUMP          MIN   pmaxq
      ELSE 
        GENER   1                               PDUMP            =    0.0
      END IF
    ELSE
      *** cant store in prosser if not meeting floriston rates,in SOP situation,
      *** or cumm storage > pwcap ac-ft
      IF (pnet   > 0.) THEN  
        GENER   1                               PDUMP            =    pnet
        GENER   1                               PDUMP          MIN    pmaxq 
      ELSE 
        GENER   1                               PDUMP            =    0.0
      END IF 
    END IF 
 
    *** &&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&
    *** determine if in allowable storage season - springtime filling period
    *** &&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&  

    ***---------------------------------------------------------------------------
  ELSE IF (mo_da >= 4.10) AND (mo_da <= 7.15) THEN
    *** in springtime filling period (April 10 - July 15)
    ***---------------------------------------------------------------------------

    *** dondon
    *** &&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&
    *** start storing in donner lake - total annual storage is 9500 ac-ft
    *** &&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&

    *** according to rick moser actions,storage in donner can occur anytime in
    *** storage season
    *** see sop block for determination of storage release DDUMP 

    *** ininin
    *** &&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&
    *** start storing in independence lake, first 3,000 ac-ft 
    *** &&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&

    *** according to rick moser actions,storage in indep  can occur anytime in
    *** storage season

    *** set rightflag = 1 donner and independence storage rights being net
    GENER   1                            2  RTFLAG           =    1

    *** &&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&
    *** tahoe storage
    *** &&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&

    *** tahoe storage is probably satisfied in the Floriston Rates section of code

    *** boca1boca1
    *** &&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&
    *** boca storage, first 25,000 ac-ft adverse to canal rights
    *** &&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&

    *** can store in boca if floriston rates met,
    *** not in SOP situation, 
    *** storage < bcap1 ac-ft 
    *** in storage season based on bfflag

    IF (bsto < bcap1) THEN 
      IF (flflag = 1) AND (bflag = 1) THEN 
      IF (flflag = 1) AND (bflag = 1) AND (bfflag = 1) THEN ***
        IF (bnet > 0.) THEN  
          *** determine amount avaialble below cap, bcap1 - bsto 
          GENER   1                               BAVLV            =   bcap1
          GENER   1                               BAVLV           -=   bsto 
          GENER   1                               BAVLV          MAX   0.0  
          *** compare bnet to bavlvf (flow available below cap)
          GENER   1                               BDUMP            =   bnet
          GENER   1                               BDUMP           -=   bavlvf
          GENER   1                               BDUMP          MAX    0.0
          GENER   1                               BDUMP          MIN   bmaxq
          *** compare max store from SOP,bmaxf to bnet,compute excess inflow 
          GENER   1                               BNWVCE           =    bnet   
          GENER   1                               BNWVCE          -=    bmaxf
          GENER   1                               BNWVCE         MAX    0.0
          *** compare bdump to bnwvce  
          GENER   1                               BDUMP          MAX    bnwvce
        ELSE 
          GENER   1                               BDUMP            =    0.0
          GENER   1                               BNWVCE           =    0.0
        END IF
        *** check to see if boca is storing max amount to satisfy storage priority
        IF (bdump = 0.0) OR (bnwvce > 0.0) THEN 
          *** two conditions - storing all inflow or dumping only excess inflow 
          *** set rightflag = 1 if boca first bcap1 storage rights being net
          GENER   1                            2  RTFLAG           =    1
        ELSE 
          *** set rightflag = 0 if boca first bcap1 storage rights not being net
          GENER   1                            2  RTFLAG           =    0
        END IF 
      ELSE 
        *** cant store in boca if not meeting floriston rates,in SOP situation,
        *** or not in storage season based on bfflag
        *** i.e.  (flflag = 0) OR (bflag = 0) OR (bfflag = 0)

        *** set rightflag = 0 if boca first bcap1 storage rights not being net
        GENER   1                            2  RTFLAG           =    0
        IF (bnet   > 0.) THEN  
          GENER   1                               BDUMP            =    bnet  
          GENER   1                               BDUMP          MIN    bmaxq 
        ELSE 
          GENER   1                               BDUMP            =    0.0
        END IF 
      END IF 
    END IF
 
    *** cancan
    *** &&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&
    *** Newlands (TCID) rights above Orr Ditch Decree rights below canal cap (900cfs)
    ***  natural flow, not from storage
    *** &&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&

    *** NOTE: this is a STOPGAP assumption to OCAP. we need to talk to FWM about
    ***    all the aspects of meeting canal demands 
    ***  this whole section probably needs to be re-examined

    IF (flflag = 1) AND (rtflag= 1) THEN 
      *** calculate newlands portion of Truckee canal if floriston rates being met
      *** and have right to store

      *** calc amount of Newlands rights through Orr Ditch decree according to TRA
      ***   cacf = 31% X floriston rates 
      ***  NOTE: this is a substitute for OCAP logic 
      GENER   1                               CACF             =    flrate
      GENER   1                               CACF            *=    0.31  

      *** calculate how much remains from canal time series (cncf), 
      ***           (which would supposively have OCAP flows), 
      ***      cncf = usgs-canal(cdvr) - cacf (all values in cfs)
      ***  subtract 20cfs because of assumption that of the SPPC 40cfs , 20cfs
      ***   remains from the STP returns
      GENER   1                               CNCF             =    cdvr  
      GENER   1                               CNCF            -=    cacf  
      GENER   1                               CNCF            -=    20.
      IF (cncf >= 0.) THEN
        *** canal is full, meeting canal rights, set rightflag = 1 
        GENER   1                            2  RTFLAG           =    1
      ELSE 
        *** not meeting canal rights, Set  variable rtflag= 0, not okay to store
        *** for reservoirs with lower priorities
        GENER   1                            2  RTFLAG           =    0
      END IF
    ELSE 
      *** not meeting canal rights, Set  variable rtflag= 0, not okay to store
      *** for reservoirs with lower priorities
      GENER   1                            2  RTFLAG           =    0
    END IF 
 
    *** boca2boca2
    *** &&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&
    *** Boca Reservoir not adverse to canal rights additional 15,850 ac-ft
    *** &&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&

    *** can store in boca for second storage , if storage above first right
    ***  if floriston rates met,
    *** not in SOP situation, 
    *** storage  < 40,850 ac-ft, 
    *** have the right to store,
    *** in storage season based on bfflag

    IF (bsto  >= bcap1) THEN 
      IF (flflag = 1) AND (bflag = 1) AND (bsto < bcap2) AND 
         (rtflag = 1) THEN 
         (rtflag = 1) AND (bfflag = 1) THEN ***
        IF (bnet   > 0.) THEN  
          *** determine amount avaialble below cap
          GENER   1                               BAVLV            =   bcap2
          GENER   1                               BAVLV           -=   bsto 
          GENER   1                               BAVLV          MAX   0.0  
          *** compare bnet to bavlvf (flow available below cap)
          GENER   1                               BDUMP            =   bnet
          GENER   1                               BDUMP           -=   bavlvf
          GENER   1                               BDUMP          MAX   0.0
          GENER   1                               BDUMP          MIN   bmaxq
          *** compute excess (bnwvce) bnet over bmaxf,max store from SOP
          GENER   1                               BNWVCE           =    bnet   
          GENER   1                               BNWVCE          -=    bmaxf
          GENER   1                               BNWVCE         MAX    0.0
          *** compare bdump to bnwvce  
          GENER   1                               BDUMP          MAX    bnwvce
        ELSE 
          GENER   1                               BDUMP            =    0.0
          GENER   1                               BNWVCE           =    0.0
        END IF
        *** check to see if boca is storing max amount to satisfy storage priority
        IF (bdump = 0.0) OR (bnwvce > 0.0) THEN 
          *** two conditions - storing all inflow or dumping only excess inflow 

          *** set rightflag = 1 if boca bcap2 storage rights being net
          GENER   1                            2  RTFLAG           =    1
        ELSE 
          *** set rightflag = 0 if boca first bcap2 storage rights not being net
          GENER   1                            2  RTFLAG           =    0
        END IF 
      ELSE 
        *** cant store in boca if not meeting floriston rates,in SOP situation,
        *** above bcap2 ,do not have the priority right or out of storage season
        *** based on bfflag logic  ie.(flflag = 0) OR (bflag = 0) OR (bsto > bcap2) 
        ***  (rtflag = 0) OR (bfflag = 0) 

        *** set rightflag = 0 if cant store 
        GENER   1                            2  RTFLAG           =    0
        IF (bnet > 0.) THEN 
          GENER   1                               BDUMP            =    bnet  
          GENER   1                               BDUMP          MIN    bmaxq 
        ELSE 
          GENER   1                               BDUMP            =    0.0
        END IF 
      END IF 
    END IF

    *** in2in2in2
    *** &&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&
    *** start storing in independence lake, additional 14,500 ac-ft 
    *** &&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&

    *** can store in indep for second storage if storage above first right
    *** if floriston rates met,
    *** not in SOP situation, 
    *** storage < 17,500 ac-ft, (3,000 + 14,500)
    *** have the right to store,

    *** determine amount to dump
   IF (isto >= icap1) THEN  
    IF (flflag = 1) AND (iflag = 1) AND (isto < icap2) AND 
         (rtflag = 1) THEN 
      *** can store in indep 
      IF (inet   > 0.) AND (iavlvf > 0.0) THEN 
        *** compare idump to iavlvf (flow available below cap)
        GENER   1                               IDUMP            =   inet
        GENER   1                               IDUMP           -=   iavlvf
        GENER   1                               IDUMP          MAX    0.0
        GENER   1                               IDUMP          MIN   imaxq
        *** compare max store from SOP,imaxf to inet,compute excess inflow 
        GENER   1                               INWVCE           =    inet   
        GENER   1                               INWVCE          -=    imaxf
        GENER   1                               INWVCE         MAX    0.0
        *** compare idump to inwvce  
        GENER   1                               IDUMP          MAX    inwvce
      ELSE 
        GENER   1                               IDUMP            =    0.0
      END IF
    ELSE  
      ***  no storage  if above iwcap or iflag = 0
      IF (inet > 0.) THEN     
        GENER   1                               IDUMP            =    inet  
        GENER   1                               IDUMP          MIN    imaxq
      ELSE
        GENER   1                               IDUMP            =    0.0
      END IF   
    END IF  
   END IF  

    *** stam1stam1
    *** &&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&
    *** start storing in stampede reservoir, 126,000 ac-ft 
    *** &&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&

    *** can store in stampede if floriston rates met,
    *** not in SOP situation, 
    *** storage < scap ac-ft 
    *** and have the right to store
    IF (flflag = 1) AND (sflag = 1) AND (ssto < scap) AND 
       (rtflag = 1) THEN 
      IF (snet   > 0.) THEN  
        *** determine amount avaialble below cap
        GENER   1                               SAVLV            =   scap
        GENER   1                               SAVLV           -=   ssto 
        GENER   1                               SAVLV          MAX   0.0  
        *** compare sdump to savlvf (flow available below cap)
        GENER   1                               SDUMP            =   snet
        GENER   1                               SDUMP           -=   savlvf
        GENER   1                               SDUMP          MAX    0.0
        GENER   1                               SDUMP          MIN   smaxq
        *** compare smaxf to snet, then compute excess snet   over smaxf
        GENER   1                               SNWVCE           =    snet   
        GENER   1                               SNWVCE          -=    smaxf
        GENER   1                               SNWVCE         MAX    0.0
        *** compare sdump to snwvce  
        GENER   1                               SDUMP          MAX    snwvce
      ELSE 
        GENER   1                               SDUMP            =    0.0
        GENER   1                               SNWVCE           =    0.0
      END IF
      *** check to see if stampede storing max amount to satisfy storage priority
      IF (sdump = 0.0) OR (snwvce > 0.0) THEN 
        *** two conditions - storing all inflow or dumping only excess inflow 

        *** set rightflag = 1 if stampede storage rights being net
        GENER   1                            2  RTFLAG           =    1
      ELSE 
        *** set rightflag = 0 if stampede storage rights not being net
        GENER   1                            2  RTFLAG           =    0
      END IF 
    ELSE 
      *** cant store in stampede if not meeting floriston rates,in SOP situation,
      *** storage > scap ac-ft,or do not have right to store

      *** set rightflag = 0 if cant store 
      GENER   1                            2  RTFLAG           =    0
      IF (snet   > 0.) THEN 
        GENER   1                               SDUMP            =    snet  
        GENER   1                               SDUMP          MIN    smaxq 
      ELSE 
        GENER   1                               SDUMP            =    0.0
      END IF 
    END IF 

    *** pro1pro1  
    *** &&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&
    *** start storing in prosser  reservoir, 30,000 ac-ft 
    *** &&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&

    *** can store in prosser if floriston rates met,
    *** not in SOP situation, 
    *** storage < 30000 ac-ft 
    *** right to store is not used here based on FWM conversations
    *** in storage season based on pfflag
    *** and must be in storage season on boca 

    IF (flflag = 1) AND (pflag = 1) AND (psto < pcap) THEN 
    IF (flflag = 1) AND (pflag = 1) AND (psto < pcap) AND (pfflag = 1) ***
        AND (bfflag = 1) THEN ***
      IF (pnet   > 0.) THEN  
        *** determine amount avaialble below cap
        GENER   1                               PAVLV            =   pcap
        GENER   1                               PAVLV           -=   psto 
        GENER   1                               PAVLV          MAX   0.0
        *** compare pdump to pavlvf (flow available below cap)
        GENER   1                               PDUMP            =   pnet
        GENER   1                               PDUMP           -=   pavlvf
        GENER   1                               PDUMP          MAX    0.0
        GENER   1                               PDUMP          MIN   pmaxq
        *** compare pmaxf to pnet, then compute excess pnet   over pmaxf
        GENER   1                               PUWVCE           =    pnet   
        GENER   1                               PUWVCE          -=    pmaxf
        GENER   1                               PUWVCE         MAX    0.0
        *** compare pdump to puwvce  
        GENER   1                               PDUMP          MAX    puwvce
      ELSE 
        GENER   1                               PDUMP            =    0.0
      END IF
    ELSE  
      *** cant store in prosser if not meeting floriston rates,in SOP situation,
      *** storage > pcap ac-ft, or not in storage season
      IF (pnet   > 0.) THEN
        GENER   1                               PDUMP            =    pnet  
        GENER   1                               PDUMP          MIN    pmaxq 
      ELSE 
        GENER   1                               PDUMP            =    0.0
      END IF 
    END IF 


    *** &&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&
    *** determine if in summertime period outside storage season 
    *** &&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&

    *** NOTE: if outside of storage season do we need to set dump = net always ????
  ELSE 
    *** July 16 to Dec 31
    GENER   1                               DDUMP            =    0.0
    GENER   1                               IDUMP            =    0.0
    IF (bnet   > 0.) THEN
      GENER   1                               BDUMP            =    bnet  
    ELSE 
      GENER   1                               BDUMP            =    0.0
    END IF 

    IF (pnet   > 0.) THEN
      GENER   1                               PDUMP            =    pnet  
    ELSE 
      GENER   1                               PDUMP            =    0.0
    END IF 

    IF (snet   > 0.) THEN
      GENER   1                               SDUMP            =    snet  
    ELSE 
      GENER   1                               SDUMP            =    0.0
    END IF 
  END IF

*** make sure if flows at reno are > 6000, then store all in boca,donner,prosser

  IF (fq >= 6000.0) THEN
    GENER   1                               BDUMP            =    bifl
    GENER   1                               DDUMP            =    difl
    GENER   1                               PDUMP            =    pifl
  END IF


*** minminmin
***==========================================================================
***    8. Determine proposed release minimum fisheries flow
***==========================================================================

********************************************************************************
***  LAKE TAHOE MINIMUM RELEASES
********************************************************************************
*** 
*** Lake Tahoe minimum releases are determined and used in the Tahoe-Prosser
***  Exchange following the merge routine.  Because Tahoe is operated 
***  mostly for Floriston Rates, there appears to be little need to 
***  compute minimum flows here.  

********************************************************************************
***  DONNER LAKE MINIMUM RELEASES
********************************************************************************
***----------------------------------------------------------------------------
*** from donner lake indenture 
***  if donner lake elev < 5932.0 and June 1 - August  31 then no releases 
***----------------------------------------------------------------------------

  IF (dstg < 5932.0 AND (mo_da >= 6.01 AND mo_da <= 8.31)) THEN 
    GENER   1                               DSPRA            =    0.0 
    GENER   1                               DTCRA            =    0.0 
    GENER   1                               DNWRA            =    0.0 
    GENER   1                               DRLST            =    0.0
    GENER   1                               DSHTVF           =    0.0
  END IF  

***----------------------------------------------------------------------------
*** from TROA notes, min release is 3 cfs
***  max drawdown level of donner for releases is 5927.0 ft
***---------------------------------------------------------------------------

  IF (dstg >= 5927.0) THEN  
    *** calculate flow needed to make dmfl cfs
    GENER   1                               DSHTVF           =    dmfl  
    *** compare to dmaxq here 
    GENER   1                               DSHTVF         MIN    dmaxq
    GENER   1                               DSHTVF         MAX    0.0
  END IF 


********************************************************************************
***  MARTIS CREEK RESERVOIR MINIMUM RELEASES
********************************************************************************

*** there are no minimum releases at Martis Creek Reservoir, as it is used for 
*** flood control only 


*****************************************************************************
*** PROSSER CREEK RESERVOIR MINIMUM RELEASES
*****************************************************************************

***  set minimum prosser releases = 5 cfs fish release,(SOP - Prosser)
***  or inflow whichever is minimum, if exchange water being released then 
***  no releases beyond 5 cfs
***  use natural water for minimum fish releases

  GENER   1                               PSHTVF           =   pmfl  
  *** compare to prosser net inflows 
  GENER   1                               PSHTVF         MIN   pifl
  GENER   1                               PSHTVF         MAX   0.0    
  *** comapre to amount that can be released
  GENER   1                               PSHTVF         MIN   pmaxq
  GENER   1                               PSHTVF         MAX   0.0    

********************************************************************************
***  INDEPENDENCE LAKE MINIMUM RELEASES
********************************************************************************

***----------------------------------------------------------------------------
*** from 1939 agreement,sec 525 of F&G code,  min release is 2 cfs
***  max drawdown level of independence releases is 6921.0 ft
***----------------------------------------------------------------------------

  *** calculate flow needed to make imfl 
  GENER   1                               ISHTVF           =    imfl  
  *** compare to imaxq 
  GENER   1                               ISHTVF         MIN    imaxq     
  GENER   1                               ISHTVF         MAX    0.0     

********************************************************************************
***  STAMPEDE RESERVOIR  MINIMUM RELEASES
********************************************************************************

***----------------------------------------------------------------------------
*** from State of Calif Permit 22011 (1969), min release is 30 cfs
***  max drawdown level of stampede for releases is storage of 5,000 ac-ft
***  which is elevation of 5798.2 ft from Water Control Manual
***----------------------------------------------------------------------------

  *** calculate flow needed to make smfl  in cfs
  GENER   1                               SSHTVF           =    smfl  

  GENER   1                               SSHTVF         MIN    smaxq
  GENER   1                               SSHTVF         MAX    0.0
 
********************************************************************************
***  BOCA RESERVOIR MINIMUM RELEASES
********************************************************************************

*** there are no minimum releases at Boca Reservoir


***mergemerge

********************************************************************************
***     9. Merge all blocks to determine final releases
********************************************************************************

***-------------------------------------------------------------***
*** Determine total proposed releases for additive demands, including 
*** Floriston Rates, Fish Flows, and POSW releases.
*** NOTE: As of 11/6/95, only Floriston Rates demands are used.  Still have
*** to add other demands.
*** NOTE: When other demands are added, must check against maxq's.
***-------------------------------------------------------------***
  GENER   1                               TRLST            =    trlsf
  GENER   1                               PRLST            =    prlsf
  GENER   1                               BRLST            =    brlsf

***-------------------------------------------------------------***
*** Compare releases mandated by SOP's, proposed releases from total
*** demands, Storage, and minimum flows.  Take maximum amounts.  All
*** amounts greater than releases from total demands must get category
*** assignments.  Do this for each reservoir.
***-------------------------------------------------------------***
  GENER   1                               TREL             =    trls 
  GENER   1                               TREL           MAX    trlst

  GENER   1                               PREL             =    prls 
  GENER   1                               PREL           MAX    prlst
  GENER   1                               PREL           MAX    pdump 
  GENER   1                               PREL           MAX    pshtvf

  GENER   1                               BREL             =    brls 
  GENER   1                               BREL           MAX    brlst
  GENER   1                               BREL           MAX    bdump

  GENER   1                               DREL             =    drls 
  GENER   1                               DREL           MAX    drlst
  GENER   1                               DREL           MAX    ddump
  GENER   1                               DREL           MAX    dshtvf

  GENER   1                               IREL             =    irls 
  GENER   1                               IREL           MAX    irlst
  GENER   1                               IREL           MAX    idump
  GENER   1                               IREL           MAX    ishtvf

  GENER   1                               SREL             =    srls 
  GENER   1                               SREL           MAX    srlst
  GENER   1                               SREL           MAX    sdump
  GENER   1                               SREL           MAX    sshtvf


***------------------------------------------------------------------***
*** If untagged releases mandated are greater than total of tagged
***    releases from other operations, then default categories are used
***    to tag the difference between untagged mandated flows and the
***    already tagged releases.
***------------------------------------------------------------------***
************************************************************************
***LAKE TAHOE
************************************************************************
  IF (trel > trlst) THEN
    GENER   1                               TDMRAA           =   trel     
    GENER   1                               TDMRAA          -=   trlst
  ELSE
    GENER   1                               TDMRAA           =   0.0
  END IF
      
  IF (tdmraa > 0.0) THEN
    *** Determine how much additional flow is available in the Tahoe 
    ***     pooled water category by computing difference between volume
    ***     of category and release of that category.
    ***  NOTE: May have to add in Federal Water later--for now, only pooled water
    IF (tpwvf > tpwra) THEN
      GENER   1                               AVLSTF           =   tpwvf    
      GENER   1                               AVLSTF          -=   tpwra
    ELSE
      GENER   1                               AVLSTF           =   0.0  
    END IF

    *** Determine how much additional flow can be released as limited
    ***     by hydraulic constraints of outlet.
    GENER   1                               AVLQ             =   tmaxq    
    GENER   1                               AVLQ            -=   trlst    
    GENER   1                               AVLQ           MAX    0.0

    *** Additional release is the minimum of needed release from pooled water,
    ***     additional flow available in category, and hydraulic limitation
    ***     of outlet.
    GENER   1                               TPWRAA           =   tdmraa   
    GENER   1                               TPWRAA         MIN   avlstf   
    GENER   1                               TPWRAA         MIN   avlq 
  ELSE 
    GENER   1                               TPWRAA           =   0.0
  END IF 

  GENER   1                               TPWRA           +=   tpwraa   
  GENER   1                               TRLST           +=   tpwraa   
  GENER   1                               TDMRAA          -=   tpwraa   
    
*** Thus, TRLST = TRLST + TPWRAA
***    (Tahoe release equals water released to meet Floriston Rates and 
***    additional pooled water to meet SOP demand).  Amounts of categories
***    released are unchanged from Floriston routine.
*************************************************************************
***PROSSER CREEK RESERVOIR
************************************************************************* 
  IF (prel > prlst) THEN
    GENER   1                               PDMRAA           =   prel     
    GENER   1                               PDMRAA          -=   prlst    
  ELSE
    GENER   1                               PDMRAA           =   0.0  
  END IF


  IF (pdmraa > 0.0) THEN  
    *** Determine how much additional flow is available in the natural water
    ***     category by computing difference between volume of category and 
    ***     release of that category.
    IF (pnwvf > pnwra) THEN 
      GENER   1                               AVLSTF           =   pnwvf   
      GENER   1                               AVLSTF          -=   pnwra   
    ELSE
      GENER   1                               AVLSTF           =   0.0  
    END IF 

    *** Determine how much additional flow can be released as limited
    ***     by hydraulic constraints of outlet.
    GENER   1                               AVLQ             =   pmaxq    
    GENER   1                               AVLQ            -=   prlst    
    GENER   1                               AVLQ           MAX    0.0

    *** Additional release is the minimum of needed release from natural water,
    ***     additional flow available in category, and hydraulic limitation
    ***     of outlet.
    GENER   1                               PNWRAA           =   pdmraa   
    GENER   1                               PNWRAA         MIN   avlstf   
    GENER   1                               PNWRAA         MIN   avlq  
  ELSE  
    GENER   1                               PNWRAA           =   0.0 
  END IF  

  GENER   1                               PNWRA           +=   pnwraa  
  GENER   1                               PRLST           +=   pnwraa  
  GENER   1                               PDMRAA          -=   pnwraa  

***----------------------------------------------------------*** 
  IF (pdmraa > 0.0) THEN 
    *** Determine how much additional flow is available in the uncommitted
    ***     category by computing difference between volume of category and 
    ***     release of that category.
    IF (puwvf > puwra) THEN
      GENER   1                               AVLSTF           =   puwvf       
      GENER   1                               AVLSTF          -=   puwra    
    ELSE
      GENER   1                               AVLSTF           =   0.0  
    END IF

    *** Determine how much additional flow can be released as limited
    ***     by hydraulic constraints of outlet.
    GENER   1                               AVLQ             =   pmaxq    
    GENER   1                               AVLQ            -=   prlst    
    GENER   1                               AVLQ           MAX    0.0

    *** Additional release is the minimum of needed release from uncommitted,
    ***     additional flow available in category, and hydraulic limitation
    ***     of outlet.
    GENER   1                               PUWRAA           =   pdmraa   
    GENER   1                               PUWRAA         MIN   avlstf   
    GENER   1                               PUWRAA         MIN   avlq 
  ELSE
    GENER   1                               PUWRAA           =   0.0
  END IF

  GENER   1                               PUWRA           +=   puwraa   
  GENER   1                               PRLST           +=   puwraa   
  GENER   1                               PDMRAA          -=   puwraa   

***---------------------------------------------------------***
  IF (pdmraa > 0.0) THEN 
    *** Determine how much additional flow is available in the exchange   
    ***     category by computing difference between volume of category and 
    ***     release of that category.
    IF (ptxvf > ptxra) THEN
      GENER   1                               AVLSTF           =   ptxvf       
      GENER   1                               AVLSTF          -=   ptxra    
    ELSE
      GENER   1                               AVLSTF           =   0.0  
    END IF

    *** Determine how much additional flow can be released as limited
    ***     by hydraulic constraints of outlet.
    GENER   1                               AVLQ             =   pmaxq    
    GENER   1                               AVLQ            -=   prlst    
    GENER   1                               AVLQ           MAX    0.0

    *** Additional release is the minimum of needed release from exchange water,
    ***     additional flow available in category, and hydraulic limitation
    ***     of outlet.
    GENER   1                               PTXRAA           =   pdmraa   
    GENER   1                               PTXRAA         MIN   avlstf   
    GENER   1                               PTXRAA         MIN   avlq 
  ELSE
    GENER   1                               PTXRAA           =   0.0
  END IF

  GENER   1                               PTXRA           +=   ptxraa   
  GENER   1                               PRLST           +=   ptxraa   
  GENER   1                               PDMRAA          -=   ptxraa   

*** Thus, PRLST = PRLST + PNWRAA + PUWRAA + PTXRAA
***    (Prosser release equals water released to meet Floriston Rates and 
***    additional uncommitted water to meet SOP demand).  Amounts of categories
***    released are unchanged from Floriston routine.
*******************************************************************
***BOCA RESERVOIR
*******************************************************************

***-------------------------------------------------------------***
  IF (brel > brlst) THEN
    GENER   1                               BDMRAA           =   brel     
    GENER   1                               BDMRAA          -=   brlst    
  ELSE
    GENER   1                               BDMRAA           =   0.0  
  END IF

***-------------------------------------------------------------***
  IF (bdmraa > 0.0) THEN 
    *** Determine how much additional flow is available in the natural water
    ***     category by computing difference between volume of category and 
    ***     release of that category.
    IF (bnwvf > bnwra) THEN  
      GENER   1                               AVLSTF           =   bnwvf  
      GENER   1                               AVLSTF          -=   bnwra  
    ELSE  
      GENER   1                               AVLSTF           =   0.0   
    END IF 

    *** Determine how much additional flow can be released as limited
    ***     by hydraulic constraints of outlet.
    GENER   1                               AVLQ             =   bmaxq  
    GENER   1                               AVLQ            -=   brlst  
    GENER   1                               AVLQ           MAX    0.0

    *** Additional release is the minimum of needed release from natural water,
    ***     additional flow available in category, and hydraulic limitation
    ***     of outlet.
    GENER   1                               BNWRAA           =   bdmraa 
    GENER   1                               BNWRAA         MIN   avlstf 
    GENER   1                               BNWRAA         MIN   avlq
  ELSE  
    GENER   1                               BNWRAA           =   0.0 
  END IF 

  GENER   1                               BNWRA           +=   bnwraa 
  GENER   1                               BRLST           +=   bnwraa 
  GENER   1                               BDMRAA          -=   bnwraa 

***-------------------------------------------------------------***
  IF (bdmraa > 0.0) THEN 
    *** Determine how much additional flow is available in the adverse-to-
    ***     canal pooled water category by computing difference between 
    ***     volume of category and release of that category.
    IF (bacvf > bacra) THEN
      GENER   1                               AVLSTF           =   bacvf       
      GENER   1                               AVLSTF          -=   bacra    
    ELSE
      GENER   1                               AVLSTF           =   0.0  
    END IF

    *** Determine how much additional flow can be released as limited
    ***     by hydraulic constraints of outlet.
    GENER   1                               AVLQ             =   bmaxq    
    GENER   1                               AVLQ            -=   brlst    
    GENER   1                               AVLQ           MAX    0.0

    *** Additional release is the minimum of needed release from adverse-to-
    ***     canal water, additional flow available in category, and hydraulic 
    ***     limitation of outlet.
    GENER   1                               BACRAA           =   bdmraa   
    GENER   1                               BACRAA         MIN   avlstf   
    GENER   1                               BACRAA         MIN   avlq 
  ELSE
    GENER   1                               BACRAA           =   0.0
  END IF

  GENER   1                               BACRA           +=   bacraa   
  GENER   1                               BRLST           +=   bacraa   
  GENER   1                               BDMRAA          -=   bacraa   

***-------------------------------------------------------------***
  IF (bdmraa > 0.0) THEN 
    *** Determine how much additional flow is available in the nonadverse-to-
    ***     canal pooled water category by computing difference between volume 
    ***     of category and  release of that category.
    IF (bncvf > bncra) THEN
      GENER   1                               AVLSTF           =   bncvf       
      GENER   1                               AVLSTF          -=   bncra    
    ELSE
      GENER   1                               AVLSTF           =   0.0  
    END IF

    *** Determine how much additional flow can be released as limited
    ***     by hydraulic constraints of outlet.
    GENER   1                               AVLQ             =   bmaxq    
    GENER   1                               AVLQ            -=   brlst    
    GENER   1                               AVLQ           MAX    0.0

    *** Additional release is the minimum of needed release from nonadverse-to-
    ***     canal water, additional flow available in category, and hydraulic 
    ***     limitation of outlet.
    GENER   1                               BNCRAA           =   bdmraa   
    GENER   1                               BNCRAA         MIN   avlstf   
    GENER   1                               BNCRAA         MIN   avlq 
  ELSE
    GENER   1                               BNCRAA           =   0.0
  END IF

  GENER   1                               BNCRA           +=   bncraa   
  GENER   1                               BRLST           +=   bncraa   
  GENER   1                               BDMRAA          -=   bncraa   


***-------------------------------------------------------------***
***ADDED BY GWH 9/13/95

  IF (bdmraa > 0.0) THEN 
    *** Determine how much additional flow is available in the fish water
    ***     category by computing difference between volume of category and 
    ***      release of that category.
    IF (bfsvf > bfsra) THEN
      GENER   1                               AVLSTF           =   bfsvf       
      GENER   1                               AVLSTF          -=   bfsra    
    ELSE
      GENER   1                               AVLSTF           =   0.0  
    END IF

    *** Determine how much additional flow can be released as limited
    ***     by hydraulic constraints of outlet.
    GENER   1                               AVLQ             =   bmaxq    
    GENER   1                               AVLQ            -=   brlst    
    GENER   1                               AVLQ           MAX    0.0

    *** Additional release is the minimum of needed release from fish
    ***     water, additional flow available in category, and hydraulic 
    ***     limitation of outlet.
    GENER   1                               BFSRAA           =   bdmraa   
    GENER   1                               BFSRAA         MIN   avlstf   
    GENER   1                               BFSRAA         MIN   avlq 
  ELSE
    GENER   1                               BFSRAA           =   0.0
  END IF

  GENER   1                               BFSRA           +=   bfsraa   
  GENER   1                               BRLST           +=   bfsraa   
  GENER   1                               BDMRAA          -=   bfsraa   

***-------------------------------------------------------------***
*** Thus, BRLST = BRLST + BNWRAA + BACRAA + BNCRAA + BFSRAA
***    (Boca release equals water released to meet Floriston Rates and 
***    additional natural water to meet SOP demand).  Amounts of categories
***    released are unchanged from Floriston routine.

***mergemerge
***************************************************************************
*** MERGE BLOCK FOR DONNER, INDEPENDENCE AND STAMPEDE RESERVOIRS
***************************************************************************

***-------------------------------------------------------------***
*** donner releases
*** donner storage category is half sp and half tc
***-------------------------------------------------------------***

  IF (drel > drlst) THEN
    GENER   1                               DDMRAA           =   drel     
    GENER   1                               DDMRAA          -=   drlst    
  ELSE 
    GENER   1                               DDMRAA           =   0.0
  END IF

***-------------------------------------------------------------***
*** NOTE: need to resolve natural water category, pull from that first

  IF (ddmraa > 0.0) THEN  
    *** Determine how much additional flow is available in the natural  
    ***                  water category by computing difference between 
    ***     volume of category and release of that category.
    IF (dnwvf > dnwra) THEN
      GENER   1                               AVLSTF           =   dnwvf       
      GENER   1                               AVLSTF          -=   dnwra    
    ELSE
      GENER   1                               AVLSTF           =   0.0  
    END IF

    *** Determine how much additional flow can be released as limited
    ***     by hydraulic constraints of outlet.
    *** NOTE: Having problems with computing outlet discharges (dmaxq).  Will
    *** skip this limitation for now.
    GENER   1                               AVLQ             =   dmaxq ***
    GENER   1                               AVLQ            -=   drlst    ***
    GENER   1                               AVLQ           MAX    0.0 ***

    *** Additional release is the minimum of needed release from natural 
    ***           water, additional flow available in category, and hydraulic 
    ***     limitation of outlet.
    GENER   1                               DNWRAA           =   ddmraa  
    GENER   1                               DNWRAA         MIN   avlstf   
    GENER   1                               DNWRAA         MIN   avlq  ***
  ELSE
    GENER   1                               DNWRAA           =   0.0
  END IF

  GENER   1                               DNWRA           +=   dnwraa   
  GENER   1                               DRLST           +=   dnwraa   
  GENER   1                               DDMRAA          -=   dnwraa   

***----------------------------------------------------------------------
  IF (ddmraa > 0.0) THEN 
    *** Determine how much additional flow is available in the SPPC
    ***                  water category by computing difference between 
    ***     volume of category and release of that category.
    IF (dspvf > dspra) THEN
      GENER   1                               AVLSTF           =   dspvf       
      GENER   1                               AVLSTF          -=   dspra    
    ELSE
      GENER   1                               AVLSTF           =   0.0  
    END IF

    *** Determine how much additional flow can be released as limited
    ***     by hydraulic constraints of outlet.
    *** NOTE: Having problems with computing outlet discharges (dmaxq).  Will
    *** skip this limitation for now.
    GENER   1                               AVLQ             =   dmaxq  ***
    GENER   1                               AVLQ            -=   drlst    ***
    GENER   1                               AVLQ           MAX    0.0***

    *** Additional release is the minimum of needed release from SPPC
    ***           water, additional flow available in category, and hydraulic 
    ***     limitation of outlet.
    GENER   1                               DSPRAA           =   ddmraa  
    GENER   1                               DSPRAA         MIN   avlstf   
    GENER   1                               DSPRAA         MIN   avlq  ***
  ELSE
    GENER   1                               DSPRAA           =   0.0
  END IF

  GENER   1                               DSPRA           +=   dspraa   
  GENER   1                               DRLST           +=   dspraa   
  GENER   1                               DDMRAA          -=   dspraa   

***-------------------------------------------------------------***
  IF (ddmraa > 0.0) THEN
    *** Determine how much additional flow is available in the TCID
    ***     water category by computing difference between volume 
    ***     of category and  release of that category.
    IF (dtcvf > dtcra) THEN
      GENER   1                               AVLSTF           =   dtcvf       
      GENER   1                               AVLSTF          -=   dtcra    
    ELSE
      GENER   1                               AVLSTF           =   0.0  
    END IF 

    *** Determine how much additional flow can be released as limited
    ***     by hydraulic constraints of outlet.
    *** NOTE: Having problems with computing outlet discharges (dmaxq).  Will
    *** skip this limitation for now.
    GENER   1                               AVLQ             =   dmaxq ***
    GENER   1                               AVLQ            -=   drlst ***
    GENER   1                               AVLQ           MAX    0.0 ***

    *** Additional release is the minimum of needed release from TCID
    ***           water, additional flow available in category, and hydraulic 
    ***     limitation of outlet.
    GENER   1                               DTCRAA           =   ddmraa   
    GENER   1                               DTCRAA         MIN   avlstf   
    GENER   1                               DTCRAA         MIN   avlq ***
  ELSE
    GENER   1                               DTCRAA           =   0.0
  END IF

  GENER   1                               DTCRA           +=   dtcraa   
  GENER   1                               DRLST           +=   dtcraa   
  GENER   1                               DDMRAA          -=   dtcraa   

***-------------------------------------------------------------***
*** Thus, DRLST = DRLST + DNWRAA + DSPRAA + DTCRAA


***-------------------------------------------------------------***
*** independence releases
*** independence storage category is sp
***-------------------------------------------------------------***

  IF (irel > irlst) THEN
    GENER   1                               IDMRAA           =   irel     
    GENER   1                               IDMRAA          -=   irlst    
  ELSE 
    GENER   1                               IDMRAA           =   0.0
  END IF

***-------------------------------------------------------------***
*** NOTE: need to resolve natural water category, pull from that first

  IF (idmraa > 0.0) THEN 
    *** Determine how much additional flow is available in the natural
    ***     water category by computing difference between volume of
    ***     category and release of that category.
    IF (inwvf > inwra) THEN
      GENER   1                               AVLSTF           =   inwvf    
      GENER   1                               AVLSTF          -=   inwra
    ELSE
      GENER   1                               AVLSTF           =   0.0  
    END IF

    *** Determine how much additional flow can be released as limited
    ***     by hydraulic constraints of outlet.
    GENER   1                               AVLQ             =   imaxq 
    *** will be implemented with imaxq
    GENER   1                               AVLQ            -=   irlst 
    GENER   1                               AVLQ           MAX    0.0

    *** Additional release is the minimum of needed release from natural
    ***     water, additional flow available in category, and hydraulic
    ***     limitation of outlet.
    GENER   1                               INWRAA           =   idmraa   
    GENER   1                               INWRAA         MIN   avlstf   
    GENER   1                               INWRAA         MIN   avlq 
  ELSE 
    GENER   1                               INWRAA           =   0.0
  END IF 

  GENER   1                               IRLST           +=   inwraa   
  GENER   1                               INWRA           +=   inwraa   
  GENER   1                               IDMRAA          -=   inwraa   

***-------------------------------------------------------------***

  IF (idmraa > 0.0) THEN 
    *** Determine how much additional flow is available in the SPPCo 
    ***     water category by computing difference between volume of 
    ***     category and release of that category.
    IF (ispvf > ispra) THEN
      GENER   1                               AVLSTF           =   ispvf    
      GENER   1                               AVLSTF          -=   ispra
    ELSE
      GENER   1                               AVLSTF           =   0.0  
    END IF

    *** Determine how much additional flow can be released as limited
    ***     by hydraulic constraints of outlet.
    GENER   1                               AVLQ             =   imaxq 
    *** will be implemented with imaxq
    GENER   1                               AVLQ            -=   irlst 
    GENER   1                               AVLQ           MAX    0.0

    *** Additional release is the minimum of needed release from SPPC water,
    ***     additional flow available in category, and hydraulic limitation
    ***     of outlet.
    GENER   1                               ISPRAA           =   idmraa   
    GENER   1                               ISPRAA         MIN   avlstf   
    GENER   1                               ISPRAA         MIN   avlq 
  ELSE 
    GENER   1                               ISPRAA           =   0.0
  END IF 

  GENER   1                               IRLST           +=   ispraa   
  GENER   1                               ISPRA           +=   ispraa   
  GENER   1                               IDMRAA          -=   ispraa   

 
***-------------------------------------------------------------***
*** Thus, IRLST = IRLST + INWRAA + ISPRAA + ISPL

  GENER   1           ***                 IRLST           +=   irls


***-------------------------------------------------------------***
*** stampede releases
*** stampede storage category is fs
***-------------------------------------------------------------***

  IF (srel > srlst) THEN
    GENER   1                               SDMRAA           =   srel     
    GENER   1                               SDMRAA          -=   srlst    
  ELSE 
    GENER   1                               SDMRAA           =   0.0
  END IF

*** NOTE: need to resolve natural water category, pull from that first
***-------------------------------------------------------------***

  IF (sdmraa > 0.0) THEN 
    *** Determine how much additional flow is available in the natural
    ***     water category by computing difference between 
    ***     volume of category and release of that category.
    IF (snwvf > snwra) THEN
      GENER   1                               AVLSTF           =   snwvf       
      GENER   1                               AVLSTF          -=   snwra    
    ELSE
      GENER   1                               AVLSTF           =   0.0  
    END IF

    *** Determine how much additional flow can be released as limited
    ***     by hydraulic constraints of outlet.
    GENER   1                               AVLQ             =   smaxq    
    GENER   1                               AVLQ            -=   srlst    
    GENER   1                               AVLQ           MAX    0.0

    *** Additional release is the minimum of needed release from natural
    ***     water, additional flow available in category, and hydraulic 
    ***     limitation of outlet.
    GENER   1                               SNWRAA           =   sdmraa   
    GENER   1                               SNWRAA         MIN   avlstf   
    GENER   1                               SNWRAA         MIN   avlq 
  ELSE
    GENER   1                               SNWRAA           =   0.0
  END IF

  GENER   1                               SNWRA           +=   snwraa   
  GENER   1                               SRLST           +=   snwraa   
  GENER   1                               SDMRAA          -=   snwraa   

***-------------------------------------------------------------***
  IF (sdmraa > 0.0) THEN 
    *** Determine how much additional flow is available in the fish
    ***     water category by computing difference between 
    ***     volume of category and release of that category.
    IF (sfsvf > sfsra) THEN
      GENER   1                               AVLSTF           =   sfsvf       
      GENER   1                               AVLSTF          -=   sfsra    
    ELSE
      GENER   1                               AVLSTF           =   0.0  
    END IF

    *** Determine how much additional flow can be released as limited
    ***     by hydraulic constraints of outlet.
    GENER   1                               AVLQ             =   smaxq    
    GENER   1                               AVLQ            -=   srlst    
    GENER   1                               AVLQ           MAX    0.0

    *** Additional release is the minimum of needed release from fish
    ***     water, additional flow available in category, and hydraulic 
    ***     limitation of outlet.
    GENER   1                               SFSRAA           =   sdmraa   
    GENER   1                               SFSRAA         MIN   avlstf   
    GENER   1                               SFSRAA         MIN   avlq 
  ELSE
    GENER   1                               SFSRAA           =   0.0
  END IF

  GENER   1                               SFSRA           +=   sfsraa   
  GENER   1                               SRLST           +=   sfsraa   
  GENER   1                               SDMRAA          -=   sfsraa   

***-------------------------------------------------------------***
  IF (sdmraa > 0.0) THEN 
    *** Determine how much additional flow is available in the SPPCo
    ***     water category by computing difference between 
    ***     volume of category and release of that category.
    IF (sspvf > sspra) THEN
      GENER   1                               AVLSTF           =   sspvf       
      GENER   1                               AVLSTF          -=   sspra    
    ELSE
      GENER   1                               AVLSTF           =   0.0  
    END IF

    *** Determine how much additional flow can be released as limited
    ***     by hydraulic constraints of outlet.
    GENER   1                               AVLQ             =   smaxq    
    GENER   1                               AVLQ            -=   srlst    
    GENER   1                               AVLQ           MAX    0.0

    *** Additional release is the minimum of needed release from SPPCo
    ***     water, additional flow available in category, and hydraulic 
    ***     limitation of outlet.
    GENER   1                               SSPRAA           =   sdmraa   
    GENER   1                               SSPRAA         MIN   avlstf   
    GENER   1                               SSPRAA         MIN   avlq 
  ELSE
    GENER   1                               SSPRAA           =   0.0
  END IF

  GENER   1                               SSPRA           +=   sspraa   
  GENER   1                               SRLST           +=   sspraa   
  GENER   1                               SDMRAA          -=   sspraa   

*** NOTE: if needed we can add another category to draw water from sp 

***-------------------------------------------------------------***
*** Thus, SRLST = SRLST + SNWRAA + SFSRAA + SSPRAA + SSPL
*** NOTE: Why is spill included in merge for Independence and Stampede, 
*** but not for any other reservoirs?

  GENER   1        ***                    SRLST           +=   srls
  GENER   1        ***snb11/6/95          SRLST           +=   sspl



*** tahextahex
***=========================================================================
***    10. Paper exchanges
***=========================================================================

**************************************************************************
*** TAHOE PROSSER EXCHANGE LOGIC AND TAHOE MINIMUMS
******************************************************************************
*** NOTE: assumptions 
*** 1) can not credit TEW when tahoe is in precautionary drawdown, this is true
***    because drawdown flows will be > tmfl
*** 2) evap losses should come from uncommitted water ? they do now 
*** 3) exchange water carries over from year to year as programmed here.
 

  IF (flflag = 1) AND (trlst < tmfl) AND (puwvf > 0.0) THEN
    ***  meeting floriston rates, but not meeting min flows at tahoe, and 
    ***  prosser uncommitted flows available and not in flood at tahoe

    ***  calculate shortfall flow  needed to meet tahoe min release
    GENER   1                               TSHTVF           =    tmfl 
    *** compare to maximum release from tahoe gates
    GENER   1                               TSHTVF         MIN    tmaxq
    *** subtract already calculated releases from tahoe
    GENER   1                               TSHTVF          -=    trlst
    IF (tshtvf > 0.0) THEN
      *** need to release additional water to meet tahoe min flows

      *** puwvf is net available Prosser uncommitted
      *** if puwvf < needed exchange,prorate tahoe releases based on puwvf available
      GENER   1                               AVLSTF           =    puwvf 
      GENER   1                               AVLSTF          -=    puwra 
      GENER   1                               AVLSTF         MAX       0.0 
      GENER   1                               TSHTVF         MIN    avlstf
      *** then credit tahoe exchange water in prosser 
      *** variable tshtv converts cfs to ft3 for exchange  in prosser
      RCHRES178                            4  CVOL   px       +=    tshtv
      RCHRES178                            4  CVOL   pu       -=    tshtv
      RCHRES178                            4  CVOL   pu      MAX       0.0
 
      ***----------------------------------------------------------------------------
      *** calculate total tahoe releases
      ***----------------------------------------------------------------------------
      GENER   1                               TRLST           +=    tshtvf
      GENER   1                               TPWRA           +=    tshtvf

      *** NOTE: need to set tshtvf release = py category through MASS-LINK, NETWORK 
    END IF

    *****************************************************************************
    *** TAHOE MINIMUM RELEASES  WITHOUT TAHOE PROSSER EXCHANGE
    *****************************************************************************
  ELSE IF (trlst < tmfl) THEN 
    ***  not meeting min flows at tahoe
    ***  calculate shortfall flow  needed to meet tahoe min release
    GENER   1                               TSHTVF           =    tmfl 
    *** compare to maximum release from tahoe gates
    GENER   1                               TSHTVF         MIN    tmaxq
    *** subtract already calculated releases from tahoe 
    GENER   1                               TSHTVF          -=    trlst

    IF (tshtvf > 0.0) THEN
      *** need to release additional water to meet tahoe min flows

      *** calculate total tahoe releases
      GENER   1                               TRLST           +=    tshtvf
      GENER   1                               TPWRA           +=    tshtvf
    END IF
  END IF 
 

***=========================================================================
***    11. Determine correct category of water stored through swap
***=========================================================================

***swapswap

*** NOTE: potential problems here are 1) what to do with water that is temporarily 
***  stored that comes in during a storm. we may have to hold it a couple days
***  before releasing per SOP's
***  2) we may still need a way to get rid of nw if we cant get rid of it all
***    in the method below

*********************************************************************************
*** SUM THE AMOUNT STORED IN RESERVOIRS AND NECESSARY 'SWAPS' FOR CATEGORIES
*********************************************************************************
  IF (fq < 6000.) THEN
    *** If flows at Reno surrogate (Farad) < 6000 can exchange natural water
    ***  storage increases to various categories.  Otherwise, natural water
    ***  stays as is.

    ***----------------------------------------------------------------------------
    *** donner lake 
    ***----------------------------------------------------------------------------

    ***calculate net donner proposed storage(dnwtra) = dnet - proposed release(drlst)
    GENER   1                               DNWTRA           =    dnwvf 
    GENER   1                               DNWTRA          -=    dnwra

    *** split amount to be stored between sp and tc categories
    GENER   1                               DNWTV            =    dnwtrf 
    GENER   1                               DNWTV           *=    0.5    

    IF (dnwtra > 0.0) THEN  
      *** if there is storage, then store nw water as sp and tc
      *** then debit nw water that amount
      *** variable dnwtrf converts cfs to ft3 for swap
      RCHRES145                            4  CVOL   nw       -=    dnwtrf 
      RCHRES145                            4  CVOL   nw      MAX       0.0 

      *** then credit sp and tc water in donner
      RCHRES145                            4  CVOL   sp       +=    dnwtv  
      RCHRES145                            4  CVOL   tc       +=    dnwtv  
    END IF 
    ***----------------------------------------------------------------------------
    *** independence lake 
    ***----------------------------------------------------------------------------

    ***calculate net indep proposed storage(inwtra) = inet - proposed release(irlst)
    GENER   1                               INWTRA           =    inwvf 
    GENER   1                               INWTRA          -=    inwra

    IF (inwtra > 0.0) THEN
      *** if there is storage, then store nw water as sp 
      *** then credit sp water in independence and debit nw water that amount 
      *** variable inwtrf converts cfs to ft3 for swap 
      RCHRES187                            4  CVOL   sp       +=    inwtrf
      RCHRES187                            4  CVOL   nw       -=    inwtrf
      RCHRES187                            4  CVOL   nw      MAX       0.0
    END IF

    ***----------------------------------------------------------------------------
    *** boca reservoir
    ***----------------------------------------------------------------------------

    ***calculate net boca proposed storage(bnwtra) = bnet - proposed release(brlst)
    GENER   1                               BNWTRA           =    bnwvf 
    GENER   1                               BNWTRA          -=    bnwra

    IF (bnwtra > 0.0) THEN
      *** if there is storage, then store nw water as ac
      *** NOTE:for now assume all ac credited in swap, ultimtely it will be pw category
      *** then credit ac water in boca and debit nw water that amount 
      *** variable bnwtrf converts cfs to ft3 for swap 
      RCHRES209                            4  CVOL   ac       +=    bnwtrf
      RCHRES209                            4  CVOL   nw       -=    bnwtrf
      RCHRES209                            4  CVOL   nw      MAX       0.0
    END IF

    ***----------------------------------------------------------------------------
    *** stampede reservoir
    ***----------------------------------------------------------------------------

    ***calculate net stampede proposed storage(snwtra) = snet - proposed release(srlst)
    GENER   1                               SNWTRA           =    snwvf 
    GENER   1                               SNWTRA          -=    snwra

    IF (snwtra > 0.0) THEN
      *** if there is storage, then store nw water as py
      *** then credit py water in stampede and debit nw water that amount 
      *** variable snwtrf converts cfs to ft3 for swap 
      RCHRES199                            4  CVOL   py       +=    snwtrf
      RCHRES199                            4  CVOL   nw       -=    snwtrf
      RCHRES199                            4  CVOL   nw      MAX       0.0
    END IF

    ***----------------------------------------------------------------------------
    *** prosser reservoir
    ***----------------------------------------------------------------------------

    ***calculate net prosser proposed storage(pnwtra) = pnet - proposed release(prlst)
    GENER   1                               PNWTRA           =    pnwvf 
    GENER   1                               PNWTRA          -=    pnwra

    IF (pnwtra > 0.0) THEN
      *** if there is storage, then store nw water as pu
      *** then credit pu water in prosser and debit nw water that amount 
      *** variable pnwtrf converts cfs to ft3 for swap 
      RCHRES178                            4  CVOL   pu       +=    pnwtrf
      RCHRES178                            4  CVOL   nw       -=    pnwtrf
      RCHRES178                            4  CVOL   nw      MAX       0.0
    END IF
  END IF


*** oooooooooo
***=========================================================================
***    12. GENERATE ALL OUTFLOW DATA SETS             
***=========================================================================
 
***   set tahoe release   = K for return to ext sources block
  GENER   1                               K       1        =    tpwra

***   set donner release   = K for return to ext sources block
  GENER  10                               K       1        =    dspra 
  GENER  11                               K       1        =    dtcra 
  GENER  14                               K       1        =    dnwra 


***   set martis release   = K for return to ext sources block
  GENER  20                               K       1        =    mrls  

***   set prosser release   = K for return to ext sources block
  GENER  30                               K       1        =    puwra 
  GENER  31                               K       1        =    ptxra 
  GENER  32                               K       1        =    pnwra 

*** set prosser nw volume
  GENER 311                               K       1        =    pnwv 
 
***   set sierra diversion = K for return to ext sources block
  GENER  45                               K       1        =    svra  

*** set independence release = K for return to ext sources block
  GENER  40                               K       1        =    ispra
  GENER  41                               K       1        =    inwra 
 
***   set stampede release   = K for return to ext sources block
  GENER  51                               K       1        =    sspra 
  GENER  52                               K       1        =    sfsra 
  GENER  54                               K       1        =    snwra 
*** send total stampede inflow to ext sources block
  GENER  53                               K       1        =    sifl  

***   set boca release   = K for return to ext sources block
  GENER  61                               K       1        =    bspra 
  GENER  62                               K       1        =    bfsra  
***   set boca release   = K for return to ext sources block
  GENER  64                               K       1        =    bacra 
  GENER  65                               K       1        =    bncra
  GENER  66                               K       1        =    bnwra

*** send total boca inflow to ext sources block
  GENER  63                               K       1        =    bifl  

*** send floriston rates to ext sources block
  GENER  80                               K       1        =    fadj  
  GENER  81                               K       1        =    flrate

END SPEC-ACTIONS
 
 
FTABLES
  FTABLE    100
     ***REPRESENTS LAKE TAHOE.  ALL STORAGE BELOW THE RIM, AT 6223.0 FEET
     ***  IS CONSIDERED "NEGATIVE" STORAGE, BUT FTABLES CANNOT HAVE NEGATIVE
     ***  VALUES.  THEREFORE, 482,720 ACRE-FEET MUST BE SUBTRACTED FROM ALL
     ***  VOLUMES USED AND SIMULATED BY THE MODEL TO CORRESPOND TO ACTUAL 
     ***  VOLUMES RELATIVE TO LAKE TAHOE'S OUTLET RIM.
 ROWS COLS ***
   25    4
     DEPTH      AREA    VOLUME     DISCH ***
      (FT)   (ACRES)   (AC-FT)     (CFS) ***
    6219.0    119950     0.000      0.00
    6220.0    120370    120160      0.00
    6220.5    120540    180380      0.00
    6221.0    120710    240700      0.00
    6221.5    120870    301090      0.00
    6222.0    121020    361570      0.00
    6222.4    121130    410000      0.00
    6222.7    121210    446350      0.00
    6223.0    121270    482720      0.00
*** these have been altered for spillway rating curve B
    6223.3    121340    519110     17.00 ***
    6223.7    121420    567660    109.00 ***
    6224.0    121480    604100    211.00 ***
    6224.3    121540    640550    336.00 ***
    6224.7    121620    689180    375.00 ***
    6225.0    121680    725680    450.00 ***
    6225.3    121740    762190    600.00 ***
    6225.7    121830    810900    800.00 ***
    6226.0    121900    847470   1000.00 ***
    6226.5    122020    908450   1300.00 ***
    6227.0    122160    969490   1650.00 ***
    6227.5    122530   1030630   2050.00 ***
    6228.0    122900   1092020   2450.00 ***
    6228.5    123040   1153510   2850.00 ***
    6229.0    123140   1215050   3250.00 ***
    6229.5    123230   1276640   3500.00 ***
*** without spillway ratings 
    6223.3    121340    519110      0.00 
    6223.7    121420    567660      0.00
    6224.0    121480    604100      0.00
    6224.3    121540    640550      0.00
    6224.7    121620    689180      0.00
    6225.0    121680    725680      0.00
    6225.3    121740    762190      0.00
    6225.7    121830    810900      0.00
    6226.0    121900    847470      0.00
    6226.5    122020    908450      0.00
    6227.0    122160    969490      0.00
    6227.5    122530   1030630      0.00
    6228.0    122900   1092020      0.00
    6228.5    123040   1153510      0.00
    6229.0    123140   1215050      0.00
    6229.5    123230   1276640      0.00
  END FTABLE100
  FTABLE    110
     TRUCKEE RIVER AT TAHOE CITY - RIFFLE 3.7 MI DS OF TAHOE CITY            ***
 Rows Cols   (TK1)                                                           ***
   25    4
     DEPTH      AREA    VOLUME     DISCH ***
      (FT)   (ACRES)   (AC-FT)     (CFS) ***
    24.130     0.000     0.000      0.00
    24.300     5.220     0.473      0.30
    24.600    10.261     1.543      2.00
    24.900    13.436     3.915      8.00
    25.200    15.701     7.014     18.00
    25.500    18.305    10.983     35.00
    25.800    20.367    15.854     59.00
    26.100    22.119    21.183     91.00
    26.400    24.163    26.896    132.00
    26.700    26.022    33.896    185.00
    27.000    29.322    41.801    248.00
    27.300    32.696    49.895    318.00
    27.600    37.212    60.437    405.00
    27.900    38.933    70.611    501.00
    28.200    39.656    80.557    606.00
    28.500    40.089    90.351    720.00
    28.900    40.683   103.291    883.00
    29.400    42.552   121.096   1109.00
    29.900    43.423   138.547   1357.00
    30.650    46.360   173.864   1899.00
    31.400    49.509   210.775   2496.00
    32.300    52.463   256.247   3312.00
    33.350    55.882   311.271   4398.00
    34.700    61.343   385.037   5977.00
    35.750    68.337   448.144   7418.00
  END FTABLE110
  FTABLE    120
     TRUCKEE RIVER 3.7 MI DS OF TAHOE CITY TO SQUAW CREEK                    ***
 Rows Cols   (TK2)                                                           ***
   25    4
     DEPTH      AREA    VOLUME     DISCH ***
      (FT)   (ACRES)   (AC-FT)     (CFS) ***
    27.490     0.000     0.000      0.00
    27.750     0.761     0.100      0.20
    28.050     2.960     0.589      2.00
    28.350     5.008     1.577      6.00
    28.650     9.248     3.397     15.00
    28.950    12.235     7.455     45.00
    29.100    14.357     9.212     58.00
    29.250    17.182    12.232     83.00
    29.400    18.124    15.930    124.00
    29.550    19.093    19.595    170.00
    29.850    20.034    27.263    283.00
    30.150    22.152    35.129    418.00
    30.450    23.448    44.098    585.00
    30.750    24.403    53.332    776.00
    31.050    25.585    63.205    989.00
    31.350    26.545    72.933   1223.00
    31.800    28.698    88.439   1614.00
    32.250    29.835   104.476   2053.00
    32.700    30.952   121.028   2537.00
    33.150    32.650   138.112   3068.00
    33.600    40.400   157.327   3643.00
    34.050    43.768   178.362   4260.00
    34.650    46.171   206.491   5145.00
    35.250    48.086   235.645   6125.00
    35.850    50.083   265.155   7180.00
  END FTABLE120
  FTABLE    130
     TRUCKEE RIVER AT SQUAW CREEK TO DEEP CREEK                              ***
 Rows Cols   (TK3)                                                           ***
   25    4
     DEPTH      AREA    VOLUME     DISCH ***
      (FT)   (ACRES)   (AC-FT)     (CFS) ***
    24.980     0.000     0.000      0.00
    25.200     0.753     0.099      0.10
    25.400     4.026     0.596      1.00
    25.600     8.339     1.984      3.00
    25.800    12.386     4.286     10.00
    26.000    15.019     7.138     21.00
    26.200    17.536    10.760     38.00
    26.400    19.561    14.710     59.00
    26.600    21.354    18.809     83.00
    26.800    22.670    23.336    112.00
    27.000    23.914    27.959    145.00
    27.200    24.919    33.048    184.00
    27.400    25.757    38.328    228.00
    27.600    26.820    43.825    280.00
    27.900    28.116    53.131    372.00
    28.200    29.546    63.175    479.00
    28.500    30.715    74.421    612.00
    28.900    32.126    91.289    830.00
    29.300    33.534   108.905   1079.00
    29.800    35.342   131.638   1432.00
    30.300    37.447   155.778   1834.00
    30.900    39.890   186.924   2379.00
    31.500    43.065   220.901   2989.00
    32.200    48.743   263.602   3830.00
    33.000    53.757   317.353   4928.00
  END FTABLE130
  FTABLE    140
     TRUCKEE RIVER AT DEEP CREEK TO TRUCKEE RIVER NR TRUCKEE (GAGE)          ***
 Rows Cols   (TK4)                                                           ***
   25    4
     DEPTH      AREA    VOLUME     DISCH ***
      (FT)   (ACRES)   (AC-FT)     (CFS) ***
    25.130     0.000     0.000      0.00
    25.200     0.940     0.143      0.20
    25.500     2.745     0.387      1.00
    25.800     7.185     1.910      5.00
    25.950    10.712     3.422     10.00
    26.100    16.383     5.827     19.00
    26.250    19.764     9.128     36.00
    26.400    21.498    13.241     61.00
    26.700    25.157    21.809    127.00
    27.000    28.264    30.484    208.00
    27.300    30.748    39.212    302.00
    27.600    32.114    50.882    455.00
    28.050    33.835    69.060    729.00
    28.500    34.813    87.717   1053.00
    28.950    35.709   106.257   1420.00
    29.400    36.807   125.204   1831.00
    29.850    39.383   145.949   2289.00
    30.300    42.091   167.758   2790.00
    30.750    45.207   190.290   3337.00
    31.200    50.729   213.951   3916.00
    31.650    54.171   239.176   4541.00
    32.100    58.664   266.054   5212.00
    32.550    61.183   294.192   5940.00
    33.000    63.557   323.157   6710.00
    33.600    67.460   363.254   7806.00
  END FTABLE140
  FTABLE    145
     ***REPRESENTS DONNER LAKE.  ALL STORAGE BELOW THE RIM, AT 5923.8 FEET
     ***  IS CONSIDERED "NEGATIVE" STORAGE, BUT LOWEST STAGE RECORDED WAS   
     ***  5927.23 FEET.  THIS IS BECAUSE RIM OFTEN BUILDS TO ABOVE 5923.8  
     ***  FEET AND THEY SOMETIMES DREDGE THIS RIM.
 ROWS COLS ***
   17    4
     DEPTH      AREA    VOLUME     DISCH ***
      (FT)   (ACRES)   (AC-FT)     (CFS) ***
    5923.8       697       0.0      0.00
    5924.0       703       140      0.00
    5925.0       730       860      0.00
    5926.0       745      1600      0.00
    5927.0       760      2350      0.00
    5928.0       775      3120      0.00
    5929.0       785      3900      0.00
    5930.0       795      4690      0.00
    5931.0       810      5490      0.00
    5932.0       820      6310      0.00
    5933.0       830      7130      0.00
    5934.0       840      7970      0.00
    5935.0       850      8810      0.00
    5935.9       887      9580      0.00
    5936.0       893      9670      0.00
    5936.2       900      9850      0.00
*** next line is extrapolated
    5946.2      1330     18850      0.00
  END FTABLE145
  FTABLE    149
     DONNER CREEK AT GAGE TO DONNER CREEK AT MOUTH                           ***
 Rows Cols   (TK5)                                                           ***
   25    4
     DEPTH      AREA    VOLUME     DISCH ***
      (FT)   (ACRES)   (AC-FT)     (CFS) ***
    17.800     0.000     0.000      0.00
    17.900     2.038     0.282      1.00
    18.050     3.476     0.857      4.00
    18.200     4.745     1.765     10.00
    18.350     5.858     2.949     20.00
    18.500     6.721     4.009     31.00
    18.650     7.459     5.319     46.00
    18.800     8.215     6.600     63.00
    18.950     8.903     8.031     82.00
    19.100    10.623     9.706    103.00
    19.250    11.274    11.184    126.00
    19.550    11.928    14.048    179.00
    20.000    13.817    18.870    276.00
    20.450    14.491    23.881    390.00
    20.900    14.849    28.756    522.00
    21.500    15.170    35.510    724.00
    22.100    15.888    42.517    956.00
    22.850    17.497    52.116   1288.00
    23.600    18.550    62.422   1667.00
    24.350    19.430    73.368   2095.00
    25.250    20.452    87.197   2674.00
    26.300    21.034   103.878   3445.00
    27.500    21.806   124.037   4447.00
    28.700    22.963   145.728   5597.00
    29.900    24.807   169.273   6906.00
  END FTABLE149
  FTABLE    150
     TRUCKEE RIVER NR TRUCKEE (GAGE) TO TRUCKEE SEWAGE TREATMENT PLANT       ***
 Rows Cols   (TK6)                                                           ***
   25    4
     DEPTH      AREA    VOLUME     DISCH ***
      (FT)   (ACRES)   (AC-FT)     (CFS) ***
    20.680     0.000     0.000      0.00
    20.850     3.627     0.681      1.00
    21.150     6.553     1.851      3.00
    21.450    12.807     3.765      7.00
    21.900    19.908     7.438     16.00
    22.200    23.980    12.359     33.00
    22.500    29.058    18.076     53.00
    22.800    32.933    25.468     87.00
    23.250    39.224    39.917    163.00
    23.700    44.667    56.416    268.00
    24.150    47.054    73.840    402.00
    24.600    48.079    91.653    561.00
    25.200    50.101   117.065    823.00
    25.800    52.052   145.417   1148.00
    26.400    54.473   175.842   1543.00
    27.000    57.005   208.472   1998.00
    27.600    60.064   242.785   2511.00
    28.200    64.036   278.670   3063.00
    28.650    66.736   310.032   3571.00
    28.950    79.658   336.147   3931.00
    29.250    84.371   361.434   4308.00
    30.150    88.696   437.834   5551.00
    31.200    97.016   532.870   7183.00
    32.400   108.781   650.753   9343.00
    33.450   121.819   768.792  11598.00
  END FTABLE150
  FTABLE    160
     TRUCKEE RIVER AT SEWAGE TREATMENT PLANT TO MARTIS CREEK                 ***
 Rows Cols   (TK7)                                                           ***
   25    4
     DEPTH      AREA    VOLUME     DISCH ***
      (FT)   (ACRES)   (AC-FT)     (CFS) ***
    20.190     0.000     0.000      0.00
    20.500     1.161     0.193      0.30
    21.100     6.353     1.578      3.00
    21.300     8.630     2.716      6.00
    21.500    12.075     4.843     13.00
    21.700    14.416     7.034     21.00
    22.100    18.935    12.463     45.00
    22.500    24.376    19.269     80.00
    22.900    27.612    26.265    125.00
    23.300    30.396    34.239    183.00
    23.700    33.008    43.596    259.00
    24.100    35.509    53.942    352.00
    24.700    38.775    71.415    536.00
    25.300    42.517    90.887    762.00
    25.900    44.023   109.727   1024.00
    26.500    45.845   130.128   1331.00
    27.100    47.422   151.929   1687.00
    27.700    48.680   175.254   2102.00
    28.500    51.504   208.965   2741.00
    29.300    53.473   245.612   3500.00
    30.300    57.279   299.022   4632.00
    31.300    73.323   362.573   5870.00
    32.500    82.479   453.853   7843.00
    33.700    92.428   548.963  10103.00
    35.100   117.962   662.447  12607.00
  END FTABLE160
  FTABLE    168
     ***REPRESENTS MARTIS LAKE.  MANMADE RESERVOIR USED FOR FLOOD CONTROL,
     ***  FISHERY ENHANCEMENT, AND RECREATION.  
 ROWS COLS ***
   23    4
     DEPTH      AREA    VOLUME     DISCH ***
      (FT)   (ACRES)   (AC-FT)     (CFS) ***
    5745.0       0.0       0.0      0.00
    5760.0     17.0         67      0.00
    5770.0     34.3        320      0.00
    5777.0     52.6        604      0.00
    5779.0     58.0        716      0.00
    5780.0     61.2        775      0.00
    5782.5     72.8        942      0.00
    5785.0     86.2       1139      0.00
    5787.5    101.4       1373      0.00
    5790.0    118.4       1646      0.00
    5792.5    137.8       1965      0.00
    5795.0    159.6       2335      0.00
    5797.5    184.0       2763      0.00
    5800.0    206.2       3255      0.00
    5802.5    230.4       3794      0.00
    5805.0    261.4       4407      0.00
    5807.5    295.4       5101      0.00
    5810.0    319.4       5884      0.00
    5812.5    343.8       6698      0.00
    5815.0    382.3       7603      0.00
    5820.0    456.3       9718      0.00***
    5830.0    612.0      14950      0.00 ***
*** these have been altered for spillway ratings
    5838.0    762.0      20391      0.00  
    5848.0   1015.0      29231   2050.0  
    5852.9   1150.0      34534   4000.0 

    5840.0    790.0      21960      0.00 ***
  END FTABLE168
  FTABLE    169
     MARTIS CREEK NR TRUCKEE (GAGE) TO MARTIS CREEK AT MOUTH                 ***
 Rows Cols   (TK8)                                                           ***
   25    4
     DEPTH      AREA    VOLUME     DISCH ***
      (FT)   (ACRES)   (AC-FT)     (CFS) ***
    25.790     0.000     0.000      0.00
    25.900     0.846     0.088      0.30
    26.050     2.377     0.228      1.20
    26.350     2.918     0.531      3.00
    26.500     3.399     0.805      6.00
    26.650     3.718     1.198     10.00
    26.800     4.331     1.811     18.00
    26.950     4.777     2.404     27.00
    27.100     5.183     2.986     38.00
    27.400     6.195     4.572     68.00
    27.700     7.435     6.401    107.00
    28.000     8.117     8.662    164.00
    28.300     8.737    11.109    237.00
    28.600    10.469    14.241    333.00
    28.900    12.456    17.915    451.00
    29.200    16.583    22.718    591.00
    29.500    19.686    28.876    766.00
    29.800    21.502    35.463    963.00
    30.100    22.838    42.262   1182.00
    30.400    24.743    49.489   1423.00
    30.700    25.433    56.822   1682.00
    31.000    26.148    64.391   1963.00
    31.300    26.814    72.041   2263.00
    31.600    27.544    79.824   2583.00
    31.900    28.161    87.756   2923.00
  END FTABLE169
  FTABLE    170
     TRUCKEE RIVER AT MARTIS CREEK TO PROSSER CREEK                          ***
 Rows Cols   (TK9)                                                           ***
   25    4
     DEPTH      AREA    VOLUME     DISCH ***
      (FT)   (ACRES)   (AC-FT)     (CFS) ***
    19.390     0.000     0.000      0.00
    19.500     2.057     0.247      0.40
    20.100     5.301     1.196      2.00
    20.300     7.028     2.203      5.00
    20.500     8.583     3.155      8.00
    20.900    11.962     5.955     19.00
    21.300    15.676    10.603     40.00
    21.700    18.808    17.798     83.00
    22.100    23.963    27.308    144.00
    22.500    30.327    38.956    227.00
    22.900    32.527    51.336    341.00
    23.300    33.822    65.582    499.00
    23.700    34.873    80.276    687.00
    24.100    35.523    94.835    901.00
    24.500    36.567   110.024   1138.00
    25.100    38.311   132.784   1530.00
    25.700    40.786   157.959   1998.00
    26.300    42.497   185.572   2562.00
    26.900    46.082   215.691   3199.00
    27.700    48.633   260.882   4240.00
    28.500    51.592   309.386   5448.00
    29.300    53.349   359.405   6820.00
    30.300    55.471   424.783   8755.00
    31.500    59.218   509.039  11396.00
    32.700    63.118   599.245  14427.00
  END FTABLE170
  FTABLE    178
     ***REPRESENTS PROSSER CREEK RESERVOIR.  USABLE CAPACITY, 28,641 ACRE-FT
     ***  BETWEEN ELEVATIONS 5660.6 FT, TOP OF INACTIVE CONTENTS, AND 5,741.2
     ***  FT, CREST OF SPILLWAY.  INACTIVE CONTENTS, 1,201 ACRE-FT, INCLUDES
     ***  83 ACRE-FT DEAD CONTENTS BELOW ELEVATION, 5,637.0 FT.  EXTREMES: 
     ***  MAXIMUM CONTENTS, 32,269 ACRE-FT, ELEVATION, 5,744.33 FT; MINIMUM, 
     ***  66 ACRE-FT, ELEVATION, 5,635.75 FT.
 ROWS COLS ***
   25    4
     DEPTH      AREA    VOLUME     DISCH ***
      (FT)   (ACRES)   (AC-FT)     (CFS) ***
    5622.0       0.0       0.0      0.00
    5630.0       4.0      17.0      0.00
    5640.0      24.0     143.0      0.00
    5650.0      47.0     491.0      0.00
    5655.0      66.0     770.0      0.00 
    5660.0      86.0    1148.0      0.00
    5660.6      89.0    1201.0      0.00
    5665.0     109.0    1633.0      0.00
    5670.0     132.0    2230.0      0.00
    5675.0     157.0    2948.0      0.00
    5680.0     182.0    3791.0      0.00
    5685.0     212.0    4771.0      0.00
    5690.0     242.0    5901.0      0.00
    5695.0     274.0    7187.0      0.00
    5700.0     307.0    8636.0      0.00
    5705.0     352.0   10278.0      0.00
    5710.0     398.0   12147.0      0.00
    5715.0     451.0   14262.0      0.00
    5720.0     504.0   16643.0      0.00
    5725.0     559.0   19294.0      0.00
    5730.0     614.0   22220.0      0.00
    5735.0     674.0   25434.0      0.00
    5740.0     734.0   28949.0      0.00
*** these have been altered for spillway ratings
    5745.0     818.0   32806.0    400.00 ***
    5754.5     977.0   41221.0   2740.00  ***

    5745.0     818.0   32806.0      0.00 
    5760.0    1069.0   46936.0      0.00 
  END FTABLE178
  FTABLE    180
     TRUCKEE RIVER AT PROSSER CREEK TO LITTLE TRUCKEE RIVER                  ***
 Rows Cols   (TK10)                                                          ***
   25    4
     DEPTH      AREA    VOLUME     DISCH ***
      (FT)   (ACRES)   (AC-FT)     (CFS) ***
    21.870     0.000     0.000      0.00
    22.300     2.339     0.369      1.00
    22.700     4.307     1.514      5.00
    22.900     5.508     2.530     10.00
    23.100     7.223     3.849     17.00
    23.300     9.394     5.276     24.00
    23.700    13.243     8.954     46.00
    24.100    17.010    13.950     82.00
    24.500    20.406    20.509    138.00
    24.900    23.067    28.245    218.00
    25.300    24.510    36.397    318.00
    25.700    25.713    44.212    432.00
    26.300    27.225    58.513    666.00
    26.900    28.743    73.539    952.00
    27.500    29.836    90.116   1302.00
    28.300    31.797   113.364   1847.00
    29.100    33.356   138.003   2486.00
    29.900    34.756   163.636   3208.00
    30.900    36.283   197.485   4258.00
    31.900    37.368   233.321   5482.00
    33.100    39.329   278.197   7136.00
    34.300    42.080   325.800   8993.00
    35.500    43.339   373.742  11009.00
    36.900    45.015   432.516  13643.00
    38.500    47.576   498.040  16671.00
  END FTABLE180
  FTABLE    185
     LITTLE TRUCKEE R BLW SIERRA VALLEY DIVERSION TO INDEPENDECE CK          ***
 ROWS COLS ***
   24    4
     DEPTH      AREA    VOLUME     DISCH ***
      (FT)   (ACRES)   (AC-FT)     (CFS) ***
    80.180     0.000     0.000      0.00
    80.400     3.542     0.611      1.00
    80.600     6.382     1.031      2.00
    80.800     7.296     1.557      4.00
    81.000     9.070     2.461      8.00
    81.200    11.132     3.748     14.00
    81.400    13.204     5.005     20.00
    81.600    16.039     7.377     33.00
    81.800    18.444    10.694     58.00
    82.000    20.087    14.761     93.00
    82.200    21.842    19.190    139.00
    82.400    23.380    24.101    194.00
    82.600    24.710    29.193    257.00
    82.800    26.276    35.106    336.00
    83.000    28.064    41.634    432.00
    83.200    30.889    48.480    538.00
    83.400    33.207    55.724    653.00
    83.800    37.003    70.660    912.00
    84.200    39.345    86.125   1206.00
    84.600    45.434   102.092   1516.00
    85.200    57.977   140.710   2302.00
    85.800    69.881   197.643   3607.00
    86.600    75.506   292.591   6400.00
    88.000   142.625   554.883  13382.00
  END FTABLE185
  FTABLE    187
     ***REPRESENTS INDEPENDENCE LAKE.  LAKE LEVELS REGULATED BY AN
     ***  EARTHFILL DAM AT THE OUTLET CONSTRUCTED IN 1939.  USABLE CAPACITY
     ***  17,300 ACRE-FT BETWEEN ELEVATIONS 6,921 FT, INVERT OF OUTLET GATE 
     ***  AND 6,949 FT, NORMAL MAXIMUM STORAGE LEVEL.  EXTREMES: MAXIMUM 
     ***  CONTENTS, 17400 ACRE-FT, ELEVATION, 6949.19 FT; MINIMUM, 4,750 
     ***  ACRE-FT, ELEVATION, 6,929.90 FT.
 ROWS COLS ***
   18    4
     DEPTH      AREA    VOLUME     DISCH ***
      (FT)   (ACRES)   (AC-FT)     (CFS) ***
    6921.0     537.0       0.0      0.00
    6921.5     543.0       270      0.00
    6922.5     553.0       820      0.00
    6925.0     565.0      2225      0.00
    6926.5     569.0      3075      0.00
    6927.0     572.0      3360      0.00
    6929.0     588.0      4515      0.00
    6931.0     597.0      5709      0.00
    6933.5     602.0      7202      0.00
    6935.0     610.0      8110      0.00
    6936.0     615.0      8724      0.00
    6937.0     625.0      9340      0.00
    6940.0     640.0     11240      0.00
    6942.0     660.0     12550      0.00
    6945.0     680.0     14530      0.00
    6947.0     690.0     15900      0.00
    6950.0     705.0     18000      0.00
***  next line is extrapolated
    6970.0     805.0     32000      0.00
  END FTABLE187 
  FTABLE    188
     INDEPENDENCE CK FROM INDEPENDENCE LK TO ROAD BRIDGE                     ***
 ROWS COLS ***
   25    4
     DEPTH      AREA    VOLUME     DISCH ***
      (FT)   (ACRES)   (AC-FT)     (CFS) ***
    91.650     0.000     0.000      0.00
    91.850     2.243     0.283      1.01
    92.000     3.832     0.468      2.01
    92.150     4.746     1.047      5.01
    92.300     5.916     1.639     10.01
    92.450     7.078     2.453     17.01
    92.600     7.911     3.283     25.01
    92.750     8.754     4.174     36.01
    92.900     9.221     5.185     49.01
    93.050     9.601     6.278     64.01
    93.200     9.991     7.412     82.01
    93.350    10.400     8.787    106.01
    93.500    10.810    10.307    134.01
    93.650    11.254    11.807    165.01
    93.800    11.562    13.508    202.01
    93.950    12.003    15.421    247.00
    94.100    12.558    17.450    295.00
    94.250    13.048    19.572    349.00
    94.400    13.564    21.764    407.00
    94.550    14.998    24.128    471.00
    94.700    20.547    28.227    574.00
    95.000    25.857    41.646    966.00
    95.300    32.562    65.403   1584.00
    96.050    55.699   143.307   3937.00
    97.400    69.283   290.902  10689.00
  END FTABLE188
  FTABLE    189
     INDEPENDENCE CR FROM ROAD BRIDGE TO LITTLE TRUCKEE RIVER                ***
 ROWS COLS ***
   21    4
     DEPTH      AREA    VOLUME     DISCH ***
      (FT)   (ACRES)   (AC-FT)     (CFS) ***
    85.790     0.000     0.000      0.00
    85.900     1.016     0.203      0.90
    86.050     1.219     0.242      1.01
    86.200     1.948     0.471      3.01
    86.350     2.439     0.811      6.01
    86.500     3.685     1.449     11.01
    86.650     4.888     2.205     19.01
    86.800     5.862     2.953     27.01
    86.950     6.837     3.754     37.01
    87.100     8.458     4.817     50.01
    87.250    10.100     6.179     68.01
    87.400    11.704     7.581     91.01
    87.550    13.784     9.344    118.00
    87.700    15.642    11.252    148.00
    87.850    17.008    12.533    165.00
    88.150    23.174    16.200    208.00
    88.300    27.616    19.691    254.00
    88.450    32.549    24.806    336.00
    88.600    37.754    31.327    445.00
    88.750    44.429    39.660    593.00
    88.900    49.515    48.433    758.00
  END FTABLE189
  FTABLE    194
     LITTLE TRUCKEE RIVER FROM INDEPENDENCE CK TO HWY 89 BRIDGE              ***
 ROWS COLS ***
   25    4
     DEPTH      AREA    VOLUME     DISCH ***
      (FT)   (ACRES)   (AC-FT)     (CFS) ***
    85.030     0.000     0.000      0.00
    85.400     1.859     0.400      2.00
    85.550     3.171     0.863      4.00
    85.700     3.778     1.262      7.00
    85.850     4.453     1.775     11.00
    86.000     5.402     2.495     17.00
    86.150     6.401     3.257     24.00
    86.300     7.421     4.050     32.00
    86.450     8.413     4.844     40.00
    86.600     9.574     5.963     52.00
    86.900    12.046     9.648     99.00
    87.200    13.188    14.004    175.00
    87.500    13.959    18.412    268.00
    87.800    14.506    23.016    378.00
    88.100    17.453    29.751    507.00
    88.250    27.674    36.964    578.00
    88.550    30.244    43.624    731.00
    89.000    31.559    53.192    993.00
    89.450    32.674    63.016   1294.00
    89.900    34.596    73.535   1635.00
    90.500    37.351    88.372   2143.00
    91.100    39.973   104.261   2725.00
    92.600    44.683   149.461   4610.00
    94.400    59.352   215.946   7528.00
    97.850    83.138   369.001  14946.00
  END FTABLE194
  FTABLE    195
     LITTLE TRUCKEE RIVER FROM HWY 89 BRIDGE TO US OF STAMPEDE RES           ***
 ROWS COLS ***
   18    4
     DEPTH      AREA    VOLUME     DISCH ***
      (FT)   (ACRES)   (AC-FT)     (CFS) ***
    77.000     0.000     0.000      0.00
    77.100     1.403     0.202      0.50
    77.400    11.574     3.406     11.00
    77.700    19.563    12.460     61.00
    78.000    23.297    21.619    137.00
    78.300    26.901    32.009    242.00
    78.600    29.984    46.012    412.00
    78.900    34.558    63.644    638.00
    79.200    42.062    81.135    902.00
    79.500    49.894   100.946   1203.00
    79.800    56.682   122.502   1539.00
    80.100    72.548   155.942   1909.00
    80.400    81.240   179.984   2312.00
    81.000   119.332   236.258   3213.00
    81.600   138.978   293.499   4246.00
    82.500   161.790   393.991   6173.00
    83.400   179.892   518.515   8872.00
    84.600   188.382   693.638  13593.00
  END FTABLE195
  FTABLE    198
     SAGEHEN CK FROM GAGING STATION TO US OF STAMPEDE RES                    ***
 ROWS COLS ***
   25    4
     DEPTH      AREA    VOLUME     DISCH ***
      (FT)   (ACRES)   (AC-FT)     (CFS) ***
    76.880     0.000     0.000      0.00
    76.900     2.027     0.329      0.60
    77.100     4.660     0.627      1.00
    77.300     8.530     2.231      5.00
    77.500    12.012     4.525     15.00
    77.700    14.062     7.618     31.00
    77.900    16.355    11.067     54.00
    78.100    18.445    15.011     83.00
    78.300    20.322    19.395    120.00
    78.500    22.701    24.536    165.00
    78.700    24.609    30.019    218.00
    78.900    26.810    35.902    280.00
    79.100    28.875    42.488    352.00
    79.300    31.047    49.648    434.00
    79.500    42.317    63.336    526.00
    79.700    52.172    75.165    635.00
    79.900    67.129    89.890    773.00
    80.100   101.585   111.788    960.00
    80.300   121.089   144.522   1246.00
    80.500   127.792   176.786   1596.00
    80.700   134.700   210.724   2009.00
    81.100   147.308   277.885   2922.00
    81.500   157.385   345.513   3975.00
    82.900   189.880   629.993   9545.00
    85.900   243.359  1431.587  32353.00
  END FTABLE198
  FTABLE    199
     ***REPRESENTS STAMPEDE RESERVOIR.  TOTAL CAPACITY, 226,500 ACRE-FT
     ***  AT ELEVATION 5948.7 FT, SPILLWAY CREST.  INACTIVE CONTENTS, 5010
     ***  ACRE-FT, INCLUDES 660 ACRE-FT DEAD CONTENTS BELOW ELEVATION, 5,798.3
     ***  FT.  EXTREMES: MAXIMUM CONTENTS, 254,493 ACRE-FT, ELEVATION, 
     ***  5,956.55 FT; MINIMUM, 30,722 ACRE-FT, ELEVATION, 5,853.60 FT.
 ROWS COLS ***
   25    4
     DEPTH      AREA    VOLUME     DISCH ***
      (FT)   (ACRES)   (AC-FT)     (CFS) ***
    5740.0       0.0       0.0      0.00
    5775.0      99.5      1496      0.00
    5800.0       223      5385      0.00
    5825.0       420     13261      0.00
    5850.0       760     27915      0.00 
    5855.0       855     31951      0.00
    5860.0       952     36470      0.00
    5870.0      1172     47090      0.00
    5880.0      1446     60185      0.00
    5885.0      1582     67756      0.00
    5890.0      1716     76008      0.00
    5895.0      1853     84930      0.00
    5900.0      1992     94535      0.00
    5905.0      2132    104835      0.00
    5910.0      2280    115865      0.00
    5915.0      2428    127634      0.00
    5920.0      2582    140141      0.00
    5925.0      2720    153401      0.00
    5930.0      2862    167355      0.00
    5940.0      3198    197630      0.00
    5948.0      3426    224092      0.00
*** these have been altered for spillway ratings
    5950.0      3487    231005    125.0 ***
    5956.0      3668    252471   1000.0  ***
    5960.0      3803    267386   1975.0 ***
    5963.3      3902    280108   3000.0 ***

    5950.0      3487    231005      0.00 
    5956.0      3668    252471      0.00 
    5960.0      3803    267386      0.00 
    5970.0      4104    306920      0.00 
  END FTABLE199
  FTABLE    208
     LITTLE TRUCKEE RIVER DS OF STAMPEDE RES TO US OF BOCA RES               ***
 ROWS COLS ***
   25    4
     DEPTH      AREA    VOLUME     DISCH ***
      (FT)   (ACRES)   (AC-FT)     (CFS) ***
    88.030     0.000     0.000      0.00
    88.031     0.001     0.001      0.01
    88.300     7.016     0.843      1.02
    88.500     9.133     1.563      2.01
    88.700    11.526     3.035      5.01
    88.900    13.219     4.626     10.01
    89.300    16.929     9.215     26.01
    89.700    21.935    18.736     71.00
    90.100    31.667    32.957    142.00
    90.500    34.322    45.660    237.00
    90.900    36.401    59.537    354.00
    91.300    42.220    74.713    496.00
    91.700    51.673    92.367    660.00
    92.100    61.160   112.616    849.00
    92.500    68.836   135.510   1068.00
    92.900    77.792   162.294   1334.00
    93.300   147.289   201.867   1623.00
    93.700   150.058   238.829   1935.00
    94.500   153.043   308.893   2624.00
    95.300   174.763   385.481   3398.00
    96.100   190.304   463.131   4253.00
    97.700   196.036   609.673   6202.00
    99.700   204.455   792.293   9062.00
   102.700   217.559  1073.784  14208.00
   105.500   223.431  1341.601  19911.00
  END FTABLE208
  FTABLE    209
     ***REPRESENTS BOCA RESERVOIR.  TOTAL CAPACITY, 40,868 ACRE-FT BETWEEN
     ***  ELEVATIONS 5,521 FT, OUTLET SILL, AND 5,605 FT, TOP OF SPILLWAY
     ***  GATES.  ELEVATION OF SPILLWAY (GATE OPEN) IS 5,589 FT.  DEAD 
     ***  CONTENTS, 241 ACRE-FT.  EXTREMES: MAXIMUM CONTENTS, 41,440 ACRE-FT,
     ***  ELEVATION, 5,605.55 FT; MINIMUM, 37 ACRE-FT, ELEVATION, 
     ***  5,521.65 FT.
 ROWS COLS ***
   25    4
     DEPTH      AREA    VOLUME     DISCH ***
      (FT)   (ACRES)   (AC-FT)     (CFS) ***
    5521.0       0.0       0.0      0.00
    5525.0      86.0       290      0.00
    5527.5      99.0       521      0.00
    5530.0     115.0       787      0.00
    5532.5     135.0      1101      0.00
    5535.0     157.0      1466      0.00
    5538.0     182.0      1975      0.00
    5540.0     199.0      2356      0.00 
    5544.0     250.0      3258      0.00
    5548.0     298.0      4352      0.00
    5552.0     345.0      5636      0.00
    5556.0     393.0      7112      0.00
    5560.0     441.0      8778      0.00
    5564.0     486.0     10627      0.00
    5568.0     536.0     12671      0.00
    5572.0     586.0     14915      0.00
    5576.0     636.0     17359      0.00
    5580.0     686.0     20002      0.00
    5585.0     749.0     23589      0.00
    5590.0     811.0     27488      0.00
    5595.0     865.0     31699      0.00
    5600.0     919.0     36128      0.00
    5605.0     977.0     40868      0.00
*** these have been altered for spillway ratings
    5606.0     991.0     41853   5000. ***
    5607.0    1004.0     42851  10300.***
    5606.0     991.0     41853      0.00 
    5607.0    1004.0     42851      0.00 
***next line extrapolated for computations
    5637.0    1394.0     72791      0.00
  END FTABLE209
  FTABLE    210
     TRUCKEE RIVER AT LITTLE TRUCKEE RIVER TO JUNIPER CREEK                  ***
 Rows Cols   (TK11)                                                          ***
   25    4
     DEPTH      AREA    VOLUME     DISCH ***
      (FT)   (ACRES)   (AC-FT)     (CFS) ***
    20.370     0.000     0.000      0.00
    20.800     3.036     0.503      1.00
    21.200     5.127     1.752      5.00
    21.600     8.011     3.596     13.00
    21.800     9.591     5.010     19.00
    22.000    10.290     6.211     26.00
    22.200    11.019     7.578     34.00
    22.400    11.813     9.190     45.00
    22.800    13.417    11.653     61.00
    23.200    16.866    15.997     89.00
    23.600    20.256    23.611    152.00
    24.000    23.804    33.475    249.00
    24.400    26.406    46.481    404.00
    24.800    27.452    61.285    627.00
    25.200    28.587    76.501    887.00
    25.800    29.942   100.120   1346.00
    26.600    31.686   132.925   2076.00
    27.400    33.147   167.001   2935.00
    28.200    34.752   202.495   3922.00
    29.000    35.951   239.189   5027.00
    29.800    38.654   276.700   6213.00
    30.800    45.431   329.248   7895.00
    31.800    47.420   391.183   9997.00
    33.000    49.035   469.141  12884.00
    34.400    53.939   562.827  16513.00
  END FTABLE210
  FTABLE    220
     TRUCKEE RIVER AT JUNIPER CREEK TO GRAY CREEK                            ***
 Rows Cols   (TK12)                                                          ***
   25    4
     DEPTH      AREA    VOLUME     DISCH ***
      (FT)   (ACRES)   (AC-FT)     (CFS) ***
    24.220     0.000     0.000      0.00
    24.300     1.632     0.299      0.70
    24.800     6.067     1.834      5.00
    25.300    10.737     5.206     19.00
    25.800    13.153     9.167     41.00
    26.050    14.891    12.168     60.00
    26.300    18.128    16.174     85.00
    26.800    21.037    24.039    147.00
    27.300    24.163    34.315    244.00
    27.800    26.529    44.544    358.00
    28.300    29.061    55.991    501.00
    28.800    30.031    69.597    696.00
    29.300    30.989    84.405    938.00
    30.050    32.123   107.666   1375.00
    30.800    33.431   132.270   1892.00
    31.550    34.717   157.873   2479.00
    32.300    37.147   184.636   3135.00
    33.050    39.585   212.978   3860.00
    34.050    42.391   252.718   4931.00
    35.050    46.898   295.110   6098.00
    36.300    52.319   355.098   7820.00
    37.550    53.889   415.974   9702.00
    39.050    55.695   489.691  12156.00
    40.800    58.901   577.466  15269.00
    42.800    65.258   682.349  19129.00
  END FTABLE220
  FTABLE    230
     TRUCKEE RIVER AT GRAY CREEK TO FARAD POWER DIVERSION                    ***
 Rows Cols   (TK13)                                                          ***
   25    4
     DEPTH      AREA    VOLUME     DISCH ***
      (FT)   (ACRES)   (AC-FT)     (CFS) ***
    21.620     0.000     0.000      0.00
    21.700     0.590     0.124      0.40
    22.300     2.938     0.712      3.00
    22.700     4.677     1.582      9.00
    23.100     7.145     3.428     24.00
    23.300     8.498     4.915     39.00
    23.500    10.535     7.053     62.00
    23.700    11.675     9.160     90.00
    24.100    13.046    13.147    152.00
    24.500    14.850    18.820    258.00
    24.900    16.762    25.532    411.00
    25.300    19.822    33.256    597.00
    25.700    20.610    41.440    816.00
    26.100    21.257    49.906   1067.00
    26.700    22.484    63.136   1501.00
    27.300    24.259    77.450   2016.00
    27.900    28.061    93.787   2617.00
    28.500    29.643   111.412   3322.00
    29.300    32.541   136.947   4407.00
    30.300    34.632   170.789   5983.00
    31.300    37.781   207.269   7826.00
    32.500    43.800   255.970  10346.00
    33.900    47.559   316.654  13698.00
    35.500    50.242   389.224  18078.00
    37.300    54.047   476.288  23659.00
  END FTABLE230
  FTABLE    240
     TRUCKEE RIVER AT FARAD POWER DIVERSION TO FARAD GAGING STATION          ***
 Rows Cols   (TK14)                                                          ***
   25    4
     DEPTH      AREA    VOLUME     DISCH ***
      (FT)   (ACRES)   (AC-FT)     (CFS) ***
    19.420     0.000     0.000      0.00
    19.700     3.039     0.446      1.00
    19.900     5.815     1.533      5.00
    20.100     9.280     3.431     14.00
    20.300    12.078     5.954     29.00
    20.500    14.171     9.115     51.00
    20.700    16.108    12.403     78.00
    20.900    18.296    16.092    111.00
    21.100    20.509    20.096    149.00
    21.300    22.742    24.653    196.00
    21.700    25.759    35.088    328.00
    22.100    28.970    46.769    495.00
    22.500    30.450    58.521    694.00
    23.100    32.115    77.832   1077.00
    23.700    33.983    99.959   1594.00
    24.300    36.299   123.258   2194.00
    24.900    40.938   148.965   2875.00
    25.700    44.122   184.696   3905.00
    26.500    47.776   222.459   5066.00
    27.500    53.020   273.540   6735.00
    28.700    59.804   346.139   9218.00
    29.700    67.518   414.365  11658.00
    30.900    80.026   508.693  14994.00
    32.300    83.763   620.265  19403.00
    33.900    86.923   749.206  25080.00
  END FTABLE240

END FTABLES
                                                                             ***
END RUN

*** $Id: merge.uci,v 1.2 1995/12/15 19:06:00 gwhess Exp gwhess $
*** $Source: /project/tcp/op.model/RCS/merge.uci,v $
*** $Log: merge.uci,v $
*** Revision 1.2  1995/12/15  19:06:00  gwhess
*** version after snb initial testing, before thj SOP fixits.
***
# Revision 1.1  1995/07/31  14:00:17  gwhess
# Initial revision
#
